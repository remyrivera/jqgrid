<?php
namespace rivcar\jqGrid;
use rivcar\jqgrid\jqGrid;
use rivcar\tcpdf\TCPDF;
use rivcar\tcpdf\TCPDF_COLORS;

${"GLOBALS"}["xwprfqtb"] = "end";
${"GLOBALS"}["fyfcebgrkl"] = "maxColumn";
${"GLOBALS"}["bomjgd"] = "objPHPExcel";
${"GLOBALS"}["uyogpwvgccb"] = "startColumn";
${"GLOBALS"}["exklqjjhkx"] = "currentColumn";
${"GLOBALS"}["kudqvk"] = "cmfo";
${"GLOBALS"}["xduuflkkn"] = "ht";
${"GLOBALS"}["cluxprmjjib"] = "startRow";
${"GLOBALS"}["rkrfujn"] = "fmtstr";
${"GLOBALS"}["vxmhqjpf"] = "objWorksheet";
${"GLOBALS"}["lsjaox"] = "e_opt";
${"GLOBALS"}["odjbaccq"] = "ext";
${"GLOBALS"}["blmhysxivb"] = "fn";
${"GLOBALS"}["tmmlybo"] = "styleid";
${"GLOBALS"}["hmwqscpc"] = "tv";
${"GLOBALS"}["mzlghvtycb"] = "stype";
${"GLOBALS"}["cudsptyopd"] = "tmpdata";
${"GLOBALS"}["vatwvdyuus"] = "fdata";
${"GLOBALS"}["iomhvribwef"] = "thous";
${"GLOBALS"}["mbklqpbdps"] = "leaf";
${"GLOBALS"}["ulldvhznjhm"] = "ival";
${"GLOBALS"}["zgjofh"] = "html";
${"GLOBALS"}["easywfhkxgs"] = "a\x46ormula";
${"GLOBALS"}["eeqklwqpljg"] = "hiddencount";
${"GLOBALS"}["nfohkbk"] = "aSum";
${"GLOBALS"}["lfeuzytzatj"] = "summary";
${"GLOBALS"}["ckuocwht"] = "column";
${"GLOBALS"}["xejqpx"] = "hdr\x31";
${"GLOBALS"}["qtfnftgyjqe"] = "hdr";
${"GLOBALS"}["pqrcnmpmg"] = "file_t";
${"GLOBALS"}["xqjdxyyvxk"] = "grouping";
${"GLOBALS"}["xymebptnm"] = "tplfld";
${"GLOBALS"}["nsuqwew"] = "sv";
${"GLOBALS"}["qggzkhswbi"] = "sk";
${"GLOBALS"}["ygtpwesvvpd"] = "ij";
${"GLOBALS"}["lulxfwx"] = "grlen";
${"GLOBALS"}["dtasvs"] = "ik";
${"GLOBALS"}["ollhwol"] = "jj";
${"GLOBALS"}["cqbtlglxdng"] = "ii";
${"GLOBALS"}["jtoppfkbxi"] = "row";
${"GLOBALS"}["bnkmlts"] = "gg";
${"GLOBALS"}["dgiduf"] = "gt";
${"GLOBALS"}["wgoaukia"] = "n";
${"GLOBALS"}["mjypfvclsj"] = "sumreverse";
${"GLOBALS"}["mvglhjc"] = "len";
${"GLOBALS"}["fwfzxxuwrc"] = "toEnd";
${"GLOBALS"}["dqertcuk"] = "grpinfo";
${"GLOBALS"}["cdpuirmgomj"] = "vv";
${"GLOBALS"}["cfyyhwbpmxd"] = "fill";
${"GLOBALS"}["nmoxxcx"] = "dimensions";
${"GLOBALS"}["nuxoipvneiq"] = "start\x59";
${"GLOBALS"}["dhojgadfn"] = "align";
${"GLOBALS"}["xcwssjn"] = "varr";
${"GLOBALS"}["rydvgfnrjprj"] = "maxh";
${"GLOBALS"}["zrdlmlnkim"] = "maxheigh";
${"GLOBALS"}["yrghuenpe"] = "aname";
${"GLOBALS"}["qwloaihb"] = "awidth";
${"GLOBALS"}["jprujgcsncg"] = "asp";
${"GLOBALS"}["jteoipyqor"] = "str";
${"GLOBALS"}["nnqsybqotgeb"] = "pdfl";
${"GLOBALS"}["zeyxwxhvn"] = "fnmkeys";
${"GLOBALS"}["curlztfmp"] = "rows";
${"GLOBALS"}["jhjzifvydu"] = "echo";
${"GLOBALS"}["pjiliebi"] = "sepreplace";
${"GLOBALS"}["bryhzxmk"] = "es";
${"GLOBALS"}["dglvfwquwyy"] = "key";
${"GLOBALS"}["boxgmd"] = "type";
${"GLOBALS"}["wuzexrtfjn"] = "v\x31";
${"GLOBALS"}["pdwnukluj"] = "line";
${"GLOBALS"}["ntkgmldy"] = "res_arr";
${"GLOBALS"}["dtdoqofnexa"] = "fld";
${"GLOBALS"}["siskwhlub"] = "timefmt";
${"GLOBALS"}["gkfjvbd"] = "datefmt";
${"GLOBALS"}["vntcfvfsimcl"] = "NEWLINE";
${"GLOBALS"}["gckdpyw"] = "s";
${"GLOBALS"}["swurhplk"] = "sep\x32";
${"GLOBALS"}["coxxnkmlsht"] = "list";
${"GLOBALS"}["xwandwlrh"] = "delim";
${"GLOBALS"}["npmqzdfcglsi"] = "elements";
${"GLOBALS"}["eyhuikufrov"] = "replaceNewLine";
${"GLOBALS"}["qvpfljrbeum"] = "quote";
${"GLOBALS"}["menmaix"] = "escquote";
${"GLOBALS"}["xlmyieky"] = "typearr";
${"GLOBALS"}["incdddnykwc"] = "fname";
${"GLOBALS"}["uscbprxx"] = "fnames";
${"GLOBALS"}["vhiimwn"] = "escquotequote";
${"GLOBALS"}["ofxvefi"] = "mixedvar";
${"GLOBALS"}["dxkctdbops"] = "FILEH_";
${"GLOBALS"}["iepsnon"] = "tmp_dir";
${"GLOBALS"}["qjrhtvktebx"] = "filename";
${"GLOBALS"}["oivgmcrgwya"] = "arr";
${"GLOBALS"}["jmmpkw"] = "k";
${"GLOBALS"}["nimbxldqmn"] = "nmarr";
${"GLOBALS"}["xdrntkkcz"] = "args";
${"GLOBALS"}["bwrorcf"] = "numargs";
${"GLOBALS"}["scllsntlhu"] = "ind";
${"GLOBALS"}["usmemtsrbhr"] = "sumval";
${"GLOBALS"}["gwvcvcydgs"] = "sumkey";
${"GLOBALS"}["vdhrnvpio"] = "fieldInd";
${"GLOBALS"}["tmumlwo"] = "fieldName";
${"GLOBALS"}["pyiyriq"] = "changed";
${"GLOBALS"}["pfsyyx"] = "r";
${"GLOBALS"}["yvezufu"] = "fieldnames";
${"GLOBALS"}["giplinunxff"] = "irow";
${"GLOBALS"}["dlqafubuedv"] = "j";
${"GLOBALS"}["hlimukpf"] = "items";
${"GLOBALS"}["qwgqpbnkmug"] = "val";
${"GLOBALS"}["wyqwkwhq"] = "asl";
${"GLOBALS"}["zbaphywqpxk"] = "sep";
${"GLOBALS"}["mjsqvx"] = "atmp";
${"GLOBALS"}["xukgqmdv"] = "grp";
${"GLOBALS"}["nseuemktt"] = "grpopt";
${"GLOBALS"}["pijmpkn"] = "sr";
${"GLOBALS"}["benxbud"] = "ret";
${"GLOBALS"}["rusdlgrn"] = "name";
${"GLOBALS"}["duvwbvodqy"] = "record";
${"GLOBALS"}["qbroefmekyoe"] = "v";
${"GLOBALS"}["tettrknxf"] = "acsv";
${"GLOBALS"}["yfuwpujyu"] = "apdf";
class jqGridExport extends jqGrid
{
    public $pdffile = "exportdata.pdf";
    protected $PDF = [
        "page_orientation" => "P",
        "unit" => "mm",
        "page_format" => "A4",
        "creator" => "jqGrid",
        "author" => "jqGrid",
        "title" => "jqGrid PDF",
        "subject" => "Subject",
        "keywords" => "table, grid",
        "margin_left" => 15,
        "margin_top" => 7,
        "margin_right" => 15,
        "margin_bottom" => 25,
        "margin_header" => 5,
        "margin_footer" => 10,
        "font_name_main" => "helvetica",
        "font_size_main" => 10,
        "header_logo" => "",
        "header_logo_width" => 0,
        "header_title" => "",
        "header_string" => "",
        "header" => false,
        "footer" => true,
        "font_monospaced" => "courier",
        "font_name_data" => "helvetica",
        "font_size_data" => 8,
        "image_scale_ratio" => 1.25,
        "grid_head_color" => "#dfeffc",
        "grid_head_text_color" => "#2e6e9e",
        "grid_draw_color" => "#5c9ccc",
        "grid_header_height" => 6,
        "grid_row_color" => "#ffffff",
        "grid_row_text_color" => "#000000",
        "grid_row_height" => 5,
        "grid_alternate_rows" => false,
        "path_to_pdf_class" => "External/tcpdf/tcpdf.php",
        "shrink_cell" => true,
        "reprint_grid_header" => false,
        "shrink_header" => true,
        "unicode" => true,
        "encoding" => "UTF-8",
        "destination" => "D",
        "save_to_disk" => false,
        "save_to_disk_only" => false,
        "disk_file" => "",
    ];
    public function setPdfOptions($apdf)
    {
        if (is_array($apdf) and count(${${"GLOBALS"}["yfuwpujyu"]}) > 0) {
            $this->PDF = jqGridUtils::array_extend($this->PDF, $apdf);
        }
    }
    public function getPdfOptions()
    {
        return $this->PDF;
    }
    protected $CSV = [
        "file" => "",
        "save_to_disk" => false,
        "save_to_disk_only" => false,
        "disk_file" => "",
        "separator" => "",
        "sepreplace" => "",
        "quote" => '"',
        "escquote" => '"',
        "addtitles" => true,
        "replaceNewLine" => " ",
    ];
    public $csvfile = "exportdata.csv";
    public $csvsep = ";";
    public $csvsepreplace = " ";
    public function setCsvOptions($acsv)
    {
        if (
            is_array(${${"GLOBALS"}["tettrknxf"]}) and
            count(${${"GLOBALS"}["tettrknxf"]}) > 0
        ) {
            $this->CSV = jqGridUtils::array_extend(
                $this->CSV,
                ${${"GLOBALS"}["tettrknxf"]}
            );
        }
    }
    public function getCsvOptions()
    {
        return $this->CSV;
    }
    public $exportfile = "exportdata.xml";
    protected $EXCEL = [
        "file_type" => "xml",
        "file" => "",
        "save_to_disk" => false,
        "save_to_disk_only" => false,
        "disk_file" => "",
        "start_cell" => "A1",
        "creator" => "jqGrid",
        "author" => "jqGrid",
        "title" => "jqGrid Excel",
        "subject" => "Office 2007 XLSX Document",
        "description" => "Document created with Guriddo",
        "keywords" => "Guriddo, jqGrid, Excel",
        "font" => "Arial",
        "font_size" => 11,
        "header_cell" => "",
        "header_title" => "",
        "protect" => false,
        "password" => "Guriddo",
        "format_int" => "#0",
        "format_num" => "#.00",
        "format_text" => "@",
        "format_date" => "YYYY-MM-DD",
        "path_to_phpexcel_class" => "External/phpexcel/PHPExcel.php",
    ];
    public $excelFunc = null;
    public $excelClass = false;
    public function setExcelOptions($apdf)
    {
        ${"GLOBALS"}["boitznzfw"] = "apdf";
        if (
            is_array(${${"GLOBALS"}["yfuwpujyu"]}) and
            count(${${"GLOBALS"}["boitznzfw"]}) > 0
        ) {
            ${"GLOBALS"}["hvipvhgsex"] = "apdf";
            $this->EXCEL = jqGridUtils::array_extend(
                $this->EXCEL,
                ${${"GLOBALS"}["hvipvhgsex"]}
            );
        }
    }
    public function getExcelOptions()
    {
        return $this->EXCEL;
    }
    protected $groupdata;
    public function groupCalcs($func, $v, $name, $record, $sr)
    {
        $hnslmdqdveb = "func";
        ${"GLOBALS"}["smgopkx"] = "name";
        $sfhwklbip = "ret";
        $pddpkxkwhy = "ret";
        ${"GLOBALS"}["fddraexmu"] = "v";
        ${"GLOBALS"}["ewubovyj"] = "record";
        ${"GLOBALS"}["hhpkkwdos"] = "name";
        $domixtpcw = "record";
        ${"GLOBALS"}["vadsxv"] = "v";
        ${"GLOBALS"}["smaqitcuvga"] = "ret";
        switch (strtolower(${$hnslmdqdveb})) {
            case "sum":
            case "avg":
                if (${${"GLOBALS"}["fddraexmu"]} == "") {
                    ${${"GLOBALS"}["qbroefmekyoe"]} = 0;
                }
                ${${"GLOBALS"}["smaqitcuvga"]} =
                    (float) ${${"GLOBALS"}["qbroefmekyoe"]} +
                    (float) ${${"GLOBALS"}["ewubovyj"]}[
                        ${${"GLOBALS"}["hhpkkwdos"]}
                    ];
                break;
            case "min":
                if (${${"GLOBALS"}["qbroefmekyoe"]} == "") {
                    ${"GLOBALS"}["ccnbpeqkk"] = "name";
                    $fblciyoa = "record";
                    return ${$fblciyoa}[${${"GLOBALS"}["ccnbpeqkk"]}];
                }
                ${$sfhwklbip} = min([
                    ${${"GLOBALS"}["qbroefmekyoe"]},
                    ${$domixtpcw}[${${"GLOBALS"}["smgopkx"]}],
                ]);
                break;
            case "max":
                if (${${"GLOBALS"}["qbroefmekyoe"]} == "") {
                    return ${${"GLOBALS"}["duvwbvodqy"]}[
                        ${${"GLOBALS"}["rusdlgrn"]}
                    ];
                }
                ${${"GLOBALS"}["benxbud"]} = max([
                    ${${"GLOBALS"}["qbroefmekyoe"]},
                    ${${"GLOBALS"}["duvwbvodqy"]}[${${"GLOBALS"}["rusdlgrn"]}],
                ]);
                break;
            case "count":
                if (${${"GLOBALS"}["vadsxv"]} == "") {
                    ${"GLOBALS"}["niupzofdiu"] = "v";
                    ${${"GLOBALS"}["niupzofdiu"]} = 0;
                }
                if (
                    isset(
                        ${${"GLOBALS"}["duvwbvodqy"]}[
                            ${${"GLOBALS"}["rusdlgrn"]}
                        ]
                    )
                ) {
                    ${"GLOBALS"}["vxgmgxhcy"] = "v";
                    ${"GLOBALS"}["uzckmp"] = "ret";
                    ${${"GLOBALS"}["uzckmp"]} =
                        ${${"GLOBALS"}["vxgmgxhcy"]} + 1;
                } else {
                    ${${"GLOBALS"}["benxbud"]} = 0;
                }
                break;
            default:
                ${${"GLOBALS"}["benxbud"]} = "";
        }
        if (
            ${${"GLOBALS"}["pijmpkn"]} != null &&
            is_numeric(${${"GLOBALS"}["benxbud"]})
        ) {
            $wepqovi = "ret";
            $kkqzsfx = "ret";
            ${$wepqovi} = round(${$kkqzsfx}, ${${"GLOBALS"}["pijmpkn"]});
        }
        return ${$pddpkxkwhy};
    }
    private function groupingSetup($rs, $colmodel)
    {
        $vmcnkr = "nmodel";
        if (isset($this->gridOptions["grouping\x56iew"])) {
            ${${"GLOBALS"}["nseuemktt"]} =
                $this->gridOptions["groupingView"];
        } else {
            printf("No grouping is set\x21");
            return false;
        }
        $kwhvjedpus = "ncols";
        ${"GLOBALS"}["shnydrgrk"] = "rs";
        $ympqddivvi = "nmodel";
        $gfcosry = "model";
        if (!${${"GLOBALS"}["shnydrgrk"]}) {
            printf("Bad Record\x20set\x20groupingSetup");
            return false;
        }
        $this->groupdata = new ArrayIterator();
        ${"GLOBALS"}["lfexgrwrbw"] = "fieldnames";
        $maxrows = $this->gSQLMaxRows;
        $ncols = jqGridDB::columnCount(
            $rs
        );
        ${"GLOBALS"}["jxbikrw"] = "j";
        $nmodel = is_array(
            $colmodel
        )
            ? count($colmodel)
            : -1;
        ${"GLOBALS"}["fyrifpavhx"] = "colmodel";
        if (${$vmcnkr} > 0) {
            $kxhjptxixdd = "i";
            $smtrcgu = "nmodel";
            $kishovfbvj = "i";
            for (
                ${$kxhjptxixdd} = 0;
                ${$kishovfbvj} < ${$smtrcgu};
                $i++
            ) {
                if (
                    $colmodel[
                        $i
                    ]["name"] == "actions"
                ) {
                    array_splice(
                        $colmodel,
                        $i,
                        1
                    );
                    ${"GLOBALS"}["yypltxwq"] = "nmodel";
                    ${${"GLOBALS"}["yypltxwq"]}--;
                    break;
                }
            }
        }
        ${"GLOBALS"}["sogifogfjb"] = "i";
        ${$gfcosry} = false;
        if (
            is_array(${${"GLOBALS"}["fyrifpavhx"]}) &&
            ${$ympqddivvi} == ${$kwhvjedpus}
        ) {
            $model = true;
        }
        ${${"GLOBALS"}["xukgqmdv"]} = new stdClass();
        $grp->summary = [];
        ${"GLOBALS"}["yttxunpztdjq"] = "i";
        $grp->columns = [];
        $grp->totalwidth = 0;
        $nnpchtz = "grlen";
        ${${"GLOBALS"}["nseuemktt"]}["groupIndex"] = [];
        for (
            ${${"GLOBALS"}["yttxunpztdjq"]} = 0;
            $i < $ncols;
            ${${"GLOBALS"}["sogifogfjb"]}++
        ) {
            $gbrubwihj = "atmp";
            ${"GLOBALS"}["ydowvnqr"] = "colmodel";
            ${"GLOBALS"}["twrkdilubs"] = "j";
            $vfymxvm = "colmodel";
            $ukmbuyopyr = "colmodel";
            $rmsuksxuiv = "atmp";
            $smjftckohl = "i";
            $jgbetrcxx = "grpopt";
            $vtpkujjtoyc = "i";
            $vhvwultk = "colmodel";
            ${"GLOBALS"}["fnafbcmktqwr"] = "i";
            ${"GLOBALS"}["owczmu"] = "atmp";
            ${${"GLOBALS"}["owczmu"]} = [];
            ${"GLOBALS"}["efieutz"] = "model";
            $xlqtdmsupy = "atmp";
            ${"GLOBALS"}["ddqqeplbw"] = "i";
            ${"GLOBALS"}["ybnypeelgzl"] = "j";
            ${"GLOBALS"}["jrftcduot"] = "colmodel";
            ${$gbrubwihj}["hidden"] =
                $model &&
                isset(${$ukmbuyopyr}[$i]["hidden"])
                    ? ${$vhvwultk}[${$smjftckohl}]["hidden"]
                    : false;
            ${${"GLOBALS"}["mjsqvx"]}["select"] = false;
            $qcnhjm = "i";
            $xldfqsqg = "model";
            if (
                ${$xldfqsqg} &&
                isset(
                    $colmodel[
                        $i
                    ]["formatter"]
                )
            ) {
                $lpswwuvhibw = "colmodel";
                $ccqmixtmhg = "i";
                $cjyqrbiit = "asl";
                ${"GLOBALS"}["sfkfswtzl"] = "i";
                ${"GLOBALS"}["kufezcgn"] = "colmodel";
                $uknoxysydl = "asl";
                $dvsakmja = "atmp";
                ${"GLOBALS"}["ikkwsmgvqcn"] = "atmp";
                ${"GLOBALS"}["tkvrpeexbi"] = "i";
                ${$dvsakmja}["formatter"] =
                    ${$lpswwuvhibw}[${$ccqmixtmhg}]["formatter"];
                $uffxyscdq = "i";
                ${$uknoxysydl} = isset(
                    $colmodel[
                        ${${"GLOBALS"}["tkvrpeexbi"]}
                    ]["formatoptions"]
                )
                    ? $colmodel[
                        $i
                    ]["formatoptions"]
                    : (isset(
                        ${${"GLOBALS"}["kufezcgn"]}[
                            ${${"GLOBALS"}["sfkfswtzl"]}
                        ]["editoptions"]
                    )
                        ? $colmodel[${$uffxyscdq}][
                            "editoptions"
                        ]
                        : false);
                ${${"GLOBALS"}["ikkwsmgvqcn"]}[
                    "formatoptions"
                ] = ${$cjyqrbiit};
                ${"GLOBALS"}["hhtvvxnrbu"] = "i";
                if (
                    $colmodel[
                        ${${"GLOBALS"}["hhtvvxnrbu"]}
                    ]["formatter"] == "select"
                ) {
                    ${"GLOBALS"}["rehnenirei"] = "asl";
                    if (isset(${${"GLOBALS"}["rehnenirei"]}["value"])) {
                        ${"GLOBALS"}["deqyuxejy"] = "val";
                        $xqynqkgu = "list";
                        ${"GLOBALS"}["yuslgkcpfju"] = "delim";
                        $trcscr = "asl";
                        ${"GLOBALS"}["lalcpsnrf"] = "delim";
                        ${"GLOBALS"}["rrsmobvxbo"] = "key";
                        $keusphncr = "list";
                        ${${"GLOBALS"}["zbaphywqpxk"]} = isset(
                            ${${"GLOBALS"}["wyqwkwhq"]}["separator"]
                        )
                            ? ${${"GLOBALS"}["wyqwkwhq"]}["separator"]
                            : ":";
                        ${${"GLOBALS"}["lalcpsnrf"]} = isset(
                            ${$trcscr}["delimiter"]
                        )
                            ? ${${"GLOBALS"}["wyqwkwhq"]}["delimiter"]
                            : "\x3b";
                        ${$xqynqkgu} = explode(
                            ${${"GLOBALS"}["yuslgkcpfju"]},
                            ${${"GLOBALS"}["wyqwkwhq"]}["value"]
                        );
                        foreach (
                            ${$keusphncr}
                            as ${${"GLOBALS"}["rrsmobvxbo"]} =>
                                ${${"GLOBALS"}["deqyuxejy"]}
                        ) {
                            ${"GLOBALS"}["xuejxuthhf"] = "atmp";
                            ${"GLOBALS"}["uidrbnbcs"] = "items";
                            ${"GLOBALS"}["yfamymxchrs"] = "items";
                            ${${"GLOBALS"}["yfamymxchrs"]} = explode(
                                ${${"GLOBALS"}["zbaphywqpxk"]},
                                ${${"GLOBALS"}["qwgqpbnkmug"]}
                            );
                            ${${"GLOBALS"}["xuejxuthhf"]}["select"][
                                ${${"GLOBALS"}["uidrbnbcs"]}[0]
                            ] = ${${"GLOBALS"}["hlimukpf"]}[1];
                        }
                    }
                }
            }
            ${"GLOBALS"}["bwpixtef"] = "i";
            if (
                !isset(
                    $colmodel[${$qcnhjm}][
                        "summaryRound"
                    ]
                )
            ) {
                $oimftyqxusd = "i";
                $colmodel[${$oimftyqxusd}][
                    "summaryRound"
                ] = null;
            }
            $ympbmws = "colmodel";
            ${${"GLOBALS"}["mjsqvx"]}["width"] =
                ${${"GLOBALS"}["efieutz"]} &&
                isset($colmodel[${$vtpkujjtoyc}]["width"])
                    ? (int) ${${"GLOBALS"}["ydowvnqr"]}[
                        ${${"GLOBALS"}["bwpixtef"]}
                    ]["width"]
                    : 150;
            ${"GLOBALS"}["roxlgbtn"] = "i";
            if ($model) {
                $mhksjnnk = "i";
                $whwiefhvk = "colmodel";
                ${"GLOBALS"}["cfdoxotth"] = "atmp";
                ${"GLOBALS"}["ztmfnif"] = "i";
                $btfyufyei = "i";
                $tptufxeg = "i";
                $giajucgp = "colmodel";
                $ohcvokl = "i";
                ${${"GLOBALS"}["mjsqvx"]}["label"] = isset(
                    ${$whwiefhvk}[$i]["label"]
                )
                    ? $colmodel[${$mhksjnnk}]["label"]
                    : ${$giajucgp}[${$btfyufyei}]["name"];
                ${${"GLOBALS"}["cfdoxotth"]}["name"] =
                    $colmodel[${$tptufxeg}]["name"];
                ${${"GLOBALS"}["mjsqvx"]}["type"] = isset(
                    $colmodel[${$ohcvokl}]["sorttype"]
                )
                    ? $colmodel[
                        ${${"GLOBALS"}["ztmfnif"]}
                    ]["sorttype"]
                    : "";
            } else {
                ${"GLOBALS"}["eqrhqxyx"] = "atmp";
                ${"GLOBALS"}["djlsslwxkca"] = "field";
                ${"GLOBALS"}["cixwhemhrih"] = "rs";
                ${"GLOBALS"}["zbpdsfe"] = "i";
                ${"GLOBALS"}["vpxtlnb"] = "field";
                ${"GLOBALS"}["yyiwpcaqxvtc"] = "field";
                ${${"GLOBALS"}["vpxtlnb"]} = jqGridDB::getColumnMeta(
                    ${${"GLOBALS"}["zbpdsfe"]},
                    ${${"GLOBALS"}["cixwhemhrih"]}
                );
                ${${"GLOBALS"}["mjsqvx"]}["label"] =
                    ${${"GLOBALS"}["yyiwpcaqxvtc"]}["name"];
                ${${"GLOBALS"}["eqrhqxyx"]}["name"] =
                    ${${"GLOBALS"}["djlsslwxkca"]}["name"];
                ${"GLOBALS"}["awducrtfupr"] = "atmp";
                ${${"GLOBALS"}["awducrtfupr"]}["type"] = jqGridDB::MetaType(
                    $field,
                    $this->dbtype
                );
            }
            ${"GLOBALS"}["xlmbnas"] = "atmp";
            ${$rmsuksxuiv}["align"] = isset(
                ${${"GLOBALS"}["jrftcduot"]}[${${"GLOBALS"}["roxlgbtn"]}][
                    "align"
                ]
            )
                ? strtoupper(
                    substr(
                        ${$vfymxvm}[${${"GLOBALS"}["fnafbcmktqwr"]}]["align"],
                        0,
                        1
                    )
                )
                : "L";
            for (
                ${${"GLOBALS"}["dlqafubuedv"]} = 0;
                ${${"GLOBALS"}["ybnypeelgzl"]} <
                count(${$jgbetrcxx}["group\x46ield"]);
                ${${"GLOBALS"}["twrkdilubs"]}++
            ) {
                if (
                    ${${"GLOBALS"}["mjsqvx"]}["name"] ==
                    ${${"GLOBALS"}["nseuemktt"]}["groupField"][
                        ${${"GLOBALS"}["dlqafubuedv"]}
                    ]
                ) {
                    ${${"GLOBALS"}["nseuemktt"]}["groupIndex"][
                        ${${"GLOBALS"}["dlqafubuedv"]}
                    ] = $i;
                }
            }
            if (
                isset(
                    ${$ympbmws}[$i][
                        "summary\x54ype"
                    ]
                )
            ) {
                $obuthhbg = "i";
                if (
                    isset(
                        $colmodel[${$obuthhbg}][
                            "summaryDivider"
                        ]
                    )
                ) {
                    $mviiexwvov = "i";
                    $fzxhsoakjto = "i";
                    ${"GLOBALS"}["muulcciefle"] = "colmodel";
                    $grp->summary[] = [
                        "nm" => ${${"GLOBALS"}["mjsqvx"]}["name"],
                        "st" =>
                            ${${"GLOBALS"}["muulcciefle"]}[${$fzxhsoakjto}][
                                "summaryType"
                            ],
                        "v" => 0,
                        "sd" =>
                            $colmodel[
                                $i
                            ]["summaryDivider"],
                        "vd" => 0,
                        "sr" =>
                            $colmodel[${$mviiexwvov}][
                                "summaryRound"
                            ],
                    ];
                } else {
                    ${"GLOBALS"}["mnjnylhdl"] = "i";
                    $grp->summary[] = [
                        "nm" => ${${"GLOBALS"}["mjsqvx"]}["name"],
                        "st" =>
                            $colmodel[
                                ${${"GLOBALS"}["mnjnylhdl"]}
                            ]["summary\x54ype"],
                        "v" => 0,
                        "sr" =>
                            $colmodel[
                                $i
                            ]["summaryRound"],
                    ];
                }
            }
            $grp->totalwidth += ${${"GLOBALS"}["xlmbnas"]}["hidden"]
                ? 0
                : ${$xlqtdmsupy}["width"];
            $grp->columns[${${"GLOBALS"}["ddqqeplbw"]}] = ${${"GLOBALS"}[
                "mjsqvx"
            ]};
        }
        for (
            ${${"GLOBALS"}["dlqafubuedv"]} = 0;
            ${${"GLOBALS"}["jxbikrw"]} <
            count(${${"GLOBALS"}["nseuemktt"]}["group\x46ield"]);
            ${${"GLOBALS"}["dlqafubuedv"]}++
        ) {
            $hjgvkrib = "grpopt";
            ${"GLOBALS"}["lxczjuq"] = "j";
            if (
                !isset(
                    ${$hjgvkrib}["groupSummary"][${${"GLOBALS"}["lxczjuq"]}]
                )
            ) {
                ${${"GLOBALS"}["nseuemktt"]}["groupSummary"][
                    ${${"GLOBALS"}["dlqafubuedv"]}
                ] = false;
            }
        }
        $grp->lastvalues = [];
        $grp->groups = [];
        $grp->counters = [];
        $ssdrzjhtsfuu = "grpopt";
        ${${"GLOBALS"}["giplinunxff"]} = 0;
        ${${"GLOBALS"}["lfexgrwrbw"]} = [];
        ${$nnpchtz} = count(${$ssdrzjhtsfuu}["groupIndex"]);
        if ($this->dbtype == "mysqli") {
            $ipynjmypx = "res_arr";
            $osbcfxeudby = "ncols";
            $smsowsacohl = "rs";
            $fwjceqbv = "fieldnames";
            ${$fwjceqbv}[0] = &${$smsowsacohl};
            $ebmjkzkog = "i";
            ${$ipynjmypx} = [];
            for (
                $i = 0;
                ${$ebmjkzkog} < ${$osbcfxeudby};
                $i++
            ) {
                $mmtbzldx = "res_arr";
                $wlmyxbrdmrk = "i";
                ${${"GLOBALS"}["yvezufu"]}[$i + 1] =
                    &${$mmtbzldx}[$grp->columns[${$wlmyxbrdmrk}]["name"]];
            }
            call_user_func_array(
                "mysqli_stmt_bind_result",
                ${${"GLOBALS"}["yvezufu"]}
            );
        }
        while (
            ${${"GLOBALS"}["pfsyyx"]} = jqGridDB::fetch_assoc(
                $rs,
                $this->pdo
            )
        ) {
            $otfzfsz = "i";
            $rokzigdjlhv = "maxrows";
            ${"GLOBALS"}["kkglxxb"] = "i";
            if ($this->dbtype == "mysqli") {
                ${"GLOBALS"}["fdpcrhjie"] = "res_arr";
                $gwjmxonpao = "r";
                ${$gwjmxonpao} = jqGridUtils::array_extend(
                    [],
                    ${${"GLOBALS"}["fdpcrhjie"]}
                );
            }
            ${"GLOBALS"}["tpsgqrjdxp"] = "grlen";
            ${${"GLOBALS"}["pyiyriq"]} = 0;
            for (
                ${$otfzfsz} = 0;
                ${${"GLOBALS"}["kkglxxb"]} < ${${"GLOBALS"}["tpsgqrjdxp"]};
                $i++
            ) {
                $ygiujbn = "fieldInd";
                ${"GLOBALS"}["udaiduv"] = "fieldName";
                ${"GLOBALS"}["lxwxuxocg"] = "grpopt";
                ${"GLOBALS"}["wthcmdfj"] = "r";
                ${$ygiujbn} =
                    ${${"GLOBALS"}["nseuemktt"]}["groupIndex"][
                        $i
                    ];
                $gttwdqpopcb = "fieldName";
                ${${"GLOBALS"}["udaiduv"]} =
                    ${${"GLOBALS"}["lxwxuxocg"]}["group\x46ield"][
                        $i
                    ];
                if (
                    array_key_exists(
                        ${$gttwdqpopcb},
                        ${${"GLOBALS"}["wthcmdfj"]}
                    )
                ) {
                    ${"GLOBALS"}["ilblcfafrsdt"] = "v";
                    ${${"GLOBALS"}["ilblcfafrsdt"]} =
                        ${${"GLOBALS"}["pfsyyx"]}[
                            ${${"GLOBALS"}["tmumlwo"]}
                        ];
                    if ($grp->columns[${${"GLOBALS"}["vdhrnvpio"]}]["select"]) {
                        $kuqmxctrbv = "v";
                        if (
                            isset(
                                $grp->columns[${${"GLOBALS"}["vdhrnvpio"]}][
                                    "select"
                                ][${$kuqmxctrbv}]
                            )
                        ) {
                            $fnmnmp = "v";
                            ${$fnmnmp} =
                                $grp->columns[${${"GLOBALS"}["vdhrnvpio"]}][
                                    "select"
                                ][${${"GLOBALS"}["qbroefmekyoe"]}];
                        }
                    }
                    $ssrsyncyn = "irow";
                    if (${$ssrsyncyn} == 0) {
                        ${"GLOBALS"}["odinskqwvgo"] = "i";
                        $zjkoiqglpaz = "i";
                        ${"GLOBALS"}["ggdiynp"] = "v";
                        $whnxlqn = "sumval";
                        ${"GLOBALS"}["dlntzkrim"] = "i";
                        $lgmgjkvwrdg = "irow";
                        $grp->groups[] = [
                            "idx" => ${${"GLOBALS"}["dlntzkrim"]},
                            "dataIndex" => ${${"GLOBALS"}["tmumlwo"]},
                            "value" => ${${"GLOBALS"}["ggdiynp"]},
                            "startRow" => ${$lgmgjkvwrdg},
                            "cnt" => 1,
                            "summary" => [],
                        ];
                        $grp->lastvalues[
                            $i
                        ] = ${${"GLOBALS"}["qbroefmekyoe"]};
                        $grp->counters[$i] = [
                            "cnt" => 1,
                            "pos" => count($grp->groups) - 1,
                            "summary" => $grp->summary,
                        ];
                        foreach (
                            $grp->counters[$i][
                                "summary"
                            ]
                            as ${${"GLOBALS"}["gwvcvcydgs"]} => ${$whnxlqn}
                        ) {
                            ${"GLOBALS"}["lsymrcq"] = "sumkey";
                            if (
                                isset(
                                    ${${"GLOBALS"}["usmemtsrbhr"]}["sd"]
                                )
                            ) {
                                $ojtnwqn = "r";
                                $kuxesrhwlz = "sumval";
                                ${"GLOBALS"}["hrsrzxfiwmtk"] = "sumkey";
                                ${"GLOBALS"}["jlwtsak"] = "sumval";
                                $grp->counters[$i][
                                    "summary"
                                ][${${"GLOBALS"}["hrsrzxfiwmtk"]}][
                                    "vd"
                                ] = $this->groupCalcs(
                                    ${${"GLOBALS"}["jlwtsak"]}["st"],
                                    ${${"GLOBALS"}["usmemtsrbhr"]}["vd"],
                                    ${$kuxesrhwlz}["sd"],
                                    ${$ojtnwqn},
                                    ${${"GLOBALS"}["usmemtsrbhr"]}["sr"]
                                );
                            }
                            $uatlvpttnx = "sumval";
                            ${"GLOBALS"}["sirlqy"] = "sumval";
                            $oygrrum = "i";
                            $grp->counters[${$oygrrum}]["summary"][
                                ${${"GLOBALS"}["lsymrcq"]}
                            ]["v"] = $this->groupCalcs(
                                ${${"GLOBALS"}["sirlqy"]}["st"],
                                ${$uatlvpttnx}["v"],
                                ${${"GLOBALS"}["usmemtsrbhr"]}["nm"],
                                ${${"GLOBALS"}["pfsyyx"]},
                                ${${"GLOBALS"}["usmemtsrbhr"]}["sr"]
                            );
                        }
                        $grp->groups[
                            $grp->counters[${${"GLOBALS"}["odinskqwvgo"]}][
                                "pos"
                            ]
                        ]["summary"] =
                            $grp->counters[${$zjkoiqglpaz}]["summary"];
                    } else {
                        ${"GLOBALS"}["zhbdmdvnoa"] = "i";
                        if (
                            ${${"GLOBALS"}["qbroefmekyoe"]} !=
                            $grp->lastvalues[${${"GLOBALS"}["zhbdmdvnoa"]}]
                        ) {
                            ${"GLOBALS"}["xogpsxj"] = "fieldName";
                            ${"GLOBALS"}["kbkvtihll"] = "i";
                            $gazumjpmv = "irow";
                            $grp->groups[] = [
                                "idx" => $i,
                                "dataIndex" => ${${"GLOBALS"}["xogpsxj"]},
                                "value" => ${${"GLOBALS"}["qbroefmekyoe"]},
                                "startRow" => ${$gazumjpmv},
                                "cnt" => 1,
                                "summary" => [],
                            ];
                            ${"GLOBALS"}["sfzwehpebc"] = "i";
                            $grp->lastvalues[
                                ${${"GLOBALS"}["kbkvtihll"]}
                            ] = ${${"GLOBALS"}["qbroefmekyoe"]};
                            ${${"GLOBALS"}["pyiyriq"]} = 1;
                            $bdnvnbm = "i";
                            ${"GLOBALS"}["mpwkfmh"] = "sumval";
                            $grp->counters[${${"GLOBALS"}["sfzwehpebc"]}] = [
                                "cnt" => 1,
                                "pos" => count($grp->groups) - 1,
                                "summary" => $grp->summary,
                            ];
                            foreach (
                                $grp->counters[${$bdnvnbm}]["summary"]
                                as ${${"GLOBALS"}["gwvcvcydgs"]} =>
                                    ${${"GLOBALS"}["mpwkfmh"]}
                            ) {
                                $fvufxkh = "sumkey";
                                ${"GLOBALS"}["kgismhuis"] = "i";
                                if (
                                    isset(
                                        ${${"GLOBALS"}["usmemtsrbhr"]}[
                                            "sd"
                                        ]
                                    )
                                ) {
                                    $mcggopurdbgh = "sumval";
                                    $ztsfdcu = "i";
                                    $xtorwqczk = "sumval";
                                    $grp->counters[${$ztsfdcu}][
                                        "summary"
                                    ][${${"GLOBALS"}["gwvcvcydgs"]}][
                                        "vd"
                                    ] = $this->groupCalcs(
                                        ${${"GLOBALS"}["usmemtsrbhr"]}["st"],
                                        ${${"GLOBALS"}["usmemtsrbhr"]}["vd"],
                                        ${$xtorwqczk}["sd"],
                                        ${${"GLOBALS"}["pfsyyx"]},
                                        ${$mcggopurdbgh}["sr"]
                                    );
                                }
                                $dcxxdwonm = "sumval";
                                $grp->counters[${${"GLOBALS"}["kgismhuis"]}][
                                    "summary"
                                ][${$fvufxkh}]["v"] = $this->groupCalcs(
                                    ${${"GLOBALS"}["usmemtsrbhr"]}["st"],
                                    ${${"GLOBALS"}["usmemtsrbhr"]}["v"],
                                    ${$dcxxdwonm}["nm"],
                                    ${${"GLOBALS"}["pfsyyx"]},
                                    ${${"GLOBALS"}["usmemtsrbhr"]}["sr"]
                                );
                            }
                            $grp->groups[
                                $grp->counters[$i][
                                    "pos"
                                ]
                            ]["summary"] =
                                $grp->counters[$i][
                                    "summary"
                                ];
                        } else {
                            $znikmpgxdpn = "changed";
                            if (${$znikmpgxdpn} == 1) {
                                ${"GLOBALS"}["mfokwvrf"] = "i";
                                ${"GLOBALS"}["kvmrwnt"] = "fieldName";
                                $ekmadedss = "i";
                                ${"GLOBALS"}["hxiyrmx"] = "i";
                                ${"GLOBALS"}["fgbfeiqsqtf"] = "i";
                                $grp->groups[] = [
                                    "idx" => ${${"GLOBALS"}["mfokwvrf"]},
                                    "dataIndex" => ${${"GLOBALS"}[
                                        "kvmrwnt"
                                    ]},
                                    "value" => ${${"GLOBALS"}["qbroefmekyoe"]},
                                    "startRow" => ${${"GLOBALS"}[
                                        "giplinunxff"
                                    ]},
                                    "cnt" => 1,
                                    "summary" => [],
                                ];
                                $grp->lastvalues[
                                    ${$ekmadedss}
                                ] = ${${"GLOBALS"}["qbroefmekyoe"]};
                                $grp->counters[${${"GLOBALS"}["hxiyrmx"]}] = [
                                    "cnt" => 1,
                                    "pos" => count($grp->groups) - 1,
                                    "summary" => $grp->summary,
                                ];
                                foreach (
                                    $grp->counters[$i][
                                        "summary"
                                    ]
                                    as ${${"GLOBALS"}["gwvcvcydgs"]} =>
                                        ${${"GLOBALS"}["usmemtsrbhr"]}
                                ) {
                                    ${"GLOBALS"}["rkjskriq"] = "sumval";
                                    $nngcrsgjrn = "r";
                                    $uqvoflk = "sumval";
                                    if (
                                        isset(
                                            ${${"GLOBALS"}["usmemtsrbhr"]}[
                                                "sd"
                                            ]
                                        )
                                    ) {
                                        ${"GLOBALS"}["rthflnqo"] = "sumval";
                                        $hpuoedf = "r";
                                        $gtkhfum = "sumkey";
                                        $lbholnkeo = "i";
                                        $grp->counters[${$lbholnkeo}][
                                            "summary"
                                        ][${$gtkhfum}][
                                            "vd"
                                        ] = $this->groupCalcs(
                                            ${${"GLOBALS"}["usmemtsrbhr"]}[
                                                "st"
                                            ],
                                            ${${"GLOBALS"}["rthflnqo"]}["vd"],
                                            ${${"GLOBALS"}["usmemtsrbhr"]}[
                                                "sd"
                                            ],
                                            ${$hpuoedf},
                                            ${${"GLOBALS"}["usmemtsrbhr"]}[
                                                "sr"
                                            ]
                                        );
                                    }
                                    $grp->counters[$i][
                                        "summary"
                                    ][${${"GLOBALS"}["gwvcvcydgs"]}][
                                        "v"
                                    ] = $this->groupCalcs(
                                        ${${"GLOBALS"}["usmemtsrbhr"]}["st"],
                                        ${${"GLOBALS"}["rkjskriq"]}["v"],
                                        ${$uqvoflk}["nm"],
                                        ${$nngcrsgjrn},
                                        ${${"GLOBALS"}["usmemtsrbhr"]}["sr"]
                                    );
                                }
                                $grp->groups[
                                    $grp->counters[
                                        ${${"GLOBALS"}["fgbfeiqsqtf"]}
                                    ]["pos"]
                                ]["summary"] =
                                    $grp->counters[$i][
                                        "summary"
                                    ];
                            } else {
                                $mpjrcueowh = "i";
                                ${"GLOBALS"}["dpnrhweyo"] = "sumval";
                                ${"GLOBALS"}["ckgavvubpv"] = "i";
                                $yytqvse = "i";
                                $grp->counters[${$mpjrcueowh}]["cnt"]++;
                                ${"GLOBALS"}["chintf"] = "sumkey";
                                $wyppytgqjvu = "i";
                                $grp->groups[
                                    $grp->counters[${$wyppytgqjvu}]["pos"]
                                ]["cnt"] =
                                    $grp->counters[$i][
                                        "cnt"
                                    ];
                                foreach (
                                    $grp->counters[$i][
                                        "summary"
                                    ]
                                    as ${${"GLOBALS"}["chintf"]} =>
                                        ${${"GLOBALS"}["dpnrhweyo"]}
                                ) {
                                    $uifndsod = "sumval";
                                    if (
                                        isset(
                                            ${${"GLOBALS"}[
                                                "usmemtsrbhr"
                                            ]}["sd"]
                                        )
                                    ) {
                                        ${"GLOBALS"}["hxukvhxyirfx"] = "i";
                                        $mbowpnfwqss = "r";
                                        ${"GLOBALS"}["cytwhpib"] = "sumval";
                                        ${"GLOBALS"}["ydrrqiirhe"] =
                                            "sumval";
                                        $grp->counters[
                                            ${${"GLOBALS"}["hxukvhxyirfx"]}
                                        ]["summary"][
                                            ${${"GLOBALS"}["gwvcvcydgs"]}
                                        ]["vd"] = $this->groupCalcs(
                                            ${${"GLOBALS"}["ydrrqiirhe"]}["st"],
                                            ${${"GLOBALS"}["cytwhpib"]}["vd"],
                                            ${${"GLOBALS"}["usmemtsrbhr"]}[
                                                "sd"
                                            ],
                                            ${$mbowpnfwqss},
                                            ${${"GLOBALS"}["usmemtsrbhr"]}[
                                                "sr"
                                            ]
                                        );
                                    }
                                    $grp->counters[$i][
                                        "summary"
                                    ][${${"GLOBALS"}["gwvcvcydgs"]}][
                                        "v"
                                    ] = $this->groupCalcs(
                                        ${${"GLOBALS"}["usmemtsrbhr"]}["st"],
                                        ${$uifndsod}["v"],
                                        ${${"GLOBALS"}["usmemtsrbhr"]}[
                                            "nm"
                                        ],
                                        ${${"GLOBALS"}["pfsyyx"]},
                                        ${${"GLOBALS"}["usmemtsrbhr"]}["sr"]
                                    );
                                }
                                $grp->groups[
                                    $grp->counters[${$yytqvse}]["pos"]
                                ]["summary"] =
                                    $grp->counters[
                                        ${${"GLOBALS"}["ckgavvubpv"]}
                                    ]["summary"];
                            }
                        }
                    }
                }
            }
            $this->groupdata[] = ${${"GLOBALS"}["pfsyyx"]};
            ${${"GLOBALS"}["giplinunxff"]}++;
            if (${${"GLOBALS"}["giplinunxff"]} >= ${$rokzigdjlhv}) {
                break;
            }
        }
        return ${${"GLOBALS"}["xukgqmdv"]};
    }
    protected function findGroupIdx($ind, $offset, $grp)
    {
        $qtfergwef = "offset";
        ${${"GLOBALS"}["benxbud"]} = [];
        if (${$qtfergwef} === 0) {
            ${"GLOBALS"}["cskcrcw"] = "grp";
            ${${"GLOBALS"}["benxbud"]} =
                ${${"GLOBALS"}["cskcrcw"]}[${${"GLOBALS"}["scllsntlhu"]}];
        } else {
            ${"GLOBALS"}["tvyuqnexlui"] = "grp";
            $sothueqidw = "id";
            $kiqhksoavtw = "id";
            ${$sothueqidw} =
                ${${"GLOBALS"}["tvyuqnexlui"]}[${${"GLOBALS"}["scllsntlhu"]}][
                    "idx"
                ];
            ${"GLOBALS"}["ogpmedzox"] = "i";
            if (${$kiqhksoavtw} === 0) {
                $ynfvpnswo = "ind";
                $ssnwbuc = "grp";
                ${${"GLOBALS"}["benxbud"]} = ${$ssnwbuc}[${$ynfvpnswo}];
            }
            ${"GLOBALS"}["cjhkrxrpl"] = "ind";
            for (
                ${${"GLOBALS"}["ogpmedzox"]} = ${${"GLOBALS"}["cjhkrxrpl"]};
                $i >= 0;
                $i--
            ) {
                $kevvrdxhwmro = "offset";
                $pyydrvrufpb = "id";
                if (
                    ${${"GLOBALS"}["xukgqmdv"]}[$i][
                        "idx"
                    ] ===
                    ${$pyydrvrufpb} - ${$kevvrdxhwmro}
                ) {
                    ${"GLOBALS"}["kuetltk"] = "grp";
                    ${${"GLOBALS"}["benxbud"]} =
                        ${${"GLOBALS"}["kuetltk"]}[$i];
                    break;
                }
            }
        }
        $efulhbi = "ret";
        return ${$efulhbi};
    }
    protected function js_template($format = "")
    {
        ${${"GLOBALS"}["bwrorcf"]} = func_num_args();
        $thvokqd = "i";
        ${${"GLOBALS"}["xdrntkkcz"]} = func_get_args();
        ${"GLOBALS"}["prxsjm"] = "i";
        ${"GLOBALS"}["kekrpp"] = "args";
        for (
            ${${"GLOBALS"}["prxsjm"]} = 1;
            $i < ${${"GLOBALS"}["bwrorcf"]};
            ${$thvokqd}++
        ) {
            ${"GLOBALS"}["ebddwfdz"] = "i";
            $oeslhmhs = "args";
            if (is_array(${$oeslhmhs}[${${"GLOBALS"}["ebddwfdz"]}])) {
                ${"GLOBALS"}["mbhbpnpnfu"] = "i";
                ${"GLOBALS"}["ffodvdkidl"] = "nmarr";
                ${${"GLOBALS"}["ffodvdkidl"]} =
                    ${${"GLOBALS"}["xdrntkkcz"]}[${${"GLOBALS"}["mbhbpnpnfu"]}];
                ${"GLOBALS"}["kqvqymww"] = "arr";
                foreach (
                    ${${"GLOBALS"}["nimbxldqmn"]}
                    as ${${"GLOBALS"}["jmmpkw"]} =>
                        ${${"GLOBALS"}["kqvqymww"]}
                ) {
                    ${"GLOBALS"}["zyquoexoy"] = "args";
                    ${${"GLOBALS"}["xdrntkkcz"]}[0] = str_replace(
                        "{" . ${${"GLOBALS"}["oivgmcrgwya"]}["nm"] . "}",
                        ${${"GLOBALS"}["oivgmcrgwya"]}["v"],
                        ${${"GLOBALS"}["zyquoexoy"]}[0]
                    );
                }
            } else {
                $ujwbnorlgyl = "args";
                $jnwsdtddyqcq = "i";
                ${${"GLOBALS"}["xdrntkkcz"]}[0] = str_replace(
                    "{" . ($i - 1) . "}",
                    ${$ujwbnorlgyl}[${$jnwsdtddyqcq}],
                    ${${"GLOBALS"}["xdrntkkcz"]}[0]
                );
            }
        }
        return isset(${${"GLOBALS"}["xdrntkkcz"]}[0])
            ? ${${"GLOBALS"}["kekrpp"]}[0]
            : "";
    }
    protected function tmp_file_name($filename)
    {
        $cydiieevcgb = "filename";
        if (${${"GLOBALS"}["qjrhtvktebx"]} == "-" || ${$cydiieevcgb} == "") {
            ${${"GLOBALS"}["iepsnon"]} = sys_get_temp_dir();
            ${${"GLOBALS"}["qjrhtvktebx"]} = tempnam(
                ${${"GLOBALS"}["iepsnon"]},
                "jqGrid_Root"
            );
        }
        return ${${"GLOBALS"}["qjrhtvktebx"]};
    }
    protected function save_to_file($filename, $mixedvar)
    {
        ${"GLOBALS"}["cxmzdak"] = "filename";
        $tyguclqkjw = "fw";
        $sekolcfdfx = "FILEH_";
        ${"GLOBALS"}["zunrhkksnxtt"] = "opw";
        ${"GLOBALS"}["eifcpinxyh"] = "opw";
        ${"GLOBALS"}["yjjbxbtbxbf"] = "filename";
        ${"GLOBALS"}["xvwxvcg"] = "FILEH_";
        ${${"GLOBALS"}["zunrhkksnxtt"]} = "wb";
        ${${"GLOBALS"}["cxmzdak"]} = $this->tmp_file_name(
            ${${"GLOBALS"}["yjjbxbtbxbf"]}
        );
        ${$sekolcfdfx} = fopen(
            ${${"GLOBALS"}["qjrhtvktebx"]},
            ${${"GLOBALS"}["eifcpinxyh"]}
        );
        if (${${"GLOBALS"}["dxkctdbops"]} == false) {
            return "Can\x27t create\x20temporary\x20file.";
        }
        ${"GLOBALS"}["qrkawyaoh"] = "fw";
        ${$tyguclqkjw} = fwrite(
            ${${"GLOBALS"}["dxkctdbops"]},
            ${${"GLOBALS"}["ofxvefi"]}
        );
        if (${${"GLOBALS"}["qrkawyaoh"]} == false) {
            return "Can't write to\x20$filename.\x20Check your path or\x20permissions.";
        }
        fclose(${${"GLOBALS"}["xvwxvcg"]});
        return true;
    }
    private function rs2csv(
        $rs,
        $colmodel,
        $sep = ";",
        $sepreplace = " ",
        $echo = true,
        $filename = "exportdata.csv",
        $addtitles = true,
        $quote = '"',
        $escquote = '"',
        $replaceNewLine = " "
    ) {
        ${"GLOBALS"}["wkifnsm"] = "es";
        $ubqmnlfxb = "rs";
        $gcnxntb = "ncols";
        $fvktvf = "addtitles";
        $sxhjgq = "gS\x51LMaxRows";
        ${"GLOBALS"}["mxwurqfvhkv"] = "NEWLINE";
        ${"GLOBALS"}["diibmyirc"] = "rs";
        if (!${$ubqmnlfxb}) {
            return "";
        }
        ${"GLOBALS"}["wnbguhcy"] = "escquote";
        ${"GLOBALS"}["wwodeqwetr"] = "quote";
        ${${"GLOBALS"}["mxwurqfvhkv"]} = "\r\n";
        ${"GLOBALS"}["kynnxbgh"] = "s";
        ${${"GLOBALS"}["vhiimwn"]} =
            ${${"GLOBALS"}["wnbguhcy"]} . ${${"GLOBALS"}["wwodeqwetr"]};
        $urwfajsxzost = "echo";
        ${"GLOBALS"}["iwbtxnvvnjo"] = "rs";
        ${$sxhjgq} = $this->gSQLMaxRows;
        ${"GLOBALS"}["gghialfjac"] = "ncols";
        ${${"GLOBALS"}["kynnxbgh"]} = "";
        $qstnlmheik = "ncols";
        ${$gcnxntb} = jqGridDB::columnCount(${${"GLOBALS"}["iwbtxnvvnjo"]});
        $model = false;
        $nmodel = is_array(
            $colmodel
        )
            ? count($colmodel)
            : -1;
        if ($nmodel > 0) {
            ${"GLOBALS"}["slwrnx"] = "nmodel";
            ${"GLOBALS"}["ddlshoi"] = "i";
            $qhjdutcl = "i";
            ${"GLOBALS"}["pdudvjnyju"] = "i";
            for (
                ${${"GLOBALS"}["ddlshoi"]} = 0;
                ${${"GLOBALS"}["pdudvjnyju"]} < ${${"GLOBALS"}["slwrnx"]};
                ${$qhjdutcl}++
            ) {
                if (
                    $colmodel[
                        $i
                    ]["name"] == "actions"
                ) {
                    ${"GLOBALS"}["sgwfivu"] = "colmodel";
                    array_splice(
                        ${${"GLOBALS"}["sgwfivu"]},
                        $i,
                        1
                    );
                    $nmodel--;
                    break;
                }
            }
        }
        if (
            $colmodel &&
            $nmodel == ${$qstnlmheik}
        ) {
            ${"GLOBALS"}["quajaqxfnfs"] = "model";
            ${${"GLOBALS"}["quajaqxfnfs"]} = true;
        }
        ${"GLOBALS"}["gbavwwky"] = "i";
        ${${"GLOBALS"}["uscbprxx"]} = [];
        for (
            $i = 0;
            ${${"GLOBALS"}["gbavwwky"]} < ${${"GLOBALS"}["gghialfjac"]};
            $i++
        ) {
            $tabkfjbitbj = "i";
            $odimabi = "field";
            ${"GLOBALS"}["knvyijhilw"] = "i";
            $iigenhiazj = "replaceNewLine";
            $vmvthvcss = "fname";
            $xjjknieaql = "sepreplace";
            ${"GLOBALS"}["xgcmgqmbm"] = "aselect";
            if ($model) {
                $dcqsdotm = "colmodel";
                ${"GLOBALS"}["ixobuyw"] = "i";
                $patdmh = "i";
                ${"GLOBALS"}["ppnekhdgfdr"] = "i";
                ${"GLOBALS"}["kfumorri"] = "colmodel";
                $zmbzlwi = "i";
                $hflunshk = "colmodel";
                ${${"GLOBALS"}["incdddnykwc"]} = isset(
                    $colmodel[${$zmbzlwi}]["label"]
                )
                    ? ${${"GLOBALS"}["kfumorri"]}[${${"GLOBALS"}["ixobuyw"]}][
                        "label"
                    ]
                    : ${$hflunshk}[${$patdmh}]["name"];
                ${"GLOBALS"}["dwzpwwnbrv"] = "field";
                ${${"GLOBALS"}["dwzpwwnbrv"]}["name"] =
                    ${$dcqsdotm}[$i]["name"];
                ${${"GLOBALS"}["xlmyieky"]}[
                    $i
                ] = isset(
                    $colmodel[
                        ${${"GLOBALS"}["ppnekhdgfdr"]}
                    ]["sorttype"]
                )
                    ? $colmodel[
                        $i
                    ]["sorttype"]
                    : "";
            } else {
                $gxndixljsnn = "field";
                ${"GLOBALS"}["mksjnlxv"] = "i";
                ${"GLOBALS"}["xicpqfvrsoa"] = "typearr";
                $field = jqGridDB::getColumnMeta(
                    ${${"GLOBALS"}["mksjnlxv"]},
                    $rs
                );
                ${${"GLOBALS"}["incdddnykwc"]} = ${$gxndixljsnn}["name"];
                ${${"GLOBALS"}["xicpqfvrsoa"]}[
                    $i
                ] = jqGridDB::MetaType(
                    $field,
                    $this->dbtype
                );
            }
            ${${"GLOBALS"}["uscbprxx"]}[$i] =
                ${$odimabi}["name"];
            $ivdsiqa = "i";
            $nuubyzjlvx = "i";
            ${${"GLOBALS"}["qbroefmekyoe"]} = ${$vmvthvcss};
            if (${${"GLOBALS"}["menmaix"]}) {
                $sgnxxvmm = "v";
                $tkaxzgsok = "escquotequote";
                ${$sgnxxvmm} = str_replace(
                    ${${"GLOBALS"}["qvpfljrbeum"]},
                    ${$tkaxzgsok},
                    ${${"GLOBALS"}["qbroefmekyoe"]}
                );
            }
            ${${"GLOBALS"}["qbroefmekyoe"]} = strip_tags(
                str_replace(
                    "\n",
                    ${${"GLOBALS"}["eyhuikufrov"]},
                    str_replace(
                        "\r\n",
                        ${$iigenhiazj},
                        str_replace(
                            ${${"GLOBALS"}["zbaphywqpxk"]},
                            ${$xjjknieaql},
                            ${${"GLOBALS"}["qbroefmekyoe"]}
                        )
                    )
                )
            );
            $ahidden[${$ivdsiqa}] =
                $model &&
                isset(
                    $colmodel[${$tabkfjbitbj}][
                        "hidden"
                    ]
                )
                    ? $colmodel[${$nuubyzjlvx}][
                        "hidden"
                    ]
                    : false;
            if (!$ahidden[${${"GLOBALS"}["knvyijhilw"]}]) {
                $snqkyphpsss = "v";
                ${${"GLOBALS"}["npmqzdfcglsi"]}[] = ${$snqkyphpsss};
            }
            ${${"GLOBALS"}["xgcmgqmbm"]}[$i] = false;
            if (
                $model &&
                isset(
                    $colmodel[
                        $i
                    ]["formatter"]
                )
            ) {
                if (
                    $colmodel[
                        $i
                    ]["formatter"] == "select"
                ) {
                    ${"GLOBALS"}["dloipgpjz"] = "colmodel";
                    ${"GLOBALS"}["jdcuoglnubm"] = "colmodel";
                    ${"GLOBALS"}["tvpgtrf"] = "colmodel";
                    $wbfedosjgqv = "i";
                    $oilaixizs = "i";
                    $wcqvpyxojp = "i";
                    ${${"GLOBALS"}["wyqwkwhq"]} = isset(
                        ${${"GLOBALS"}["tvpgtrf"]}[${$wcqvpyxojp}][
                            "formatoptions"
                        ]
                    )
                        ? $colmodel[${$wbfedosjgqv}][
                            "formatoptions"
                        ]
                        : (isset(
                            ${${"GLOBALS"}["jdcuoglnubm"]}[
                                $i
                            ]["editoptions"]
                        )
                            ? ${${"GLOBALS"}["dloipgpjz"]}[${$oilaixizs}][
                                "editoptions"
                            ]
                            : []);
                    if (isset(${${"GLOBALS"}["wyqwkwhq"]}["value"])) {
                        $nxrivnxyhh = "asl";
                        $ezrqphfqttz = "asl";
                        $xuejetmhpwy = "key";
                        ${"GLOBALS"}["kcxhmpvlcqy"] = "asl";
                        $wabghhi = "sep\x32";
                        ${$wabghhi} = isset(${$nxrivnxyhh}["separator"])
                            ? ${${"GLOBALS"}["kcxhmpvlcqy"]}["separator"]
                            : ":";
                        ${"GLOBALS"}["daoqinpe"] = "list";
                        ${${"GLOBALS"}["xwandwlrh"]} = isset(
                            ${$ezrqphfqttz}["delimiter"]
                        )
                            ? ${${"GLOBALS"}["wyqwkwhq"]}["delimiter"]
                            : ";";
                        ${${"GLOBALS"}["coxxnkmlsht"]} = explode(
                            ${${"GLOBALS"}["xwandwlrh"]},
                            ${${"GLOBALS"}["wyqwkwhq"]}["value"]
                        );
                        ${"GLOBALS"}["fesvdvshkv"] = "val";
                        foreach (
                            ${${"GLOBALS"}["daoqinpe"]}
                            as ${$xuejetmhpwy} => ${${"GLOBALS"}["fesvdvshkv"]}
                        ) {
                            ${"GLOBALS"}["teukvhjvvkk"] = "items";
                            ${"GLOBALS"}["fgpunpgjgt"] = "aselect";
                            $yxcnnwynq = "items";
                            ${"GLOBALS"}["pfvxyw"] = "i";
                            ${${"GLOBALS"}["teukvhjvvkk"]} = explode(
                                ${${"GLOBALS"}["swurhplk"]},
                                ${${"GLOBALS"}["qwgqpbnkmug"]}
                            );
                            ${${"GLOBALS"}["fgpunpgjgt"]}[
                                ${${"GLOBALS"}["pfvxyw"]}
                            ][${${"GLOBALS"}["hlimukpf"]}[0]] =
                                ${$yxcnnwynq}[1];
                        }
                    }
                }
            }
        }
        if (${$fvktvf}) {
            ${"GLOBALS"}["hxqmzqtrdgkn"] = "elements";
            ${${"GLOBALS"}["gckdpyw"]} .=
                implode(
                    ${${"GLOBALS"}["zbaphywqpxk"]},
                    ${${"GLOBALS"}["hxqmzqtrdgkn"]}
                ) . ${${"GLOBALS"}["vntcfvfsimcl"]};
        }
        $fafurwrlyoy = "es";
        ${${"GLOBALS"}["gkfjvbd"]} = $this->userdateformat;
        ${${"GLOBALS"}["siskwhlub"]} = $this->usertimeformat;
        if ($this->dbtype == "mysqli") {
            $semsolv = "fld";
            $wqjgxryuk = "fieldnames";
            ${${"GLOBALS"}["dtdoqofnexa"]} = $rs->field_count;
            ${"GLOBALS"}["lthtpbnrblx"] = "i";
            ${"GLOBALS"}["nslyyvqfhdc"] = "rs";
            ${$wqjgxryuk}[0] = &${${"GLOBALS"}["nslyyvqfhdc"]};
            $khqtjtrhb = "i";
            for (
                ${${"GLOBALS"}["lthtpbnrblx"]} = 0;
                ${$khqtjtrhb} < ${$semsolv};
                $i++
            ) {
                ${"GLOBALS"}["qrmflcyzsb"] = "fieldnames";
                ${${"GLOBALS"}["qrmflcyzsb"]}[$i + 1] =
                    &${${"GLOBALS"}["ntkgmldy"]}[
                        $i
                    ];
            }
            call_user_func_array(
                "mysqli_stmt_bind_result",
                ${${"GLOBALS"}["yvezufu"]}
            );
        }
        ${${"GLOBALS"}["pdwnukluj"]} = 0;
        while (
            ${${"GLOBALS"}["pfsyyx"]} = jqGridDB::fetch_num(
                ${${"GLOBALS"}["diibmyirc"]},
                $this->pdo
            )
        ) {
            $drqihlcl = "i";
            $ucglmzyd = "elements";
            ${"GLOBALS"}["wqfocujhvyii"] = "i";
            $bmocnxmf = "gS\x51LMaxRows";
            if ($this->dbtype == "mysqli") {
                ${"GLOBALS"}["mikjvzleaf"] = "res_arr";
                ${${"GLOBALS"}["pfsyyx"]} = ${${"GLOBALS"}["mikjvzleaf"]};
            }
            $ponbyboh = "i";
            ${$ucglmzyd} = [];
            $pdnhvkvjwuj = "line";
            $i = 0;
            for (
                ${$ponbyboh} = 0;
                ${${"GLOBALS"}["wqfocujhvyii"]} <
                $ncols;
                ${$drqihlcl}++
            ) {
                $tjaovttsqk = "v";
                ${"GLOBALS"}["nlhneszsrv"] = "v";
                ${"GLOBALS"}["zwnxlm"] = "v";
                $evjlxcpsf = "v";
                $hlscuwdyz = "v";
                ${"GLOBALS"}["hvdpipufwi"] = "v";
                ${"GLOBALS"}["cdwcjjmih"] = "datefmt";
                ${"GLOBALS"}["kxklfuivmouu"] = "r";
                ${"GLOBALS"}["ewbquer"] = "sepreplace";
                ${"GLOBALS"}["lsobcle"] = "replaceNewLine";
                if (isset($ahidden[$i]) && $ahidden[$i]) {
                    continue;
                }
                ${"GLOBALS"}["xlqdpiefq"] = "i";
                ${${"GLOBALS"}["qbroefmekyoe"]} =
                    ${${"GLOBALS"}["kxklfuivmouu"]}[
                        $i
                    ];
                if (
                    is_array(
                        $aselect[
                            ${${"GLOBALS"}["xlqdpiefq"]}
                        ]
                    )
                ) {
                    ${"GLOBALS"}["wuquhgpy"] = "i";
                    $iwdeumgdjuk = "i";
                    $rgqhpmsd = "aselect";
                    if (
                        isset(
                            ${$rgqhpmsd}[${${"GLOBALS"}["wuquhgpy"]}][
                                ${${"GLOBALS"}["qbroefmekyoe"]}
                            ]
                        )
                    ) {
                        $gmgmljj = "v";
                        $dnzytip = "v1";
                        ${"GLOBALS"}["nprirwh"] = "v\x31";
                        ${$dnzytip} =
                            $aselect[
                                $i
                            ][${$gmgmljj}];
                        if (${${"GLOBALS"}["nprirwh"]}) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} = ${${"GLOBALS"}[
                                "wuzexrtfjn"
                            ]};
                        }
                    }
                    ${${"GLOBALS"}["xlmyieky"]}[${$iwdeumgdjuk}] = "string";
                }
                ${"GLOBALS"}["lrjpxbaslo"] = "v";
                ${"GLOBALS"}["jjmzpvnq"] = "datefmt";
                $plbjqcrd = "sep";
                ${${"GLOBALS"}["boxgmd"]} =
                    ${${"GLOBALS"}["xlmyieky"]}[$i];
                $jnkdrdmjrezc = "quote";
                $ddlktvt = "v";
                ${"GLOBALS"}["izfvizxge"] = "v";
                switch (${${"GLOBALS"}["boxgmd"]}) {
                    case "date":
                        ${${"GLOBALS"}["qbroefmekyoe"]} =
                            ${${"GLOBALS"}["jjmzpvnq"]} != $this->dbdateformat
                                ? jqGridUtils::parseDate(
                                    $this->dbdateformat,
                                    ${$tjaovttsqk},
                                    ${${"GLOBALS"}["cdwcjjmih"]}
                                )
                                : ${${"GLOBALS"}["hvdpipufwi"]};
                        break;
                    case "datetime":
                        ${${"GLOBALS"}["qbroefmekyoe"]} =
                            ${${"GLOBALS"}["siskwhlub"]} != $this->dbtimeformat
                                ? jqGridUtils::parseDate(
                                    $this->dbtimeformat,
                                    ${${"GLOBALS"}["nlhneszsrv"]},
                                    ${${"GLOBALS"}["siskwhlub"]}
                                )
                                : ${${"GLOBALS"}["qbroefmekyoe"]};
                        break;
                    case "numeric":
                    case "int":
                        ${${"GLOBALS"}["qbroefmekyoe"]} = trim(
                            ${${"GLOBALS"}["zwnxlm"]}
                        );
                        break;
                    default:
                        ${$hlscuwdyz} = trim(
                            ${${"GLOBALS"}["qbroefmekyoe"]}
                        );
                        if (strlen(${${"GLOBALS"}["lrjpxbaslo"]}) == 0) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} = "";
                        }
                }
                if (${${"GLOBALS"}["menmaix"]}) {
                    $kqpsfxku = "v";
                    ${"GLOBALS"}["skxivclm"] = "quote";
                    $lacxeksyn = "escquotequote";
                    ${$kqpsfxku} = str_replace(
                        ${${"GLOBALS"}["skxivclm"]},
                        ${$lacxeksyn},
                        trim(${${"GLOBALS"}["qbroefmekyoe"]})
                    );
                }
                ${$ddlktvt} = strip_tags(
                    str_replace(
                        "\n",
                        ${${"GLOBALS"}["eyhuikufrov"]},
                        str_replace(
                            "\r\n",
                            ${${"GLOBALS"}["lsobcle"]},
                            str_replace(
                                ${$plbjqcrd},
                                ${${"GLOBALS"}["ewbquer"]},
                                ${${"GLOBALS"}["qbroefmekyoe"]}
                            )
                        )
                    )
                );
                if (
                    strpos(
                        ${${"GLOBALS"}["izfvizxge"]},
                        ${${"GLOBALS"}["zbaphywqpxk"]}
                    ) !== false ||
                    strpos(${$evjlxcpsf}, ${$jnkdrdmjrezc}) !== false
                ) {
                    ${"GLOBALS"}["ugjiymgimyo"] = "elements";
                    ${${"GLOBALS"}["ugjiymgimyo"]}[] = "$quote$v$quote";
                } else {
                    ${${"GLOBALS"}["npmqzdfcglsi"]}[] = ${${"GLOBALS"}[
                        "qbroefmekyoe"
                    ]};
                }
            }
            ${${"GLOBALS"}["gckdpyw"]} .=
                implode(
                    ${${"GLOBALS"}["zbaphywqpxk"]},
                    ${${"GLOBALS"}["npmqzdfcglsi"]}
                ) . ${${"GLOBALS"}["vntcfvfsimcl"]};
            ${${"GLOBALS"}["pdwnukluj"]} += 1;
            if (${$pdnhvkvjwuj} >= ${$bmocnxmf}) {
                break;
            }
        }
        if ($this->tmpvar) {
            ${"GLOBALS"}["uncisksmu"] = "i";
            ${"GLOBALS"}["ltpnjxhebr"] = "ncols";
            $qqpfamyo = "i";
            ${"GLOBALS"}["glnfdlrewk"] = "sep";
            $xqnyegs = "i";
            ${${"GLOBALS"}["npmqzdfcglsi"]} = [];
            for (
                ${${"GLOBALS"}["uncisksmu"]} = 0;
                ${$qqpfamyo} < ${${"GLOBALS"}["ltpnjxhebr"]};
                ${$xqnyegs}++
            ) {
                $xpzalwtyyban = "v";
                ${"GLOBALS"}["fnuggi"] = "i";
                $xwxhljjgkm = "sepreplace";
                $ukbgom = "vv";
                ${"GLOBALS"}["mpvpcgsvi"] = "v";
                $gqdowu = "i";
                ${"GLOBALS"}["cjdkfwfpjg"] = "quote";
                $cqbgrmmohqc = "ahidden";
                if (
                    isset($ahidden[${$gqdowu}]) &&
                    ${$cqbgrmmohqc}[${${"GLOBALS"}["fnuggi"]}]
                ) {
                    continue;
                }
                ${"GLOBALS"}["oqndnfe"] = "sep";
                foreach (
                    $this->tmpvar
                    as ${${"GLOBALS"}["dglvfwquwyy"]} => ${$ukbgom}
                ) {
                    ${"GLOBALS"}["hegruwvrkip"] = "key";
                    if (
                        ${${"GLOBALS"}["uscbprxx"]}[
                            $i
                        ] == ${${"GLOBALS"}["hegruwvrkip"]}
                    ) {
                        ${"GLOBALS"}["wpptfimuxm"] = "vv";
                        ${"GLOBALS"}["imhjlqxfbxs"] = "v";
                        ${${"GLOBALS"}["imhjlqxfbxs"]} = ${${"GLOBALS"}[
                            "wpptfimuxm"
                        ]};
                        break;
                    } else {
                        ${${"GLOBALS"}["qbroefmekyoe"]} = "";
                    }
                }
                if (${${"GLOBALS"}["menmaix"]}) {
                    ${"GLOBALS"}["szwmmu"] = "quote";
                    ${"GLOBALS"}["vdoyjczpsqy"] = "escquotequote";
                    ${${"GLOBALS"}["qbroefmekyoe"]} = str_replace(
                        ${${"GLOBALS"}["szwmmu"]},
                        ${${"GLOBALS"}["vdoyjczpsqy"]},
                        trim(${${"GLOBALS"}["qbroefmekyoe"]})
                    );
                }
                ${${"GLOBALS"}["qbroefmekyoe"]} = strip_tags(
                    str_replace(
                        "\n",
                        ${${"GLOBALS"}["eyhuikufrov"]},
                        str_replace(
                            "\r\n",
                            ${${"GLOBALS"}["eyhuikufrov"]},
                            str_replace(
                                ${${"GLOBALS"}["oqndnfe"]},
                                ${$xwxhljjgkm},
                                ${${"GLOBALS"}["mpvpcgsvi"]}
                            )
                        )
                    )
                );
                if (
                    strpos(${$xpzalwtyyban}, ${${"GLOBALS"}["zbaphywqpxk"]}) !==
                        false ||
                    strpos(
                        ${${"GLOBALS"}["qbroefmekyoe"]},
                        ${${"GLOBALS"}["cjdkfwfpjg"]}
                    ) !== false
                ) {
                    ${"GLOBALS"}["uutubjldcz"] = "elements";
                    ${${"GLOBALS"}["uutubjldcz"]}[] = "$quote$v$quote";
                } else {
                    ${${"GLOBALS"}["npmqzdfcglsi"]}[] = ${${"GLOBALS"}[
                        "qbroefmekyoe"
                    ]};
                }
            }
            ${${"GLOBALS"}["gckdpyw"]} .=
                implode(
                    ${${"GLOBALS"}["glnfdlrewk"]},
                    ${${"GLOBALS"}["npmqzdfcglsi"]}
                ) . ${${"GLOBALS"}["vntcfvfsimcl"]};
        }
        ${${"GLOBALS"}["bryhzxmk"]} = $this->getCsvOptions();
        if (!isset(${${"GLOBALS"}["bryhzxmk"]}["save_to_disk_only"])) {
            ${"GLOBALS"}["ueqtwk"] = "es";
            ${${"GLOBALS"}["ueqtwk"]}["save_to_disk_only"] = false;
        }
        if (${$fafurwrlyoy}["save_to_disk_only"] === true) {
            $okfbgcem = "ret";
            $wbrevxfng = "s";
            ${$okfbgcem} = $this->save_to_file(
                ${${"GLOBALS"}["bryhzxmk"]}["disk_file"],
                ${$wbrevxfng}
            );
            ${"GLOBALS"}["yhzbchs"] = "ret";
            if (${${"GLOBALS"}["yhzbchs"]} !== true) {
                $this->errorMessage = ${${"GLOBALS"}["benxbud"]};
                $this->sendErrorHeader();
            }
            return;
        }
        if (${${"GLOBALS"}["wkifnsm"]}["save_to_disk"] === true) {
            $fyndqct = "s";
            ${"GLOBALS"}["mwybbm"] = "es";
            $this->save_to_file(
                ${${"GLOBALS"}["mwybbm"]}["disk_file"],
                ${$fyndqct}
            );
        }
        if (${$urwfajsxzost}) {
            header("Pragma: public");
            header("Expires: 0");
            header("Cache-Control:\x20private");
            ${"GLOBALS"}["xdptjhixqh"] = "filename";
            header("Content-type:\x20application/octet-stream");
            header(
                "Content-Disposition:\x20attachment\x3b filename\x3d\x22" .
                    ${${"GLOBALS"}["xdptjhixqh"]} .
                    "\""
            );
            header("Accept-Ranges:\x20bytes");
            echo ${${"GLOBALS"}["gckdpyw"]};
        } else {
            return ${${"GLOBALS"}["gckdpyw"]};
        }
    }
    public function exportToCsv(
        array $summary = null,
        array $params = null,
        array $colmodel = null,
        $echo = true,
        $filename = "exportdata.csv",
        $sep = ";",
        $sepreplace = " "
    ) {
        $cvhqpbvvekuh = "summary";
        $ybmstebcnov = "sql";
        $rgsmcxsqxmq = "sql";
        ${"GLOBALS"}["uerhevw"] = "sql";
        $cxehnimldwmr = "params";
        ${$ybmstebcnov} = null;
        if ($this->dbtype == "adodb") {
            $this->pdo->SetFetchMode(ADODB_FETCH_NUM);
        }
        ${${"GLOBALS"}["uerhevw"]} = $this->_rs(
            ${$cxehnimldwmr},
            ${$cvhqpbvvekuh},
            false
        );
        if (${$rgsmcxsqxmq}) {
            if (!$this->CSV["file"]) {
                ${"GLOBALS"}["mxjmmrc"] = "filename";
                $this->CSV["file"] =
                    isset(${${"GLOBALS"}["mxjmmrc"]}) &&
                    strlen(${${"GLOBALS"}["qjrhtvktebx"]}) > 0
                        ? ${${"GLOBALS"}["qjrhtvktebx"]}
                        : $this->csvfile;
            }
            if (!$this->CSV["separator"]) {
                $granyc = "sep";
                $ypxlvcnmiw = "sep";
                $this->CSV["separator"] =
                    isset(${$ypxlvcnmiw}) &&
                    strlen(${${"GLOBALS"}["zbaphywqpxk"]}) > 0
                        ? ${$granyc}
                        : $this->csvsep;
            }
            if (!$this->CSV["sepreplace"]) {
                $xrtaxkmbryh = "sepreplace";
                $this->CSV["sepreplace"] =
                    isset(${${"GLOBALS"}["pjiliebi"]}) &&
                    strlen(${$xrtaxkmbryh}) > 0
                        ? ${${"GLOBALS"}["pjiliebi"]}
                        : $this->csvsepreplace;
            }
            ${"GLOBALS"}["xonqvb"] = "colmodel";
            $aaeriomyzh = "ret";
            $fzhpns = "sql";
            ${${"GLOBALS"}["benxbud"]} = $this->rs2csv(
                $sql,
                ${${"GLOBALS"}["xonqvb"]},
                $this->CSV["separator"],
                $this->CSV["sepreplace"],
                ${${"GLOBALS"}["jhjzifvydu"]},
                $this->CSV["file"],
                $this->CSV["addtitles"],
                $this->CSV["quote"],
                $this->CSV["escquote"],
                $this->CSV["replaceNewLine"]
            );
            jqGridDB::closeCursor(${$fzhpns});
            return ${$aaeriomyzh};
        } else {
            return "Error:Could not\x20execute\x20the\x20query";
        }
    }
    protected function rs2pdf($rs, &$pdf, $colmodel = false, $summary = null)
    {
        $ywpygekojcz = "pd";
        $yvakzuorgy = "s";
        ${$yvakzuorgy} = "";
        $rwjaqkyc = "pw";
        ${${"GLOBALS"}["curlztfmp"]} = 0;
        $gSQLMaxRows = $this->gSQLMaxRows;
        if (!$rs) {
            printf("Bad Record\x20set\x20rs2pdf");
            return false;
        }
        ${"GLOBALS"}["kmwshjklc"] = "pdf";
        ${"GLOBALS"}["erbjtgnlqjw"] = "pd";
        ${${"GLOBALS"}["xlmyieky"]} = [];
        ${"GLOBALS"}["lbgrmbjfyt"] = "r";
        ${"GLOBALS"}["dzeunbuw"] = "colwidth";
        ${"GLOBALS"}["ufradf"] = "maxheigh";
        $ncols = jqGridDB::columnCount($rs);
        ${"GLOBALS"}["jhhgahf"] = "pd";
        $model = false;
        $nmodel = is_array($colmodel)?count($colmodel):-1;
        if ($nmodel > 0) {
            for ($i = 0;$i < $nmodel;$i++) {
                if ($colmodel[$i]["name"] == "actions") {
                    array_splice($colmodel, $i, 1);
                    $nmodel--;
                    break;
                }
            }
        }
		switch ($this->dbtype) {
            case "oci8":
            case "db2":
            case "sqlsrv":
            case "odbcsqlsrv":
                $nmodel++;
                break;
        }
        if ($colmodel && $nmodel == $ncols) {
            $model = true;
        }
        $ahidden = [];
        $aselect = [];
        $totw = 0;
        $mppoteivuw = "pd";
        ${$rwjaqkyc} = $pdf->getPageWidth();
        $margins = $pdf->getMargins();
        $pw = $pw - $margins["left"] - $margins["right"];
        $qivdltd = "fill";
        $tcedbndm = "maxheigh";
        for ($i = 0; $i < $ncols;$i++) {
            //$ahidden[$i]=true;
			if (isset($colmodel[$i])) {
                $oqzqcwj = "colmodel";
                $ahidden[$i] = $model && isset($colmodel[$i]["hidden"]) ? $colmodel[$i]["hidden"] : false;
                $colwidth[$i] = $model && isset($colmodel[$i]["width"]) ? (int) ${$oqzqcwj}[$i]["width"] : 150;
                if ($ahidden[$i]) {
                    continue;
                }
                $totw =$totw + $colwidth[$i];
            }
        }
        $pd = $this->PDF;
        $pdf->SetLineWidth(0.2);
        $field = [];
        ${${"GLOBALS"}["zeyxwxhvn"]} = [];
        $tbklcffh = "datefmt";
        function colorToDec($pdfl, $str)
        {
            if (method_exists(${${"GLOBALS"}["nnqsybqotgeb"]},"convertHTMLColorToDec")) {
                return $pdfl->convertHTMLColorToDec(${${"GLOBALS"}["jteoipyqor"]});
            } else {
                ${${"GLOBALS"}["jprujgcsncg"]} = $pdfl->getAllSpotColors();
                return TCPDF_COLORS::convertHTMLColorToDec(${${"GLOBALS"}["jteoipyqor"]},${${"GLOBALS"}["jprujgcsncg"]});
            }
        }
        function printTHeader($ncols,$maxheigh,$awidth,$aname,$ahidden,$pdf,$pd) {
            ${"GLOBALS"}["tvhrssormecb"] = "pd";
            $ppduddue = "pdf";
            $wxzctejca = "pd";
            $pdf->SetFillColorArray(
                colorToDec(${$ppduddue}, ${$wxzctejca}["grid_head_color"])
            );
            $pdf->SetTextColorArray(
                colorToDec(
                    $pdf,
                    ${${"GLOBALS"}["tvhrssormecb"]}[
                        "grid_head_text_color"
                    ]
                )
            );
            $pdf->SetDrawColorArray(
                colorToDec(
                    $pdf,
                    $pd["grid_draw_color"]
                )
            );
            $pdf->SetFont("", "B");
            for($i=0;$i<$ncols;$i++) {
                if ($ahidden[$i]) {
                    continue;
                }
                if (!$pd["shrink_header"]) {
                    ${"GLOBALS"}["vwpudre"] = "maxheigh";
                    ${"GLOBALS"}["dccqiawl"] = "aname";
                    $pdf->MultiCell(
                        ${${"GLOBALS"}["qwloaihb"]}[
                            $i
                        ],
                        ${${"GLOBALS"}["vwpudre"]},
                        ${${"GLOBALS"}["dccqiawl"]}[
                            $i
                        ],
                        1,
                        "C",
                        true,
                        0,
                        "",
                        "",
                        true,
                        0,
                        true,
                        true,
                        0,
                        "B",
                        false
                    );
                } else {
                    $szakvmxgxos = "pd";
                    ${"GLOBALS"}["dvpdomcc"] = "awidth";
                    $pdf->Cell(
                        ${${"GLOBALS"}["dvpdomcc"]}[
                            $i
                        ],
                        ${$szakvmxgxos}["grid_header_height"],
                        ${${"GLOBALS"}["yrghuenpe"]}[
                            $i
                        ],
                        1,
                        0,
                        "C",
                        1,
                        "",
                        1
                    );
                }
            }
        }
        ${$tcedbndm} = ${$ywpygekojcz}["grid_header_height"];
        for($i = 0;$i<$ncols;$i++) {
            ${"GLOBALS"}["pvbbjsj"] = "i";
            $emomksmydr = "i";
            $ftzkhon = "i";
            $dgpjtjuzwxgx = "colmodel";
            $aselect[${${"GLOBALS"}["pvbbjsj"]}] = false;
            ${"GLOBALS"}["binctsh"] = "colmodel";
            ${"GLOBALS"}["lgqgjwjrrm"] = "i";
            if ($model && isset($colmodel[$i]) && isset($colmodel[$i]["formatter"])) {
                $byetfgk = "colmodel";
                if (${$byetfgk}[$i]["formatter"] =="select") {
                    ${"GLOBALS"}["baxrlfhawdv"] = "colmodel";
                    $cglnmfyen = "i";
                    $xvewlwcjcdy = "colmodel";
                    ${"GLOBALS"}["ocgbybymsdis"] = "i";
                    ${${"GLOBALS"}["wyqwkwhq"]} = isset(
                        ${${"GLOBALS"}["baxrlfhawdv"]}[
                            $i
                        ]["formatoptions"]
                    )
                        ? ${$xvewlwcjcdy}[$i][
                            "formatoptions"
                        ]
                        : (isset(
                            $colmodel[
                                ${${"GLOBALS"}["ocgbybymsdis"]}
                            ]["editoptions"]
                        )
                            ? $colmodel[${$cglnmfyen}][
                                "editoptions"
                            ]
                            : []);
                    if (isset(${${"GLOBALS"}["wyqwkwhq"]}["value"])) {
                        ${"GLOBALS"}["rjmrqnejp"] = "sep";
                        $qowwbelkbix = "delim";
                        $hsxsfumz = "key";
                        ${"GLOBALS"}["ggoehigcwodt"] = "asl";
                        ${"GLOBALS"}["cwxfprdjfv"] = "asl";
                        $dmaomvlf = "asl";
                        ${${"GLOBALS"}["rjmrqnejp"]} = isset(
                            ${${"GLOBALS"}["ggoehigcwodt"]}["separator"]
                        )
                            ? ${${"GLOBALS"}["wyqwkwhq"]}["separator"]
                            : ":";
                        ${$qowwbelkbix} = isset(
                            ${${"GLOBALS"}["cwxfprdjfv"]}["delimiter"]
                        )
                            ? ${$dmaomvlf}["delimiter"]
                            : "\x3b";
                        ${${"GLOBALS"}["coxxnkmlsht"]} = explode(
                            ${${"GLOBALS"}["xwandwlrh"]},
                            ${${"GLOBALS"}["wyqwkwhq"]}["value"]
                        );
                        foreach (${${"GLOBALS"}["coxxnkmlsht"]} as ${$hsxsfumz} => ${${"GLOBALS"}["qwgqpbnkmug"]}) {
                            ${"GLOBALS"}["sifpfqrs"] = "items";
                            $vdjegufgkql = "sep";
                            $ogmjndfr = "aselect";
                            ${"GLOBALS"}["ofjdwn"] = "i";
                            ${${"GLOBALS"}["hlimukpf"]} = explode(${$vdjegufgkql},${${"GLOBALS"}["qwgqpbnkmug"]});
                            ${$ogmjndfr}[${${"GLOBALS"}["ofjdwn"]}][
                                ${${"GLOBALS"}["hlimukpf"]}[0]
                            ] = ${${"GLOBALS"}["sifpfqrs"]}[1];
                        }
                    }
                }
            }
            ${"GLOBALS"}["yimwprgnb"] = "i";
            ${${"GLOBALS"}["zeyxwxhvn"]}[$i] = "";
            $ufrodkuf = "i";
            $oqgnniux = "i";
            ${"GLOBALS"}["fztjycgow"] = "pd";
            $pyfoqkgt = "colwidth";
            if ($model && isset($colmodel[$i])) {
                ${"GLOBALS"}["ujfxjkhwp"] = "i";
                $rycgmfuqq = "colmodel";
                ${"GLOBALS"}["hbstodlzv"] = "i";
                ${"GLOBALS"}["sepmibmbs"] = "i";
                ${"GLOBALS"}["gldeokckbp"] = "i";
                ${"GLOBALS"}["kwesnct"] = "i";
                $ixdthoers = "typearr";
                ${"GLOBALS"}["ewlinfodkq"] = "i";
                $rtttxsgc = "colmodel";
                $nluqpnqseyi = "colmodel";
                $rknafxuemoxt = "align";
                ${"GLOBALS"}["zypfkfzd"] = "i";
                ${${"GLOBALS"}["incdddnykwc"]}[
                    ${${"GLOBALS"}["gldeokckbp"]}
                ] = isset(${$rtttxsgc}[$i]["label"])
                    ? $colmodel[
                        ${${"GLOBALS"}["ujfxjkhwp"]}
                    ]["label"]
                    : $colmodel[
                        ${${"GLOBALS"}["kwesnct"]}
                    ]["name"];
                ${$ixdthoers}[$i] = isset(
                    $colmodel[
                        $i
                    ]["sorttype"]
                )
                    ? ${$rycgmfuqq}[${${"GLOBALS"}["ewlinfodkq"]}]["sorttype"]
                    : "";
                ${$rknafxuemoxt}[${${"GLOBALS"}["zypfkfzd"]}] = isset(
                    $colmodel[
                        ${${"GLOBALS"}["hbstodlzv"]}
                    ]["align"]
                )
                    ? strtoupper(substr(${$nluqpnqseyi}[${${"GLOBALS"}["sepmibmbs"]}]["align"],0,1))
                    : "L";
            } else {
                ${"GLOBALS"}["yjsutevnkg"] = "align";
                $field = jqGridDB::getColumnMeta($i,$rs);
                $fname[$i] = $field["name"];
                ${${"GLOBALS"}["xlmyieky"]}[$i] = jqGridDB::MetaType($field, $this->dbtype);
                ${${"GLOBALS"}["yjsutevnkg"]}[$i] = "L";
            }
            ${"GLOBALS"}["acfbmnix"] = "i";
            if(strtolower($fname[$i])== "jqgrid_row") {
                $ahidden[$i] = true;
            }
            $zyhsiesrp = "colwidth";
            if ($ahidden[$i]) {
                continue;
            }
            ${"GLOBALS"}["ovqflg"] = "fname";
            ${"GLOBALS"}["ulmhhuepmy"] = "pw";
            ${${"GLOBALS"}["ovqflg"]}[
                ${${"GLOBALS"}["yimwprgnb"]}
            ] = htmlspecialchars(${${"GLOBALS"}["incdddnykwc"]}[${$ufrodkuf}]);
            ${${"GLOBALS"}["zeyxwxhvn"]}[
                $i
            ] = $model
                ? ${${"GLOBALS"}["binctsh"]}[${${"GLOBALS"}["lgqgjwjrrm"]}][
                    "name"
                ]
                : ${${"GLOBALS"}["incdddnykwc"]}[${${"GLOBALS"}["acfbmnix"]}];
            ${$zyhsiesrp}[${$oqgnniux}] =
                ($colwidth[${$ftzkhon}] /
                    $totw) *
                100;
            $colwidth[$i] =
                (${${"GLOBALS"}["ulmhhuepmy"]} / 100) *
                ${$pyfoqkgt}[$i];
            if (strlen(${${"GLOBALS"}["incdddnykwc"]}[${$emomksmydr}]) == 0) {
                ${"GLOBALS"}["mfvcrff"] = "i";
                ${"GLOBALS"}["kedqgtuh"] = "fname";
                ${${"GLOBALS"}["kedqgtuh"]}[${${"GLOBALS"}["mfvcrff"]}] = "";
            }
            if (!${${"GLOBALS"}["fztjycgow"]}["shrink_header"]) {
                $dncqvdeg = "i";
                ${${"GLOBALS"}["zrdlmlnkim"]} = max(
                    ${${"GLOBALS"}["zrdlmlnkim"]},
                    $pdf->getStringHeight(
                        $colwidth[${$dncqvdeg}],
                        ${${"GLOBALS"}["incdddnykwc"]}[
                            $i
                        ],
                        false,
                        true,
                        "",
                        1
                    )
                );
            }
        }
        printTHeader(
            $ncols,
            ${${"GLOBALS"}["ufradf"]},
            ${${"GLOBALS"}["dzeunbuw"]},
            ${${"GLOBALS"}["incdddnykwc"]},
            $ahidden,
            $pdf,
            ${${"GLOBALS"}["erbjtgnlqjw"]}
        );
        $pdf->Ln();
        if ($this->dbtype == "mysqli") {
            ${"GLOBALS"}["gqwziqeg"] = "fld";
            $oyplfseqodgd = "fieldnames";
            ${${"GLOBALS"}["dtdoqofnexa"]} = $rs->field_count;
            ${"GLOBALS"}["ognkrrdnmgdo"] = "rs";
            ${$oyplfseqodgd}[0] = &${${"GLOBALS"}["ognkrrdnmgdo"]};
            for (
                $i = 0;
                $i < ${${"GLOBALS"}["gqwziqeg"]};
                $i++
            ) {
                $plzcgxxvb = "res_arr";
                ${${"GLOBALS"}["yvezufu"]}[$i + 1] =
                    &${$plzcgxxvb}[$i];
            }
            call_user_func_array(
                "mysqli_stmt_bind_result",
                ${${"GLOBALS"}["yvezufu"]}
            );
        }
        ${$tbklcffh} = $this->userdateformat;
        ${"GLOBALS"}["xpufhinl"] = "pdf";
        ${${"GLOBALS"}["siskwhlub"]} = $this->usertimeformat;
        $pdf->SetFillColorArray(
            colorToDec(
                ${${"GLOBALS"}["kmwshjklc"]},
                ${$mppoteivuw}["grid_row_color"]
            )
        );
        $pdf->SetTextColorArray(
            colorToDec(
                ${${"GLOBALS"}["xpufhinl"]},
                ${${"GLOBALS"}["jhhgahf"]}["grid_row_text_color"]
            )
        );
        $pdf->SetFont("");
        ${$qivdltd} = false;
        if (!$pd["shrink_cell"]) {
            $mcutguehlfj = "dimensions";
            ${$mcutguehlfj} = $pdf->getPageDimensions();
        }
        while (
            ${${"GLOBALS"}["lbgrmbjfyt"]} = jqGridDB::fetch_num(
                $rs,
                $this->pdo
            )
        ) {
            ${"GLOBALS"}["yuncujla"] = "ncols";
            ${"GLOBALS"}["lhfhqvzruoi"] = "pd";
            $mkjmyxro = "varr";
            if ($this->dbtype == "mysqli") {
                ${${"GLOBALS"}["pfsyyx"]} = ${${"GLOBALS"}["ntkgmldy"]};
            }
            ${$mkjmyxro} = [];
            ${${"GLOBALS"}["rydvgfnrjprj"]} =
                $pd["grid_row_height"];
            for (
                $i = 0;
                $i < ${${"GLOBALS"}["yuncujla"]};
                $i++
            ) {
                $mhxwksp = "ahidden";
                $oqkjfrw = "v";
                $gbbvbbkoks = "aselect";
                $nfvqsfdgipt = "i";
                ${"GLOBALS"}["grxzfwqcdor"] = "pd";
                $smtgtekf = "timefmt";
                ${"GLOBALS"}["blsowhlpdd"] = "timefmt";
                if (
                    isset(${$mhxwksp}[${$nfvqsfdgipt}]) &&
                    $ahidden[$i]
                ) {
                    continue;
                }
                $uwjsjznbofut = "v";
                $rtvydky = "v";
                ${${"GLOBALS"}["qbroefmekyoe"]} =
                    ${${"GLOBALS"}["pfsyyx"]}[$i];
                $rmphefxl = "v";
                ${"GLOBALS"}["eeqnogkjet"] = "v";
                $wmggfgcebqo = "v";
                $mlgliijoiv = "i";
                if (is_array(${$gbbvbbkoks}[$i])) {
                    ${"GLOBALS"}["kdjmdem"] = "v";
                    $inveyntspxk = "aselect";
                    if (
                        isset(
                            ${$inveyntspxk}[$i][
                                ${${"GLOBALS"}["kdjmdem"]}
                            ]
                        )
                    ) {
                        ${"GLOBALS"}["zxmtmpmv"] = "v1";
                        ${${"GLOBALS"}["wuzexrtfjn"]} =
                            $aselect[
                                $i
                            ][${${"GLOBALS"}["qbroefmekyoe"]}];
                        ${"GLOBALS"}["xwwblqwefv"] = "v";
                        if (${${"GLOBALS"}["wuzexrtfjn"]}) {
                            ${${"GLOBALS"}["xwwblqwefv"]} = ${${"GLOBALS"}[
                                "zxmtmpmv"
                            ]};
                        }
                    }
                    ${${"GLOBALS"}["xlmyieky"]}[
                        $i
                    ] = "string";
                }
                ${${"GLOBALS"}["boxgmd"]} =
                    ${${"GLOBALS"}["xlmyieky"]}[${$mlgliijoiv}];
                switch (${${"GLOBALS"}["boxgmd"]}) {
                    case "date":
                        ${${"GLOBALS"}["qbroefmekyoe"]} =
                            ${${"GLOBALS"}["gkfjvbd"]} != $this->dbdateformat
                                ? jqGridUtils::parseDate(
                                    $this->dbdateformat,
                                    ${${"GLOBALS"}["qbroefmekyoe"]},
                                    ${${"GLOBALS"}["gkfjvbd"]}
                                )
                                : ${$rmphefxl};
                        break;
                    case "datetime":
                        ${${"GLOBALS"}["eeqnogkjet"]} =
                            ${${"GLOBALS"}["blsowhlpdd"]} != $this->dbtimeformat
                                ? jqGridUtils::parseDate(
                                    $this->dbtimeformat,
                                    ${$wmggfgcebqo},
                                    ${$smtgtekf}
                                )
                                : ${$oqkjfrw};
                        break;
                    case "numeric":
                    case "int":
                        ${$rtvydky} = trim(${$uwjsjznbofut});
                        break;
                    default:
                        ${${"GLOBALS"}["qbroefmekyoe"]} = trim(
                            ${${"GLOBALS"}["qbroefmekyoe"]}
                        );
                        if (strlen(${${"GLOBALS"}["qbroefmekyoe"]}) == 0) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} = "";
                        }
                }
                if (!${${"GLOBALS"}["grxzfwqcdor"]}["shrink_cell"]) {
                    $dvnuwdwocm = "v";
                    ${"GLOBALS"}["ahzyqoafii"] = "colwidth";
                    ${${"GLOBALS"}["xcwssjn"]}[
                        $i
                    ] = ${${"GLOBALS"}["qbroefmekyoe"]};
                    ${${"GLOBALS"}["rydvgfnrjprj"]} = max(
                        ${${"GLOBALS"}["rydvgfnrjprj"]},
                        $pdf->getStringHeight(
                            ${${"GLOBALS"}["ahzyqoafii"]}[
                                $i
                            ],
                            ${$dvnuwdwocm},
                            false,
                            true,
                            "",
                            1
                        )
                    );
                } else {
                    $agajuqloprc = "fill";
                    $tkqypu = "i";
                    ${"GLOBALS"}["zjpbvurz"] = "pd";
                    $pdf->Cell(
                        $colwidth[${$tkqypu}],
                        ${${"GLOBALS"}["zjpbvurz"]}["grid_row_height"],
                        ${${"GLOBALS"}["qbroefmekyoe"]},
                        1,
                        0,
                        ${${"GLOBALS"}["dhojgadfn"]}[
                            $i
                        ],
                        ${$agajuqloprc},
                        "",
                        1
                    );
                }
            }
            $hfcfkfi = "gS\x51LMaxRows";
            ${"GLOBALS"}["kysfzvhqlsb"] = "rows";
            if (!$pd["shrink_cell"]) {
                $bzcqqrjtdxw = "startY";
                ${"GLOBALS"}["hlsofrfs"] = "dimensions";
                ${${"GLOBALS"}["nuxoipvneiq"]} = $pdf->GetY();
                $genbdqkun = "ncols";
                if (
                    ${$bzcqqrjtdxw} +
                        ${${"GLOBALS"}["rydvgfnrjprj"]} +
                        ${${"GLOBALS"}["hlsofrfs"]}["bm"] >
                    ${${"GLOBALS"}["nmoxxcx"]}["hk"]
                ) {
                    $pdf->AddPage();
                    if (
                        $pd["reprint_grid_header"]
                    ) {
                        $yvvrnvxvum = "ncols";
                        $wrysplxed = "colwidth";
                        $tiroukvkqy = "pd";
                        printTHeader(
                            ${$yvvrnvxvum},
                            ${${"GLOBALS"}["zrdlmlnkim"]},
                            ${$wrysplxed},
                            ${${"GLOBALS"}["incdddnykwc"]},
                            $ahidden,
                            $pdf,
                            $pd
                        );
                        $pdf->Ln();
                        $pdf->SetFillColorArray(
                            colorToDec(
                                $pdf,
                                ${$tiroukvkqy}["grid_row_color"]
                            )
                        );
                        $pdf->SetTextColorArray(
                            colorToDec(
                                $pdf,
                                $pd[
                                    "grid_row_text_color"
                                ]
                            )
                        );
                        $pdf->SetFont("");
                    }
                }
                $otvogof = "i";
                for (
                    $i = 0;
                    ${$otvogof} < ${$genbdqkun};
                    $i++
                ) {
                    ${"GLOBALS"}["xhpzcqxjwd"] = "i";
                    ${"GLOBALS"}["lgvkvg"] = "fill";
                    ${"GLOBALS"}["pyoselg"] = "i";
                    $hxngmmrmv = "varr";
                    ${"GLOBALS"}["uahjlljk"] = "i";
                    ${"GLOBALS"}["lgtqqfstxn"] = "maxh";
                    if (
                        isset(
                            $ahidden[
                                $i
                            ]
                        ) &&
                        $ahidden[${${"GLOBALS"}["uahjlljk"]}]
                    ) {
                        continue;
                    }
                    $pdf->MultiCell(
                        $colwidth[
                            $i
                        ],
                        ${${"GLOBALS"}["lgtqqfstxn"]},
                        ${$hxngmmrmv}[${${"GLOBALS"}["pyoselg"]}],
                        1,
                        ${${"GLOBALS"}["dhojgadfn"]}[
                            ${${"GLOBALS"}["xhpzcqxjwd"]}
                        ],
                        ${${"GLOBALS"}["lgvkvg"]},
                        0,
                        "",
                        "",
                        true,
                        0,
                        true,
                        true,
                        0,
                        "T",
                        false
                    );
                }
            }
            if (${${"GLOBALS"}["lhfhqvzruoi"]}["grid_alternate_rows"]) {
                $jupaibbxkgem = "fill";
                ${${"GLOBALS"}["cfyyhwbpmxd"]} = !${$jupaibbxkgem};
            }
            $pdf->Ln();
            ${${"GLOBALS"}["kysfzvhqlsb"]} += 1;
            if (${${"GLOBALS"}["curlztfmp"]} >= ${$hfcfkfi}) {
                break;
            }
        }
        if ($this->tmpvar) {
            $cenvsbhi = "i";
            ${"GLOBALS"}["vdulhdudm"] = "ncols";
            $pdf->SetFont("", "B");
            for (
                ${$cenvsbhi} = 0;
                $i < ${${"GLOBALS"}["vdulhdudm"]};
                $i++
            ) {
                $ndufpjuqvch = "i";
                $fqfxmnlp = "vv";
                $koqhbnriuy = "i";
                $emusgvtmcst = "ahidden";
                ${"GLOBALS"}["zbuuzekgxoq"] = "fill";
                ${"GLOBALS"}["gtbemhkjx"] = "i";
                ${"GLOBALS"}["husygquvwmm"] = "key";
                $dgjruyu = "align";
                if (
                    isset(${$emusgvtmcst}[${${"GLOBALS"}["gtbemhkjx"]}]) &&
                    $ahidden[${$koqhbnriuy}]
                ) {
                    continue;
                }
                ${${"GLOBALS"}["cdpuirmgomj"]} = "";
                ${"GLOBALS"}["rfblpkpm"] = "pd";
                ${"GLOBALS"}["csrwjiw"] = "colwidth";
                ${"GLOBALS"}["yvtuixogiwi"] = "v";
                foreach (
                    $this->tmpvar
                    as ${${"GLOBALS"}["husygquvwmm"]} =>
                        ${${"GLOBALS"}["yvtuixogiwi"]}
                ) {
                    $vntjali = "key";
                    $vghyvaxlrxz = "fnmkeys";
                    if (
                        ${$vghyvaxlrxz}[$i] ==
                        ${$vntjali}
                    ) {
                        ${${"GLOBALS"}["cdpuirmgomj"]} = ${${"GLOBALS"}[
                            "qbroefmekyoe"
                        ]};
                        break;
                    }
                }
                $pdf->Cell(
                    ${${"GLOBALS"}["csrwjiw"]}[${$ndufpjuqvch}],
                    ${${"GLOBALS"}["rfblpkpm"]}["grid_row_height"],
                    ${$fqfxmnlp},
                    1,
                    0,
                    ${$dgjruyu}[$i],
                    ${${"GLOBALS"}["zbuuzekgxoq"]},
                    "",
                    1
                );
            }
        }
    }
    protected function rs2pdf2(&$pdf, $grpinfo = null)
    {
        $zmvhtxp = "timefmt";
        $tzddsofuc = "ncols";
        ${"GLOBALS"}["wkmcumcxjmlu"] = "margins";
        ${"GLOBALS"}["kfrdwpf"] = "n";
        ${"GLOBALS"}["cutvtaf"] = "grpopt";
        ${$tzddsofuc} = count($grpinfo->columns);
        $mbfpmrsgrib = "pdf";
        $totw = 0;
        ${"GLOBALS"}["zxooqu"] = "pw";
        $ypzvcuhf = "margins";
        $pw = $pdf->getPageWidth();
        $ixvtgle = "fill";
        $mnjtkjbk = "pd";
        ${${"GLOBALS"}["wkmcumcxjmlu"]} = $pdf->getMargins();
        ${${"GLOBALS"}["zxooqu"]} =
            $pw -
            ${$ypzvcuhf}["left"] -
            $margins["right"];
        ${"GLOBALS"}["wvfcdsjneirp"] = "grpopt";
        ${"GLOBALS"}["qeiptzothen"] = "pd";
        $pd = $this->PDF;
        ${"GLOBALS"}["xeopomitvvf"] = "maxheigh";
        ${"GLOBALS"}["hlfplqy"] = "i";
        $qcldxksyol = "pdf";
        $pdf->SetLineWidth(0.2);
        function colorToDec2($pdfl, $str)
        {
            if (
                method_exists(
                    ${${"GLOBALS"}["nnqsybqotgeb"]},
                    "convertHTMLColorToDec"
                )
            ) {
                ${"GLOBALS"}["ocedmboibp"] = "str";
                return $pdfl->convertHTMLColorToDec(
                    ${${"GLOBALS"}["ocedmboibp"]}
                );
            } else {
                $mtkaxhccldh = "str";
                $dpixvkrebfb = "asp";
                ${${"GLOBALS"}["jprujgcsncg"]} = $pdfl->getAllSpotColors();
                return TCPDF_COLORS::convertHTMLColorToDec(
                    ${$mtkaxhccldh},
                    ${$dpixvkrebfb}
                );
            }
        }
        function printTHeader2($ncols, $maxheigh, $grinfo, $pdf, $pd)
        {
            $wnmnkfmu = "pd";
            ${"GLOBALS"}["kdfmshlrtj"] = "pdf";
            ${"GLOBALS"}["pcihdwm"] = "pdf";
            $pdf->SetFillColorArray(
                colorToDec2(
                    ${${"GLOBALS"}["pcihdwm"]},
                    ${$wnmnkfmu}["grid_head_color"]
                )
            );
            ${"GLOBALS"}["auwisejxp"] = "i";
            $htxwghbewj = "pd";
            ${"GLOBALS"}["koeyvks"] = "pd";
            $pdf->SetTextColorArray(
                colorToDec2(
                    ${${"GLOBALS"}["kdfmshlrtj"]},
                    ${$htxwghbewj}["grid_head_text_color"]
                )
            );
            $vlothpy = "pdf";
            $pdf->SetDrawColorArray(
                colorToDec2(
                    ${$vlothpy},
                    ${${"GLOBALS"}["koeyvks"]}["grid_draw_color"]
                )
            );
            $pdf->SetFont("", "B");
            for (
                ${${"GLOBALS"}["auwisejxp"]} = 0;
                $i < $ncols;
                $i++
            ) {
                if ($grinfo->columns[$i]["hidden"]) {
                    continue;
                }
                ${"GLOBALS"}["fboieilzdkb"] = "pd";
                if (!${${"GLOBALS"}["fboieilzdkb"]}["shrink_header"]) {
                    ${"GLOBALS"}["rjezspi"] = "maxheigh";
                    ${"GLOBALS"}["qnxfswnbhfx"] = "i";
                    $pdf->MultiCell(
                        $grinfo->columns[${${"GLOBALS"}["qnxfswnbhfx"]}][
                            "width"
                        ],
                        ${${"GLOBALS"}["rjezspi"]},
                        $grinfo->columns[$i]["label"],
                        1,
                        "C",
                        true,
                        0,
                        "",
                        "",
                        true,
                        0,
                        true,
                        true,
                        0,
                        "B",
                        false
                    );
                } else {
                    ${"GLOBALS"}["xqitehqskq"] = "pd";
                    $bkedkuuhfc = "i";
                    $pdf->Cell(
                        $grinfo->columns[${$bkedkuuhfc}]["width"],
                        ${${"GLOBALS"}["xqitehqskq"]}["grid_header_height"],
                        $grinfo->columns[$i]["label"],
                        1,
                        0,
                        "C",
                        1,
                        "",
                        1
                    );
                }
            }
        }
        $totw = 0;
        ${${"GLOBALS"}["xeopomitvvf"]} =
            ${${"GLOBALS"}["qeiptzothen"]}["grid_header_height"];
        for (
            ${${"GLOBALS"}["hlfplqy"]} = 0;
            $i < $ncols;
            $i++
        ) {
            ${"GLOBALS"}["xxuyxspfwg"] = "i";
            $ckqpyuepc = "i";
            ${"GLOBALS"}["twukhsdj"] = "i";
            if (strtolower($grpinfo->columns[$i]["name"]) == "jqgrid_row") {
                ${"GLOBALS"}["xllupqce"] = "i";
                $grpinfo->columns[${${"GLOBALS"}["xllupqce"]}]["hidden"] = true;
            }
            if ($grpinfo->columns[$i]["hidden"]) {
                continue;
            }
            $grpinfo->columns[${${"GLOBALS"}["twukhsdj"]}]["width"] =
                ($grpinfo->columns[${$ckqpyuepc}]["width"] /
                    $grpinfo->totalwidth) *
                $pw;
            $totw +=
                $grpinfo->columns[${${"GLOBALS"}["xxuyxspfwg"]}]["width"];
            if (!$pd["shrink_header"]) {
                $mriffxb = "i";
                $eqjlkfafeue = "maxheigh";
                $hexaydyuky = "maxheigh";
                ${$eqjlkfafeue} = max(
                    ${$hexaydyuky},
                    $pdf->getStringHeight(
                        $colwidth[${$mriffxb}],
                        $grpinfo->columns[$i]["label"],
                        false,
                        true,
                        "",
                        1
                    )
                );
            }
        }
        printTHeader2(
            $ncols,
            ${${"GLOBALS"}["zrdlmlnkim"]},
            ${${"GLOBALS"}["dqertcuk"]},
            $pdf,
            $pd
        );
        $pdf->Ln();
        ${${"GLOBALS"}["gkfjvbd"]} = $this->userdateformat;
        ${$zmvhtxp} = $this->usertimeformat;
        $pdf->SetFillColorArray(
            colorToDec2(
                ${$mbfpmrsgrib},
                $pd["grid_row_color"]
            )
        );
        $pdf->SetTextColorArray(
            colorToDec2(
                ${$qcldxksyol},
                $pd["grid_row_text_color"]
            )
        );
        $pdf->SetFont("");
        ${$ixvtgle} = false;
        ${${"GLOBALS"}["nmoxxcx"]} = [];
        if (!${$mnjtkjbk}["shrink_cell"]) {
            ${"GLOBALS"}["ilnrokxhzlc"] = "dimensions";
            ${${"GLOBALS"}["ilnrokxhzlc"]} = $pdf->getPageDimensions();
        }
        ${${"GLOBALS"}["fwfzxxuwrc"]} = 0;
        ${${"GLOBALS"}["cutvtaf"]} = $this->gridOptions["groupingView"];
        ${${"GLOBALS"}["mvglhjc"]} = count(
            ${${"GLOBALS"}["nseuemktt"]}["group\x46ield"]
        );
        ${${"GLOBALS"}["mjypfvclsj"]} = [];
        if (isset(${${"GLOBALS"}["wvfcdsjneirp"]}["groupSummary"])) {
            $rscwonqtp = "grpopt";
            ${"GLOBALS"}["ceybdeivsgmj"] = "sumreverse";
            ${${"GLOBALS"}["ceybdeivsgmj"]} = array_reverse(
                ${$rscwonqtp}["groupSummary"]
            );
        }
        foreach (
            $grpinfo->groups
            as $i => ${${"GLOBALS"}["kfrdwpf"]}
        ) {
            $osdmjt = "v";
            $hgmeniw = "leaf";
            ${"GLOBALS"}["ijjmjwnvoxm"] = "leaf";
            ${"GLOBALS"}["jhsektftke"] = "pd";
            ${${"GLOBALS"}["fwfzxxuwrc"]}++;
            $acfqpetkcx = "n";
            $xhovjwjm = "grpopt";
            ${$osdmjt} = ${${"GLOBALS"}["wgoaukia"]}["value"];
            $efwqyudiytkt = "totw";
            if (
                !isset(
                    ${$xhovjwjm}["group\x54ext"][
                        ${${"GLOBALS"}["wgoaukia"]}["idx"]
                    ]
                )
            ) {
                ${${"GLOBALS"}["dgiduf"]} = "{\x30}";
            } else {
                $aqcnsloig = "n";
                ${${"GLOBALS"}["dgiduf"]} = strip_tags(
                    ${${"GLOBALS"}["nseuemktt"]}["groupText"][
                        ${$aqcnsloig}["idx"]
                    ]
                );
            }
            $pdf->SetFont("", "B");
            $oeexxjowcir = "gt";
            $pdf->Cell(
                ${$efwqyudiytkt},
                ${${"GLOBALS"}["jhsektftke"]}["grid_row_height"],
                str_repeat("\x20 ", ${${"GLOBALS"}["wgoaukia"]}["idx"]) .
                    $this->js_template(
                        ${$oeexxjowcir},
                        ${${"GLOBALS"}["qbroefmekyoe"]},
                        ${${"GLOBALS"}["wgoaukia"]}["cnt"],
                        ${$acfqpetkcx}["summary"]
                    ),
                1,
                0,
                "L",
                0,
                "",
                1
            );
            ${${"GLOBALS"}["ijjmjwnvoxm"]} =
                ${${"GLOBALS"}["mvglhjc"]} - 1 ===
                ${${"GLOBALS"}["wgoaukia"]}["idx"];
            $pdf->Ln();
            if (${$hgmeniw}) {
                $vjceeuq = "n";
                $tixfozvtiv = "end";
                ${"GLOBALS"}["sbrwwxkuxgvc"] = "gg";
                ${"GLOBALS"}["pkcsqdphr"] = "toEnd";
                if (isset($grpinfo->groups[$i + 1])) {
                    ${"GLOBALS"}["scbcdpthnes"] = "gg";
                    ${"GLOBALS"}["fflhimkedybw"] = "i";
                    $cupmyjetoo = "gg";
                    $fqdwyzo = "end";
                    ${$cupmyjetoo} =
                        $grpinfo->groups[
                            ${${"GLOBALS"}["fflhimkedybw"]} + 1
                        ];
                    ${$fqdwyzo} = ${${"GLOBALS"}["scbcdpthnes"]}["startRow"];
                } else {
                    ${"GLOBALS"}["vcternzmmjwp"] = "end";
                    ${${"GLOBALS"}["bnkmlts"]} = false;
                    ${${"GLOBALS"}[
                        "vcternzmmjwp"
                    ]} = $this->groupdata->count();
                }
                $pdf->SetFont("");
                foreach (
                    new LimitIterator(
                        $this->groupdata,
                        ${$vjceeuq}["startRow"],
                        ${$tixfozvtiv} - ${${"GLOBALS"}["wgoaukia"]}["startRow"]
                    )
                    as ${${"GLOBALS"}["jtoppfkbxi"]}
                ) {
                    $hbrwftlp = "key";
                    ${${"GLOBALS"}["dlqafubuedv"]} = 0;
                    foreach (
                        ${${"GLOBALS"}["jtoppfkbxi"]}
                        as ${$hbrwftlp} => ${${"GLOBALS"}["pfsyyx"]}
                    ) {
                        $pahqjeohv = "datefmt";
                        $pbcyxbfw = "j";
                        ${"GLOBALS"}["ogvsczxsr"] = "v";
                        $oefmyrycexth = "j";
                        $cnocswpsotj = "v";
                        ${"GLOBALS"}["iuiojekif"] = "r";
                        if (
                            $grpinfo->columns[${$oefmyrycexth}]["hidden"] ==
                            true
                        ) {
                            ${${"GLOBALS"}["dlqafubuedv"]}++;
                            continue;
                        }
                        ${${"GLOBALS"}["qbroefmekyoe"]} = ${${"GLOBALS"}[
                            "iuiojekif"
                        ]};
                        if (
                            is_array(
                                $grpinfo->columns[
                                    ${${"GLOBALS"}["dlqafubuedv"]}
                                ]["select"]
                            )
                        ) {
                            $culchab = "j";
                            if (
                                isset(
                                    $grpinfo->columns[${$culchab}]["select"][
                                        ${${"GLOBALS"}["qbroefmekyoe"]}
                                    ]
                                )
                            ) {
                                ${${"GLOBALS"}["wuzexrtfjn"]} =
                                    $grpinfo->columns[
                                        ${${"GLOBALS"}["dlqafubuedv"]}
                                    ]["select"][
                                        ${${"GLOBALS"}["qbroefmekyoe"]}
                                    ];
                                if (${${"GLOBALS"}["wuzexrtfjn"]}) {
                                    ${"GLOBALS"}["zbhhip"] = "v";
                                    $jjwcrc = "v\x31";
                                    ${${"GLOBALS"}["zbhhip"]} = ${$jjwcrc};
                                }
                            }
                            $dzlxvum = "j";
                            $grpinfo->columns[${$dzlxvum}]["type"] = "string";
                        }
                        ${${"GLOBALS"}["xcwssjn"]} = [];
                        ${"GLOBALS"}["kxdygfk"] = "v";
                        $wwzfjvyti = "v";
                        $hmcfsvka = "timefmt";
                        ${${"GLOBALS"}["rydvgfnrjprj"]} =
                            $pd["grid_row_height"];
                        ${"GLOBALS"}["xblcmhcota"] = "v";
                        switch ($grpinfo->columns[${$pbcyxbfw}]["type"]) {
                            case "date":
                                ${${"GLOBALS"}["qbroefmekyoe"]} =
                                    ${$pahqjeohv} != $this->dbdateformat
                                        ? jqGridUtils::parseDate(
                                            $this->dbdateformat,
                                            ${$cnocswpsotj},
                                            ${${"GLOBALS"}["gkfjvbd"]}
                                        )
                                        : ${${"GLOBALS"}["ogvsczxsr"]};
                                break;
                            case "datetime":
                                ${${"GLOBALS"}["qbroefmekyoe"]} =
                                    ${${"GLOBALS"}["siskwhlub"]} !=
                                    $this->dbtimeformat
                                        ? jqGridUtils::parseDate(
                                            $this->dbtimeformat,
                                            ${${"GLOBALS"}["qbroefmekyoe"]},
                                            ${$hmcfsvka}
                                        )
                                        : ${$wwzfjvyti};
                                break;
                            case "numeric":
                            case "int":
                                ${${"GLOBALS"}["xblcmhcota"]} = trim(
                                    ${${"GLOBALS"}["kxdygfk"]}
                                );
                                break;
                            default:
                                ${${"GLOBALS"}["qbroefmekyoe"]} = trim(
                                    ${${"GLOBALS"}["qbroefmekyoe"]}
                                );
                                if (
                                    strlen(
                                        ${${"GLOBALS"}["qbroefmekyoe"]}
                                    ) == 0
                                ) {
                                    ${${"GLOBALS"}["qbroefmekyoe"]} = "";
                                }
                        }
                        if (!$pd["shrink_cell"]) {
                            $jrdjeqs = "v";
                            ${"GLOBALS"}["encmzoabkep"] = "varr";
                            $xhcgbplzn = "maxh";
                            ${"GLOBALS"}["klqeddnd"] = "maxh";
                            ${${"GLOBALS"}["encmzoabkep"]}[
                                ${${"GLOBALS"}["dglvfwquwyy"]}
                            ] = ${$jrdjeqs};
                            ${${"GLOBALS"}["klqeddnd"]} = max(
                                ${$xhcgbplzn},
                                $pdf->getStringHeight(
                                    $grpinfo->columns[
                                        ${${"GLOBALS"}["dlqafubuedv"]}
                                    ]["width"],
                                    ${${"GLOBALS"}["qbroefmekyoe"]},
                                    false,
                                    true,
                                    "",
                                    1
                                )
                            );
                        } else {
                            $fhgoabsq = "j";
                            ${"GLOBALS"}["efehvfynqmq"] = "pd";
                            ${"GLOBALS"}["djbkkjyvk"] = "fill";
                            $qvybcijl = "j";
                            $pdf->Cell(
                                $grpinfo->columns[${$fhgoabsq}]["width"],
                                ${${"GLOBALS"}["efehvfynqmq"]}[
                                    "grid_row_height"
                                ],
                                ${${"GLOBALS"}["qbroefmekyoe"]},
                                1,
                                0,
                                $grpinfo->columns[${$qvybcijl}]["align"],
                                ${${"GLOBALS"}["djbkkjyvk"]},
                                "",
                                1
                            );
                        }
                        ${${"GLOBALS"}["dlqafubuedv"]}++;
                    }
                    if (!$pd["shrink_cell"]) {
                        ${"GLOBALS"}["iuzslwrw"] = "start\x59";
                        $wnyyixif = "ii";
                        ${${"GLOBALS"}["nuxoipvneiq"]} = $pdf->GetY();
                        ${"GLOBALS"}["cbivlvgsbgq"] = "dimensions";
                        if (
                            ${${"GLOBALS"}["iuzslwrw"]} +
                                ${${"GLOBALS"}["rydvgfnrjprj"]} +
                                ${${"GLOBALS"}["cbivlvgsbgq"]}["bm"] >
                            ${${"GLOBALS"}["nmoxxcx"]}["hk"]
                        ) {
                            $doottafynl = "pd";
                            $pdf->AddPage();
                            if (${$doottafynl}["reprint_grid_header"]) {
                                ${"GLOBALS"}["qrgaavsld"] = "grpinfo";
                                ${"GLOBALS"}["nqhnzmx"] = "pdf";
                                $bmfrenkizam = "pdf";
                                $riodckin = "pdf";
                                ${"GLOBALS"}["dukhivcx"] = "maxheigh";
                                ${"GLOBALS"}["fnwbqbjcjid"] = "pd";
                                printTHeader2(
                                    $ncols,
                                    ${${"GLOBALS"}["dukhivcx"]},
                                    ${${"GLOBALS"}["qrgaavsld"]},
                                    ${${"GLOBALS"}["nqhnzmx"]},
                                    ${${"GLOBALS"}["fnwbqbjcjid"]}
                                );
                                $pdf->Ln();
                                $pdf->SetFillColorArray(
                                    colorToDec2(
                                        ${$bmfrenkizam},
                                        $pd[
                                            "grid_row_color"
                                        ]
                                    )
                                );
                                $pdf->SetTextColorArray(
                                    colorToDec2(
                                        ${$riodckin},
                                        $pd[
                                            "grid_row_text_color"
                                        ]
                                    )
                                );
                                $pdf->SetFont("");
                            }
                        }
                        $ekscyw = "ncols";
                        for (
                            ${$wnyyixif} = 0;
                            ${${"GLOBALS"}["cqbtlglxdng"]} < ${$ekscyw};
                            ${${"GLOBALS"}["cqbtlglxdng"]}++
                        ) {
                            ${"GLOBALS"}["lraltmwk"] = "maxh";
                            $weeusoalxl = "fill";
                            $nldbrdlok = "ii";
                            if (
                                $grpinfo->columns[${$nldbrdlok}]["hidden"] ==
                                true
                            ) {
                                continue;
                            }
                            ${"GLOBALS"}["wnmqoulult"] = "ii";
                            ${"GLOBALS"}["qwzrimj"] = "varr";
                            ${"GLOBALS"}["qfvgfdcsvh"] = "ii";
                            $pdf->MultiCell(
                                $grpinfo->columns[
                                    ${${"GLOBALS"}["wnmqoulult"]}
                                ]["width"],
                                ${${"GLOBALS"}["lraltmwk"]},
                                ${${"GLOBALS"}["qwzrimj"]}[
                                    ${${"GLOBALS"}["qfvgfdcsvh"]}
                                ],
                                1,
                                $grpinfo->columns[
                                    ${${"GLOBALS"}["cqbtlglxdng"]}
                                ]["align"],
                                ${$weeusoalxl},
                                0,
                                "",
                                "",
                                true,
                                0,
                                true,
                                true,
                                0,
                                "T",
                                false
                            );
                        }
                    }
                    if (
                        $pd[
                            "grid_alternate_rows"
                        ]
                    ) {
                        ${${"GLOBALS"}["cfyyhwbpmxd"]} = !${${"GLOBALS"}[
                            "cfyyhwbpmxd"
                        ]};
                    }
                    $pdf->Ln();
                }
                if (${${"GLOBALS"}["sbrwwxkuxgvc"]}) {
                    $rctoffwu = "jj";
                    $ihheelsbeuk = "len";
                    ${"GLOBALS"}["wdtnpeicdien"] = "jj";
                    ${"GLOBALS"}["vqfcfdptzcfc"] = "jj";
                    for (
                        ${${"GLOBALS"}["ollhwol"]} = 0;
                        ${${"GLOBALS"}["wdtnpeicdien"]} <
                        ${${"GLOBALS"}["mvglhjc"]};
                        ${$rctoffwu}++
                    ) {
                        if (
                            ${${"GLOBALS"}["bnkmlts"]}["dataIndex"] ===
                            $this->gridOptions["grouping\x56iew"]["groupField"][
                                ${${"GLOBALS"}["ollhwol"]}
                            ]
                        ) {
                            break;
                        }
                    }
                    ${${"GLOBALS"}["fwfzxxuwrc"]} =
                        ${$ihheelsbeuk} - ${${"GLOBALS"}["vqfcfdptzcfc"]};
                }
                for (
                    ${${"GLOBALS"}["dtasvs"]} = 0;
                    ${${"GLOBALS"}["dtasvs"]} < ${${"GLOBALS"}["fwfzxxuwrc"]};
                    ${${"GLOBALS"}["dtasvs"]}++
                ) {
                    $rozpakvll = "fdata";
                    ${"GLOBALS"}["rhnwkpsyyrhg"] = "i";
                    ${"GLOBALS"}["tfgmqcoh"] = "sumreverse";
                    $npxvwlyeqvr = "ik";
                    ${"GLOBALS"}["xpatif"] = "sumreverse";
                    ${"GLOBALS"}["godckub"] = "ij";
                    $qwokigurdfwg = "ik";
                    if (
                        isset(${${"GLOBALS"}["xpatif"]}[${$qwokigurdfwg}]) &&
                        !${${"GLOBALS"}["tfgmqcoh"]}[${$npxvwlyeqvr}]
                    ) {
                        continue;
                    }
                    ${$rozpakvll} = $this->findGroupIdx(
                        ${${"GLOBALS"}["rhnwkpsyyrhg"]},
                        ${${"GLOBALS"}["dtasvs"]},
                        $grpinfo->groups
                    );
                    ${"GLOBALS"}["idjemqy"] = "fdata";
                    ${${"GLOBALS"}["lulxfwx"]} =
                        ${${"GLOBALS"}["idjemqy"]}["cnt"];
                    for (
                        ${${"GLOBALS"}["ygtpwesvvpd"]} = 0;
                        ${${"GLOBALS"}["ygtpwesvvpd"]} <
                        $ncols;
                        ${${"GLOBALS"}["godckub"]}++
                    ) {
                        $ahbddt = "fdata";
                        if (
                            $grpinfo->columns[${${"GLOBALS"}["ygtpwesvvpd"]}][
                                "hidden"
                            ] == true
                        ) {
                            continue;
                        }
                        ${${"GLOBALS"}["qbroefmekyoe"]} = "";
                        ${"GLOBALS"}["mwivndgdbp"] = "tplfld";
                        ${"GLOBALS"}["ybvest"] = "v";
                        ${${"GLOBALS"}["mwivndgdbp"]} = "{0}";
                        $fdtrvgfnhxxn = "sv";
                        foreach (
                            ${$ahbddt}["summary"]
                            as ${${"GLOBALS"}["qggzkhswbi"]} => ${$fdtrvgfnhxxn}
                        ) {
                            $mmdfnfpi = "sv";
                            ${"GLOBALS"}["snhwyrpmgc"] = "ij";
                            if (
                                ${$mmdfnfpi}["nm"] ==
                                $this->colModel[
                                    ${${"GLOBALS"}["snhwyrpmgc"]}
                                ]["name"]
                            ) {
                                if (
                                    isset(
                                        $this->colModel[
                                            ${${"GLOBALS"}["ygtpwesvvpd"]}
                                        ]["summaryTpl"]
                                    )
                                ) {
                                    $efwcvrwqige = "ij";
                                    ${"GLOBALS"}["vkmfadw"] = "tplfld";
                                    ${${"GLOBALS"}["vkmfadw"]} =
                                        $this->colModel[${$efwcvrwqige}][
                                            "summaryTpl"
                                        ];
                                }
                                $nugvmxkvns = "v";
                                ${"GLOBALS"}["efpgeuxv"] = "sv";
                                if (
                                    is_string(
                                        ${${"GLOBALS"}["nsuqwew"]}["st"]
                                    ) &&
                                    strtolower(
                                        ${${"GLOBALS"}["nsuqwew"]}["st"]
                                    ) == "avg"
                                ) {
                                    $myvtoro = "sv";
                                    ${"GLOBALS"}["viwkykgbpoqi"] = "sv";
                                    if (
                                        isset(
                                            ${${"GLOBALS"}["nsuqwew"]}["sd"]
                                        ) &&
                                        (float) ${${"GLOBALS"}["viwkykgbpoqi"]}[
                                            "vd"
                                        ] != 0
                                    ) {
                                        $lkbqqy = "sv";
                                        ${${"GLOBALS"}["nsuqwew"]}["v"] =
                                            ${${"GLOBALS"}["nsuqwew"]}["v"] /
                                            ${$lkbqqy}["vd"];
                                    } elseif (
                                        ${$myvtoro}["v"] &&
                                        ${${"GLOBALS"}["lulxfwx"]} > 0
                                    ) {
                                        $yomlepnv = "sv";
                                        ${$yomlepnv}["v"] =
                                            ${${"GLOBALS"}["nsuqwew"]}["v"] /
                                            ${${"GLOBALS"}["lulxfwx"]};
                                    }
                                }
                                if (
                                    isset(
                                        $this->colModel[
                                            ${${"GLOBALS"}["ygtpwesvvpd"]}
                                        ]["summaryRound"]
                                    )
                                ) {
                                    ${"GLOBALS"}["rpugwldrpf"] = "sv";
                                    ${${"GLOBALS"}["nsuqwew"]}["v"] = round(
                                        ${${"GLOBALS"}["rpugwldrpf"]}["v"],
                                        $this->colModel[
                                            ${${"GLOBALS"}["ygtpwesvvpd"]}
                                        ]["summaryRound"]
                                    );
                                }
                                ${$nugvmxkvns} = $this->js_template(
                                    ${${"GLOBALS"}["xymebptnm"]},
                                    ${${"GLOBALS"}["efpgeuxv"]}["v"]
                                );
                                break;
                            }
                        }
                        $kgdjhb = "pd";
                        $pdf->Cell(
                            $grpinfo->columns[${${"GLOBALS"}["ygtpwesvvpd"]}][
                                "width"
                            ],
                            ${$kgdjhb}["grid_row_height"],
                            ${${"GLOBALS"}["ybvest"]},
                            1,
                            0,
                            $grpinfo->columns[${${"GLOBALS"}["ygtpwesvvpd"]}][
                                "align"
                            ],
                            0,
                            "",
                            1
                        );
                    }
                    $pdf->Ln();
                }
                ${${"GLOBALS"}["pkcsqdphr"]} = ${${"GLOBALS"}["ollhwol"]};
            }
        }
        if ($this->tmpvar) {
            ${"GLOBALS"}["dqppvi"] = "i";
            $pdf->SetFont("", "B");
            ${"GLOBALS"}["rxvfpkpcc"] = "ncols";
            for (
                $i = 0;
                $i < ${${"GLOBALS"}["rxvfpkpcc"]};
                ${${"GLOBALS"}["dqppvi"]}++
            ) {
                ${"GLOBALS"}["ujaknnkqd"] = "fill";
                ${"GLOBALS"}["ntfltxmbklze"] = "v";
                if (
                    $grpinfo->columns[$i]["hidden"] ==
                    true
                ) {
                    continue;
                }
                ${${"GLOBALS"}["cdpuirmgomj"]} = "";
                foreach (
                    $this->tmpvar
                    as ${${"GLOBALS"}["dglvfwquwyy"]} =>
                        ${${"GLOBALS"}["ntfltxmbklze"]}
                ) {
                    ${"GLOBALS"}["fqpkcsshd"] = "i";
                    ${"GLOBALS"}["gcfojvu"] = "key";
                    if (
                        $grpinfo->columns[${${"GLOBALS"}["fqpkcsshd"]}][
                            "name"
                        ] == ${${"GLOBALS"}["gcfojvu"]}
                    ) {
                        ${"GLOBALS"}["mkkjgcxz"] = "vv";
                        $xgcomeft = "v";
                        ${${"GLOBALS"}["mkkjgcxz"]} = ${$xgcomeft};
                        break;
                    }
                }
                ${"GLOBALS"}["zzfensxkm"] = "pd";
                $pdf->Cell(
                    $grpinfo->columns[$i]["width"],
                    ${${"GLOBALS"}["zzfensxkm"]}["grid_row_height"],
                    ${${"GLOBALS"}["cdpuirmgomj"]},
                    1,
                    0,
                    $grpinfo->columns[$i]["align"],
                    ${${"GLOBALS"}["ujaknnkqd"]},
                    "",
                    1
                );
            }
        }
    }
    public function exportToPdf(
        array $summary = null,
        array $params = null,
        array $colmodel = null,
        $filename = "exportdata.pdf"
    ) {
        $sql = null;
        global $l;
        ${${"GLOBALS"}["xqjdxyyvxk"]} =
            isset($this->gridOptions["grouping"]) &&
            $this->gridOptions["grouping"] == true;
        if ($this->dbtype == "adodb") {
            ${"GLOBALS"}["xpfprag"] = "grouping";
            if (${${"GLOBALS"}["xpfprag"]}) {
                $this->pdo->SetFetchMode(ADODB_FETCH_ASSOC);
            } else {
                $this->pdo->SetFetchMode(ADODB_FETCH_NUM);
            }
        }
        $sql = $this->_rs($params,$summary);
        if ($sql) {
            ${"GLOBALS"}["ehdyfrfnkk"] = "pd";
            ${${"GLOBALS"}["ehdyfrfnkk"]} = $this->PDF;
            try {
                ${"GLOBALS"}["ottnktfc"] = "pd";
                ${"GLOBALS"}["ctwinnn"] = "pd";
                $nqwoyxmyczvz = "pd";
                $hqvitwus = "pd";
                $ruubywvwr = "pd";
                $wcnrocdfo = "pd";
                $pdf = new TCPDF(
                    $pd["page_orientation"],
                    ${$ruubywvwr}["unit"],
                    ${$hqvitwus}["page_format"],
                    $pd["unicode"],
                    ${$nqwoyxmyczvz}["encoding"],
                    false
                );
                $ixykcp = "pd";
                ${"GLOBALS"}["snwplqgl"] = "pd";
                $cltzeuqxhh = "pd";
                $pdf->SetCreator($pd["creator"]);
                ${"GLOBALS"}["sghnmoqgymj"] = "pd";
                ${"GLOBALS"}["ppthvovose"] = "pd";
                $pdf->SetAuthor(${${"GLOBALS"}["snwplqgl"]}["author"]);
                $fesmiodsqn = "pd";
                $pdf->SetTitle($pd["title"]);
                ${"GLOBALS"}["lshhxwb"] = "pd";
                $pdf->SetSubject($pd["subject"]);
                $pflldgz = "pd";
                $pdf->SetKeywords(${${"GLOBALS"}["ctwinnn"]}["keywords"]);
                ${"GLOBALS"}["wdxvumjffv"] = "file_t";
                $zhwspntygb = "pd";
                $pdf->SetMargins(
                    ${$cltzeuqxhh}["margin_left"],
                    ${${"GLOBALS"}["lshhxwb"]}["margin_top"],
                    $pd["margin_right"]
                );
                $pdf->SetHeaderMargin(${$pflldgz}["margin_header"]);
                $jnvguh = "pd";
                $pdf->setHeaderFont([
                    ${$ixykcp}["font_name_main"],
                    "",
                    ${$fesmiodsqn}["font_size_main"],
                ]);
                if ($pd["header"] === true) {
                    ${"GLOBALS"}["mtssorwtbcgp"] = "pd";
                    $fgdhhmwcrpmu = "pd";
                    ${"GLOBALS"}["subzagpdqye"] = "pd";
                    ${"GLOBALS"}["chlexxue"] = "pd";
                    $pdf->SetHeaderData(
                        ${${"GLOBALS"}["mtssorwtbcgp"]}["header_logo"],
                        ${${"GLOBALS"}["subzagpdqye"]}[
                            "header_logo_width"
                        ],
                        ${${"GLOBALS"}["chlexxue"]}["header_title"],
                        ${$fgdhhmwcrpmu}["header_string"]
                    );
                } else {
                    $pdf->setPrintHeader(false);
                }
                $pdf->SetDefaultMonospacedFont(
                    $pd["font_monospaced"]
                );
                ${"GLOBALS"}["qcvovbk"] = "pd";
                $pdf->setFooterFont([
                    ${$zhwspntygb}["font_name_data"],
                    "",
                    ${${"GLOBALS"}["ppthvovose"]}["font_size_data"],
                ]);
                ${"GLOBALS"}["oxvsic"] = "filename";
                $pdf->SetFooterMargin(
                    ${${"GLOBALS"}["sghnmoqgymj"]}["margin_footer"]
                );
                if ($pd["footer"] !== true) {
                    $pdf->setPrintFooter(false);
                }
                $pdf->setImageScale($pd["image_scale_ratio"]);
                $pdf->SetAutoPageBreak(true, 17);
                $pdf->setLanguageArray($l);
                $pdf->AddPage();
                $pdf->SetFont($pd["font_name_data"],"",${$jnvguh}["font_size_data"]);
                if ($grouping) {
                    $groupinfo = $this->groupingSetup($sql,$colmodel);
                    $ret = $this->rs2pdf2($pdf,$groupinfo);
                } else {
					$ret = $this->rs2pdf($sql,$pdf,$colmodel,$summary);
                }
                jqGridDB::closeCursor($sql);
                if (!isset($pd["save_to_disk_only"])) {
                    ${"GLOBALS"}["cijlmnmrfahn"] = "pd";
                    ${${"GLOBALS"}["cijlmnmrfahn"]}[
                        "save_to_disk_only"
                    ] = false;
                }
                ${${"GLOBALS"}["pqrcnmpmg"]} = $this->tmp_file_name(
                    ${${"GLOBALS"}["ottnktfc"]}["disk_file"]
                );
                ${${"GLOBALS"}["wdxvumjffv"]} .= ".pdf";
                if (
                    $pd["save_to_disk_only"] ===
                    true
                ) {
                    $jkdwbapdu = "file_t";
                    $pdf->Output(${$jkdwbapdu}, "F");
                    return;
                }
                if (${${"GLOBALS"}["qcvovbk"]}["save_to_disk"] == true) {
                    $pdf->Output(${${"GLOBALS"}["pqrcnmpmg"]}, "F");
                }
                $pdf->Output(
                    ${${"GLOBALS"}["oxvsic"]},
                    ${$wcnrocdfo}["destination"]
                );
                exit();
            } catch (Exception $e) {
                return false;
            }
        } else {
            return "Error:Could not execute\x20the\x20query";
        }
    }
    protected function rs2excel(
        $rs,
        $colmodel = false,
        $echo = true,
        $filename = "exportdata.xls",
        $summary = false
    ) {
        ${"GLOBALS"}["pdxmlmnwb"] = "ahidden";
        ${"GLOBALS"}["ccxlntbjkezb"] = "nmodel";
        $ttqoykeb = "echo";
        ${${"GLOBALS"}["gckdpyw"]} = "";
        $xnpkekbqpj = "ncols";
        ${"GLOBALS"}["fjhpfdgbytko"] = "hdr";
        $hegwwwx = "gS\x51LMaxRows";
        $ngtpetepg = "hdr";
        $jmmyidynyu = "ncols";
        $vbbdsiygkj = "nmodel";
        $mmnesot = "es";
        $wynkldhtcrc = "rs";
        ${"GLOBALS"}["wprtajvuc"] = "a\x46ormula";
        ${"GLOBALS"}["hajrejt"] = "hdr";
        ${"GLOBALS"}["rhpnpygfeok"] = "nmodel";
        ${"GLOBALS"}["htcofoil"] = "rows";
        ${${"GLOBALS"}["htcofoil"]} = 0;
        $tmbblcdsjl = "colmodel";
        ${$hegwwwx} = $this->gSQLMaxRows;
        $ftfplhjfwg = "hdr";
        $sfdbxybrk = "hdr";
        if (!$rs) {
            printf("Bad Record\x20set\x20rs\x32excel");
            return false;
        }
        ${${"GLOBALS"}["xlmyieky"]} = [];
        ${$xnpkekbqpj} = jqGridDB::columnCount($rs);
        ${"GLOBALS"}["ikfckvtpp"] = "s";
        $solplwqs = "aSum";
        ${${"GLOBALS"}["hajrejt"]} =
            "<?xml\x20version=\"1.\x30\"\x20encoding\x3d\x22" .
            $this->encoding .
            "\"?>";
        ${$sfdbxybrk} .=
            "<?mso-application\x20progid\x3d\"Excel.Sheet\"?\x3e";
        ${$ngtpetepg} .=
            "\x3css:Workbook xmlns=\x22urn:schemas-microsoft-com:office:spreadsheet\" xmlns:o\x3d\"urn:schemas-microsoft-com:office:office\x22\x20xmlns:x\x3d\"urn:schemas-microsoft-com:office:excel\x22 xmlns:ss=\x22urn:schemas-microsoft-com:office:spreadsheet\" xmlns:html=\"http://www\x2ew\x33\x2eorg/TR/REC-html40\">";
        ${${"GLOBALS"}["fjhpfdgbytko"]} .=
            "<ss:Styles>" .
            "<ss:Style\x20ss:ID=\"1\"\x3e<ss:Font ss:Bold=\x221\x22/>\x3c/ss:Style>" .
            "<ss:Style\x20ss:ID\x3d\"sd\">\x3cNumberFormat\x20ss:Format\x3d\x22Short Date\"/></ss:Style\x3e" .
            "\x3css:Style\x20ss:ID\x3d\"ld\"\x3e<Number\x46ormat\x20ss:\x46ormat\x3d\"General\x20Date\"/\x3e</ss:Style\x3e" .
            "<ss:Style\x20ss:ID\x3d\x22nmb\">\x3cNumberFormat ss:Format\x3d\x22Standard\"/\x3e\x3c/ss:Style\x3e" .
            "\x3css:Style\x20ss:ID=\x22intnm\x22\x3e\x3cNumberFormat\x20ss:Format\x3d\"General\x20Number\"/></ss:Style>" .
            "\x3c/ss:Styles\x3e";
        ${$ftfplhjfwg} .= "\x3css:Worksheet ss:Name=\"Sheet1\x22\x3e";
        ${${"GLOBALS"}["qtfnftgyjqe"]} .= "<ss:Table\x3e";
        ${${"GLOBALS"}["rhpnpygfeok"]} = is_array(${$tmbblcdsjl})
            ? count($colmodel)
            : -1;
        if (${$vbbdsiygkj} > 0) {
            $awuhhjymq = "nmodel";
            $tjmwxweid = "i";
            $sduiypjvdtxl = "i";
            for (
                ${$tjmwxweid} = 0;
                ${$sduiypjvdtxl} < ${$awuhhjymq};
                $i++
            ) {
                $wgbbkgbx = "i";
                if (
                    $colmodel[${$wgbbkgbx}]["name"] ==
                    "actions"
                ) {
                    $ziagsebhum = "i";
                    $dnrfjctwtjwl = "colmodel";
                    ${"GLOBALS"}["bldskry"] = "nmodel";
                    array_splice(${$dnrfjctwtjwl}, ${$ziagsebhum}, 1);
                    ${${"GLOBALS"}["bldskry"]}--;
                    break;
                }
            }
        }
        $evpewwlh = "model";
        switch ($this->dbtype) {
            case "oci8":
            case "db2":
            case "sqlsrv":
            case "odbcsqlsrv":
                ${${"GLOBALS"}["ccxlntbjkezb"]}++;
                break;
        }
        $uceppbtxi = "colmodel";
        ${"GLOBALS"}["rnhyzku"] = "aSum";
        ${$evpewwlh} = false;
        if (${$uceppbtxi} && $nmodel == ${$jmmyidynyu}) {
            $model = true;
        }
        ${${"GLOBALS"}["xejqpx"]} = "<ss:Row\x20ss:StyleID=\x221\">";
        ${${"GLOBALS"}["rnhyzku"]} = [];
        ${${"GLOBALS"}["wprtajvuc"]} = [];
        ${"GLOBALS"}["cyvmtpnw"] = "hdr";
        ${${"GLOBALS"}["pdxmlmnwb"]} = [];
        $aselect = [];
        $honaqmvl = "hiddencount";
        ${$honaqmvl} = 0;
        for ($i = 0; $i < $ncols; $i++) {
            $fdzndnmqw = "model";
            ${"GLOBALS"}["ufhmbwt"] = "summary";
            ${"GLOBALS"}["nuutvmspegcy"] = "fname";
            ${"GLOBALS"}["bodcegqlb"] = "i";
            $ctrwjsv = "aselect";
            $bjyjlbx = "fname";
            ${"GLOBALS"}["zxbrytrov"] = "i";
            $ffcvubcxv = "colmodel";
            $newinicto = "column";
            ${"GLOBALS"}["xtkxloocf"] = "model";
            ${"GLOBALS"}["rbdqwhg"] = "field";
            ${"GLOBALS"}["ahljyef"] = "model";
            ${"GLOBALS"}["pqiynvsqkc"] = "colmodel";
            ${"GLOBALS"}["vibgjfc"] = "summary";
            $tirfjlfqm = "colmodel";
            $rrmnxxt = "hdr";
            $tdclqnjx = "i";
            $ahidden[$i] = $model && isset($colmodel[$i]["hidden"]) ? $colmodel[$i]["hidden"] : false;
            ${$ctrwjsv}[$i] = false;
            ${"GLOBALS"}["rnswwdfb"] = "i";
            if (
                ${${"GLOBALS"}["xtkxloocf"]} &&
                isset(
                    ${$tirfjlfqm}[${${"GLOBALS"}["rnswwdfb"]}]["formatter"]
                )
            ) {
                if ($colmodel[$i]["formatter"] == "select") {
                    ${"GLOBALS"}["xozqwtdevkw"] = "colmodel";
                    $tnjsxe = "asl";
                    ${"GLOBALS"}["yycsjupswv"] = "asl";
                    ${"GLOBALS"}["nbkpaenotyo"] = "i";
                    ${"GLOBALS"}["rfepzhaifmgp"] = "colmodel";
                    ${$tnjsxe} = isset(
                        ${${"GLOBALS"}["xozqwtdevkw"]}[
                            $i
                        ]["formatoptions"]
                    )
                        ? $colmodel[
                            $i
                        ]["formatoptions"]
                        : (isset(
                            ${${"GLOBALS"}["rfepzhaifmgp"]}[
                                ${${"GLOBALS"}["nbkpaenotyo"]}
                            ]["editoptions"]
                        )
                            ? $colmodel[
                                $i
                            ]["editoptions"]
                            : []);
                    if (isset(${${"GLOBALS"}["yycsjupswv"]}["value"])) {
                        $vchkhds = "asl";
                        ${"GLOBALS"}["qpudbx"] = "delim";
                        ${"GLOBALS"}["tlkfkfom"] = "delim";
                        $cualsb = "asl";
                        ${${"GLOBALS"}["zbaphywqpxk"]} = isset(
                            ${$cualsb}["separator"]
                        )
                            ? ${$vchkhds}["separator"]
                            : ":";
                        ${"GLOBALS"}["pphownnwicl"] = "asl";
                        $yhnxkxryosr = "asl";
                        ${"GLOBALS"}["nqblovsydm"] = "list";
                        ${${"GLOBALS"}["tlkfkfom"]} = isset(
                            ${$yhnxkxryosr}["delimiter"]
                        )
                            ? ${${"GLOBALS"}["pphownnwicl"]}["delimiter"]
                            : ";";
                        ${${"GLOBALS"}["nqblovsydm"]} = explode(
                            ${${"GLOBALS"}["qpudbx"]},
                            ${${"GLOBALS"}["wyqwkwhq"]}["value"]
                        );
                        foreach (
                            ${${"GLOBALS"}["coxxnkmlsht"]}
                            as ${${"GLOBALS"}["dglvfwquwyy"]} =>
                                ${${"GLOBALS"}["qwgqpbnkmug"]}
                        ) {
                            $svlxezrb = "i";
                            ${${"GLOBALS"}["hlimukpf"]} = explode(
                                ${${"GLOBALS"}["zbaphywqpxk"]},
                                ${${"GLOBALS"}["qwgqpbnkmug"]}
                            );
                            $uxaimcslbxc = "aselect";
                            ${"GLOBALS"}["hsjkmyam"] = "items";
                            ${$uxaimcslbxc}[${$svlxezrb}][
                                ${${"GLOBALS"}["hsjkmyam"]}[0]
                            ] = ${${"GLOBALS"}["hlimukpf"]}[1];
                        }
                    }
                }
            }
            ${${"GLOBALS"}["ckuocwht"]} =
                ${$fdzndnmqw} && isset(${$ffcvubcxv}[${$tdclqnjx}]["width"])
                    ? (int) $colmodel[
                        $i
                    ]["width"]
                    : 0;
            if (${$newinicto} > 0) {
                ${"GLOBALS"}["ggutvvrb"] = "hdr";
                ${"GLOBALS"}["awvvkhdor"] = "column";
                ${${"GLOBALS"}["ckuocwht"]} =
                    (${${"GLOBALS"}["awvvkhdor"]} * 72) / 96;
                ${${"GLOBALS"}["ggutvvrb"]} .=
                    "<ss:Column ss:Width=\x22" .
                    ${${"GLOBALS"}["ckuocwht"]} .
                    "\x22/\x3e";
            } else {
                ${$rrmnxxt} .=
                    "\x3css:Column\x20ss:AutoFitWidth\x3d\"1\x22/\x3e";
            }
            ${${"GLOBALS"}["rbdqwhg"]} = [];
            ${"GLOBALS"}["epcekcprk"] = "fname";
            if (
                ${${"GLOBALS"}["ahljyef"]} &&
                isset(
                    ${${"GLOBALS"}["pqiynvsqkc"]}[${${"GLOBALS"}["bodcegqlb"]}]
                )
            ) {
                $hexppqk = "colmodel";
                $lxmdylwvlxzp = "i";
                $amgrxxcglqb = "colmodel";
                $hylnnuo = "colmodel";
                $gelfgsehpyce = "colmodel";
                $odltxdp = "i";
                ${"GLOBALS"}["uiuokpc"] = "i";
                $xeffalqzmti = "colmodel";
                $lwmqhjm = "field";
                ${${"GLOBALS"}["incdddnykwc"]} = isset(
                    ${$hylnnuo}[${$lxmdylwvlxzp}]["label"]
                )
                    ? ${$hexppqk}[${${"GLOBALS"}["uiuokpc"]}]["label"]
                    : ${$gelfgsehpyce}[$i]["name"];
                ${$lwmqhjm}["name"] =
                    ${$amgrxxcglqb}[$i]["name"];
                ${${"GLOBALS"}["xlmyieky"]}[${$odltxdp}] = isset(
                    ${$xeffalqzmti}[$i]["sorttype"]
                )
                    ? $colmodel[
                        $i
                    ]["sorttype"]
                    : "";
            } else {
                $lqvtiz = "i";
                $skfwcrarp = "rs";
                $field = jqGridDB::getColumnMeta(
                    ${$lqvtiz},
                    ${$skfwcrarp}
                );
                ${"GLOBALS"}["ucijxofj"] = "typearr";
                $fvyhyvnpmnd = "i";
                ${"GLOBALS"}["dxqkbyork"] = "field";
                ${${"GLOBALS"}["incdddnykwc"]} =
                    ${${"GLOBALS"}["dxqkbyork"]}["name"];
                ${${"GLOBALS"}["ucijxofj"]}[
                    ${$fvyhyvnpmnd}
                ] = jqGridDB::MetaType(
                    $field,
                    $this->dbtype
                );
            }
            if (strtolower($field["name"])== "jqgrid_row") {
                $ahidden[$i] = true;
            }
            if ($ahidden[${${"GLOBALS"}["zxbrytrov"]}]) {
                $qztnkvjduwsi = "hiddencount";
                ${$qztnkvjduwsi}++;
                continue;
            }
            if (
                ${${"GLOBALS"}["vibgjfc"]} &&
                is_array(${${"GLOBALS"}["ufhmbwt"]})
            ) {
                ${"GLOBALS"}["ridxqgshtxvq"] = "key";
                foreach (
                    ${${"GLOBALS"}["lfeuzytzatj"]}
                    as ${${"GLOBALS"}["ridxqgshtxvq"]} =>
                        ${${"GLOBALS"}["qwgqpbnkmug"]}
                ) {
                    ${"GLOBALS"}["xulrfkstep"] = "val";
                    if (is_array(${${"GLOBALS"}["xulrfkstep"]})) {
                        ${"GLOBALS"}["dvszudrsf"] = "formula";
                        $qioyollb = "fld";
                        foreach (
                            ${${"GLOBALS"}["qwgqpbnkmug"]}
                            as ${$qioyollb} => ${${"GLOBALS"}["dvszudrsf"]}
                        ) {
                            if (
                                $field["name"] ==
                                ${${"GLOBALS"}["dglvfwquwyy"]}
                            ) {
                                $pttsrkhnhrvh = "hiddencount";
                                $jiivkygri = "formula";
                                $oevjshpmovni = "a\x46ormula";
                                ${${"GLOBALS"}["nfohkbk"]}[] =
                                    $i -
                                    ${$pttsrkhnhrvh};
                                ${$oevjshpmovni}[] = ${$jiivkygri};
                            }
                        }
                    } else {
                        ${"GLOBALS"}["bhroouhxky"] = "key";
                        ${"GLOBALS"}["lvljsunral"] = "field";
                        if (
                            ${${"GLOBALS"}["lvljsunral"]}["name"] ==
                            ${${"GLOBALS"}["bhroouhxky"]}
                        ) {
                            $swhuhpcwh = "i";
                            $udfcejqh = "aSum";
                            ${$udfcejqh}[] =
                                ${$swhuhpcwh} - ${${"GLOBALS"}["eeqklwqpljg"]};
                            ${${"GLOBALS"}["easywfhkxgs"]}[] = "SUM";
                        }
                    }
                }
            }
            ${$bjyjlbx} = htmlspecialchars(${${"GLOBALS"}["incdddnykwc"]});
            if (strlen(${${"GLOBALS"}["nuutvmspegcy"]}) == 0) {
                ${${"GLOBALS"}["incdddnykwc"]} = "";
            }
            ${${"GLOBALS"}["xejqpx"]} .=
                "<ss:Cell\x3e<ss:Data\x20ss:Type=\x22String\x22\x3e" .
                ${${"GLOBALS"}["epcekcprk"]} .
                "</ss:Data\x3e\x3c/ss:Cell\x3e";
        }
        ${${"GLOBALS"}["xejqpx"]} .= "\x3c/ss:Row>";
        ${"GLOBALS"}["qbcxhtsef"] = "es";
        if (!${$ttqoykeb}) {
            ${${"GLOBALS"}["zgjofh"]} =
                ${${"GLOBALS"}["cyvmtpnw"]} . ${${"GLOBALS"}["xejqpx"]};
        }
        if ($this->dbtype == "mysqli") {
            $yvccbtpxjb = "fld";
            ${"GLOBALS"}["jcjndrsr"] = "rs";
            $ibuquobupzbk = "i";
            ${"GLOBALS"}["apqnmmwrk"] = "count";
            ${"GLOBALS"}["bpyobmxrssu"] = "fieldnames";
            ${$yvccbtpxjb} = $rs->field_count;
            $jzqnctxpgi = "fieldnames";
            ${${"GLOBALS"}["apqnmmwrk"]} = 1;
            ${${"GLOBALS"}["bpyobmxrssu"]}[0] = &${${"GLOBALS"}["jcjndrsr"]};
            $watnntf = "fld";
            ${"GLOBALS"}["eccbbwbhnnv"] = "i";
            for (
                ${$ibuquobupzbk} = 0;
                $i < ${$watnntf};
                ${${"GLOBALS"}["eccbbwbhnnv"]}++
            ) {
                ${"GLOBALS"}["cvsygwiikhbz"] = "res_arr";
                $wpkcjes = "i";
                ${${"GLOBALS"}["yvezufu"]}[${$wpkcjes} + 1] =
                    &${${"GLOBALS"}["cvsygwiikhbz"]}[
                        $i
                    ];
            }
            call_user_func_array("mysqli_stmt_bind_result", ${$jzqnctxpgi});
        }
        while (
            ${${"GLOBALS"}["pfsyyx"]} = jqGridDB::fetch_num(
                ${$wynkldhtcrc},
                $this->pdo
            )
        ) {
            ${"GLOBALS"}["hztcbyjuwh"] = "s";
            if ($this->dbtype == "mysqli") {
                ${"GLOBALS"}["duzyfodhm"] = "r";
                ${${"GLOBALS"}["duzyfodhm"]} = ${${"GLOBALS"}[
                    "ntkgmldy"
                ]};
            }
            $plwgfvfj = "ncols";
            ${"GLOBALS"}["jjtaiyq"] = "rows";
            ${${"GLOBALS"}["hztcbyjuwh"]} .= "\x3css:Row\x3e";
            $ekjgjyfl = "gS\x51LMaxRows";
            for (
                $i = 0;
                $i < ${$plwgfvfj};
                $i++
            ) {
                $pqulqc = "i";
                ${"GLOBALS"}["ibgixeprol"] = "v";
                ${"GLOBALS"}["yikbkleb"] = "v";
                ${"GLOBALS"}["ccefbnws"] = "i";
                ${"GLOBALS"}["mmajlscmpwo"] = "ahidden";
                $potzaxdls = "i";
                if (
                    isset($ahidden[${$potzaxdls}]) &&
                    ${${"GLOBALS"}["mmajlscmpwo"]}[${$pqulqc}]
                ) {
                    continue;
                }
                $hhnevyfwjq = "aselect";
                ${${"GLOBALS"}["qbroefmekyoe"]} =
                    ${${"GLOBALS"}["pfsyyx"]}[${${"GLOBALS"}["ccefbnws"]}];
                $zotbidpni = "typearr";
                $bgzlvkmkqcfk = "v";
                if (is_array(${$hhnevyfwjq}[$i])) {
                    ${"GLOBALS"}["xjumerg"] = "aselect";
                    if (
                        isset(
                            ${${"GLOBALS"}["xjumerg"]}[
                                $i
                            ][${${"GLOBALS"}["qbroefmekyoe"]}]
                        )
                    ) {
                        $rlfscrmpf = "aselect";
                        $ctlbjxm = "v\x31";
                        ${$ctlbjxm} =
                            ${$rlfscrmpf}[$i][
                                ${${"GLOBALS"}["qbroefmekyoe"]}
                            ];
                        if (${${"GLOBALS"}["wuzexrtfjn"]}) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} = ${${"GLOBALS"}[
                                "wuzexrtfjn"
                            ]};
                        }
                    }
                    ${"GLOBALS"}["ksjewvfrxnt"] = "typearr";
                    ${${"GLOBALS"}["ksjewvfrxnt"]}[
                        $i
                    ] = "string";
                }
                ${"GLOBALS"}["grhuwvs"] = "s";
                $flmckddmkwmm = "v";
                switch (${$zotbidpni}[$i]) {
                    case "date":
                        if (
                            substr(${${"GLOBALS"}["qbroefmekyoe"]}, 0, 4) ==
                                "\x300\x300" ||
                            empty(${${"GLOBALS"}["qbroefmekyoe"]}) ||
                            ${${"GLOBALS"}["qbroefmekyoe"]} == "NULL"
                        ) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} =
                                "\x3189\x39-12-31\x5400:\x300:\x30\x30\x2e0\x300";
                            ${"GLOBALS"}["wjipfscgta"] = "s";
                            ${${"GLOBALS"}["wjipfscgta"]} .=
                                "<ss:Cell\x20ss:StyleID\x3d\x22sd\x22>\x3css:Data ss:\x54ype=\x22Date\x54ime\"\x3e" .
                                ${${"GLOBALS"}["qbroefmekyoe"]} .
                                "</ss:Data>\x3c/ss:Cell\x3e";
                        } elseif (
                            !strpos(${${"GLOBALS"}["qbroefmekyoe"]}, ":")
                        ) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} .=
                                "T00:\x30\x30:\x30\x30\x2e\x300\x30";
                            ${${"GLOBALS"}["gckdpyw"]} .=
                                "<ss:Cell ss:StyleID\x3d\"sd\x22\x3e\x3css:Data ss:\x54ype=\x22Date\x54ime\">" .
                                ${${"GLOBALS"}["qbroefmekyoe"]} .
                                "</ss:Data></ss:Cell>";
                        } else {
                            $lrjeomlocj = "thous";
                            ${"GLOBALS"}["eojtuj"] = "thous";
                            ${"GLOBALS"}["wdfautscibv"] = "s";
                            ${$lrjeomlocj} = substr(
                                ${${"GLOBALS"}["qbroefmekyoe"]},
                                -4
                            );
                            $hicofqxweo = "v";
                            if (
                                strpos(${${"GLOBALS"}["eojtuj"]}, "\x2e") ===
                                    false &&
                                strpos(
                                    ${${"GLOBALS"}["qbroefmekyoe"]},
                                    "."
                                ) === false
                            ) {
                                ${${"GLOBALS"}["qbroefmekyoe"]} .=
                                    "\x2e\x30\x30\x30";
                            }
                            ${${"GLOBALS"}["wdfautscibv"]} .=
                                "\x3css:Cell\x20ss:StyleID=\"sd\">\x3css:Data\x20ss:\x54ype=\x22Date\x54ime\"\x3e" .
                                str_replace("\x20", "T", trim(${$hicofqxweo})) .
                                "\x3c/ss:Data></ss:Cell>";
                        }
                        break;
                    case "datetime":
                        if (
                            substr(${$bgzlvkmkqcfk}, 0, 4) == "000\x30" ||
                            empty(${${"GLOBALS"}["ibgixeprol"]}) ||
                            ${${"GLOBALS"}["qbroefmekyoe"]} == "N\x55LL"
                        ) {
                            $apkefbhvb = "v";
                            ${$apkefbhvb} =
                                "18\x39\x39-12-3\x31\x5400:0\x30:00\x2e00\x30";
                            ${${"GLOBALS"}["gckdpyw"]} .=
                                "<ss:Cell\x20ss:StyleID\x3d\x22ld\x22>\x3css:Data\x20ss:Type=\"DateTime\"\x3e" .
                                ${${"GLOBALS"}["qbroefmekyoe"]} .
                                "\x3c/ss:Data\x3e\x3c/ss:Cell\x3e";
                        } else {
                            ${"GLOBALS"}["vqsltwlcxd"] = "v";
                            ${"GLOBALS"}["qypcsmemb"] = "v";
                            ${"GLOBALS"}["jxzdtvjp"] = "thous";
                            $fkkogcolwzn = "thous";
                            ${${"GLOBALS"}["jxzdtvjp"]} = substr(
                                ${${"GLOBALS"}["qbroefmekyoe"]},
                                -4
                            );
                            if (
                                strpos(${$fkkogcolwzn}, ".") === false &&
                                strpos(
                                    ${${"GLOBALS"}["qypcsmemb"]},
                                    "\x2e"
                                ) === false
                            ) {
                                $ytrepcfo = "v";
                                ${$ytrepcfo} .= "\x2e000";
                            }
                            ${${"GLOBALS"}["gckdpyw"]} .=
                                "<ss:Cell ss:StyleID=\"ld\x22\x3e<ss:Data\x20ss:\x54ype=\x22DateTime\"\x3e" .
                                str_replace(
                                    " ",
                                    "\x54",
                                    trim(${${"GLOBALS"}["vqsltwlcxd"]})
                                ) .
                                "</ss:Data\x3e\x3c/ss:Cell>";
                        }
                        break;
                    case "int":
                        ${${"GLOBALS"}["gckdpyw"]} .=
                            "<ss:Cell\x20ss:StyleID=\"intnm\"><ss:Data ss:Type=\x22Number\">" .
                            stripslashes(trim(${$flmckddmkwmm})) .
                            "</ss:Data\x3e</ss:Cell>";
                        break;
                    case "numeric":
                        ${${"GLOBALS"}["grhuwvs"]} .=
                            "<ss:Cell\x20ss:StyleID=\"nmb\">\x3css:Data ss:Type\x3d\"Number\x22>" .
                            stripslashes(
                                trim(${${"GLOBALS"}["qbroefmekyoe"]})
                            ) .
                            "\x3c/ss:Data>\x3c/ss:Cell>";
                        break;
                    default:
                        ${${"GLOBALS"}["qbroefmekyoe"]} = htmlspecialchars(
                            trim(${${"GLOBALS"}["qbroefmekyoe"]})
                        );
                        if (strlen(${${"GLOBALS"}["yikbkleb"]}) == 0) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} = "";
                        }
                        ${${"GLOBALS"}["gckdpyw"]} .=
                            "<ss:Cell\x3e<ss:Data ss:\x54ype=\x22String\"\x3e" .
                            stripslashes(${${"GLOBALS"}["qbroefmekyoe"]}) .
                            "\x3c/ss:Data></ss:Cell>";
                }
            }
            ${${"GLOBALS"}["gckdpyw"]} .= "\x3c/ss:Row\x3e";
            ${${"GLOBALS"}["curlztfmp"]} += 1;
            if (${${"GLOBALS"}["jjtaiyq"]} >= ${$ekjgjyfl}) {
                break;
            }
        }
        if (count(${$solplwqs}) > 0 && ${${"GLOBALS"}["curlztfmp"]} > 0) {
            ${"GLOBALS"}["feajbrqvs"] = "aSum";
            ${${"GLOBALS"}["gckdpyw"]} .= "<Row\x3e";
            foreach (
                ${${"GLOBALS"}["feajbrqvs"]}
                as ${${"GLOBALS"}["scllsntlhu"]} =>
                    ${${"GLOBALS"}["ulldvhznjhm"]}
            ) {
                $abjsmq = "s";
                ${"GLOBALS"}["glxoodwuq"] = "rows";
                ${$abjsmq} .=
                    "\x3cCell\x20ss:StyleID=\"\x31\x22 ss:Index=\x22" .
                    (${${"GLOBALS"}["ulldvhznjhm"]} + 1) .
                    "\x22\x20ss:\x46ormula=\x22=" .
                    ${${"GLOBALS"}["easywfhkxgs"]}[
                        ${${"GLOBALS"}["scllsntlhu"]}
                    ] .
                    "(R[-" .
                    ${${"GLOBALS"}["glxoodwuq"]} .
                    "]C:R[-1]C)\x22><Data\x20ss:Type=\x22Number\x22></Data\x3e</Cell>";
            }
            ${${"GLOBALS"}["gckdpyw"]} .= "\x3c/Row\x3e";
        }
        ${${"GLOBALS"}["gckdpyw"]} =
            ${${"GLOBALS"}["qtfnftgyjqe"]} .
            ${${"GLOBALS"}["xejqpx"]} .
            ${${"GLOBALS"}["ikfckvtpp"]} .
            "\x3c/ss:Table\x3e</ss:Worksheet></ss:Workbook>";
        ${${"GLOBALS"}["bryhzxmk"]} = $this->getExcelOptions();
        if (!isset(${$mmnesot}["save_to_disk_only"])) {
            ${"GLOBALS"}["widqjmxjf"] = "es";
            ${${"GLOBALS"}["widqjmxjf"]}["save_to_disk_only"] = false;
        }
        if (${${"GLOBALS"}["qbcxhtsef"]}["save_to_disk_only"] === true) {
            ${"GLOBALS"}["tsjdplg"] = "ret";
            $ugdkmbmvnt = "s";
            ${${"GLOBALS"}["benxbud"]} = $this->save_to_file(
                ${${"GLOBALS"}["bryhzxmk"]}["disk_file"],
                ${$ugdkmbmvnt}
            );
            if (${${"GLOBALS"}["tsjdplg"]} !== true) {
                $this->errorMessage = ${${"GLOBALS"}["benxbud"]};
                $this->sendErrorHeader();
            }
            return;
        }
        if (${${"GLOBALS"}["bryhzxmk"]}["save_to_disk"] === true) {
            ${"GLOBALS"}["vnaplkujhly"] = "es";
            $this->save_to_file(
                ${${"GLOBALS"}["vnaplkujhly"]}["disk_file"],
                ${${"GLOBALS"}["gckdpyw"]}
            );
        }
        if (${${"GLOBALS"}["jhjzifvydu"]}) {
            header("Content-Type:\x20application/ms-excel;");
            header(
                "Content-Disposition:\x20attachment;\x20filename=" .
                    ${${"GLOBALS"}["qjrhtvktebx"]}
            );
            echo ${${"GLOBALS"}["gckdpyw"]};
        } else {
            return ${${"GLOBALS"}["gckdpyw"]};
        }
    }
    protected function rs2excel2(
        $echo = true,
        $filename = "exportdata.xls",
        $grpinfo = null
    ) {
        ${"GLOBALS"}["qhxhhoffdqeg"] = "hdr";
        ${"GLOBALS"}["kpfcvrjvk"] = "grpopt";
        $dhkpevx = "len";
        $hidiwxiu = "hdr";
        ${${"GLOBALS"}["gckdpyw"]} = "";
        $oovjmqcnkrx = "hiddencount";
        ${"GLOBALS"}["pmvflbt"] = "hdr";
        $ncols = count($grpinfo->columns);
        $nnrcxmjubi = "s";
        $exjktruk = "grpopt";
        $ombcoeedix = "i";
        $dhmltnorovz = "i";
        ${$hidiwxiu} =
            "<?xml version=\x22\x31.\x30\x22 encoding=\"" .
            $this->encoding .
            "\"?>";
        $ffssjeehv = "hdr1";
        ${${"GLOBALS"}["pmvflbt"]} .=
            "\x3c?mso-application\x20progid\x3d\x22Excel.Sheet\"?\x3e";
        $yusihzvegtp = "hdr";
        ${"GLOBALS"}["ctbaifjhe"] = "ncols";
        ${${"GLOBALS"}["qtfnftgyjqe"]} .=
            "<ss:Workbook xmlns=\x22urn:schemas-microsoft-com:office:spreadsheet\" xmlns:o\x3d\"urn:schemas-microsoft-com:office:office\x22 xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns:ss\x3d\x22urn:schemas-microsoft-com:office:spreadsheet\x22 xmlns:html\x3d\"http://www\x2ew3\x2eorg/\x54R/REC-html4\x30\x22>";
        $jdgkmuiepbrw = "es";
        $yysvrycwy = "hdr";
        ${${"GLOBALS"}["qtfnftgyjqe"]} .=
            "<ss:Styles>" .
            "<ss:Style\x20ss:ID\x3d\"1\"\x3e\x3css:Font ss:Bold=\"\x31\x22/>\x3c/ss:Style>" .
            "<ss:Style\x20ss:ID=\x22sd\"\x3e<NumberFormat ss:\x46ormat\x3d\"Short Date\x22/></ss:Style\x3e" .
            "<ss:Style\x20ss:ID=\x22ld\"\x3e<Number\x46ormat\x20ss:\x46ormat=\"General Date\"/\x3e</ss:Style>" .
            "\x3css:Style ss:ID\x3d\x22nmb\"\x3e\x3cNumber\x46ormat ss:\x46ormat=\x22Standard\"/></ss:Style>" .
            "<ss:Style\x20ss:ID=\x22intnm\"><NumberFormat ss:Format=\x22General Number\x22/\x3e\x3c/ss:Style\x3e" .
            "\x3css:Style ss:ID=\x22headcol\"\x3e\x3css:\x46ont\x20ss:Bold=\x22\x31\"/>\x3c/ss:Style\x3e" .
            "\x3css:Style ss:ID\x3d\"Default\" ss:Name\x3d\"Normal\"\x3e <Alignment ss:\x56ertical\x3d\"Bottom\"/><Borders/><Interior/\x3e\x3cNumberFormat/>\x3cProtection/></ss:Style\x3e" .
            "\x3c/ss:Styles\x3e";
        ${$yysvrycwy} .=
            "\x3css:Worksheet\x20ss:Name\x3d\x22Sheet\x31\x22\x3e";
        ${${"GLOBALS"}["qhxhhoffdqeg"]} .= "\x3css:Table>";
        $fguutsdum = "i";
        $qsvfib = "hdr\x31";
        ${$qsvfib} = "<ss:Row\x20ss:StyleID=\x221\">";
        ${$oovjmqcnkrx} = 0;
        ${"GLOBALS"}["keiuyycpz"] = "es";
        for (
            ${$fguutsdum} = 0;
            ${$dhmltnorovz} < ${${"GLOBALS"}["ctbaifjhe"]};
            $i++
        ) {
            if (strtolower($grpinfo->columns[$i]["name"])=="jqgrid_row") {
                $osjxakbjls = "i";
                $grpinfo->columns[${$osjxakbjls}]["hidden"] = true;
            }
            ${"GLOBALS"}["vptjhoegs"] = "fname";
            if (
                $grpinfo->columns[$i]["hidden"] == true
            ) {
                ${"GLOBALS"}["hmyotyocyxr"] = "hiddencount";
                ${${"GLOBALS"}["hmyotyocyxr"]}++;
                continue;
            }
            if ($grpinfo->columns[$i]["width"] > 0) {
                $ftdgazmz = "i";
                ${${"GLOBALS"}["qtfnftgyjqe"]} .=
                    "\x3css:Column ss:Width\x3d\"" .
                    ((int) $grpinfo->columns[${$ftdgazmz}]["width"] * 72) / 96 .
                    "\"/\x3e";
            } else {
                ${${"GLOBALS"}["qtfnftgyjqe"]} .=
                    "\x3css:Column ss:AutoFitWidth\x3d\x22\x31\"/>";
            }
            ${${"GLOBALS"}["incdddnykwc"]} = htmlspecialchars(
                $grpinfo->columns[$i]["label"]
            );
            if (strlen(${${"GLOBALS"}["vptjhoegs"]}) == 0) {
                ${${"GLOBALS"}["incdddnykwc"]} = "";
            }
            ${${"GLOBALS"}["xejqpx"]} .=
                "\x3css:Cell>\x3css:Data ss:\x54ype=\"String\"\x3e" .
                ${${"GLOBALS"}["incdddnykwc"]} .
                "\x3c/ss:Data>\x3c/ss:Cell\x3e";
        }
        ${$ffssjeehv} .= "\x3c/ss:Row>";
        if (!${${"GLOBALS"}["jhjzifvydu"]}) {
            $gemweohhnr = "html";
            ${$gemweohhnr} =
                ${${"GLOBALS"}["qtfnftgyjqe"]} . ${${"GLOBALS"}["xejqpx"]};
        }
        ${${"GLOBALS"}["fwfzxxuwrc"]} = 0;
        ${${"GLOBALS"}["kpfcvrjvk"]} = $this->gridOptions["grouping\x56iew"];
        ${$dhkpevx} = count(${${"GLOBALS"}["nseuemktt"]}["group\x46ield"]);
        ${${"GLOBALS"}["mjypfvclsj"]} = [];
        if (isset(${$exjktruk}["groupSummary"])) {
            ${${"GLOBALS"}["mjypfvclsj"]} = array_reverse(
                ${${"GLOBALS"}["nseuemktt"]}["groupSummary"]
            );
        }
        foreach (
            $grpinfo->groups
            as ${$ombcoeedix} => ${${"GLOBALS"}["wgoaukia"]}
        ) {
            $dbpmovdgoh = "len";
            ${"GLOBALS"}["bhwlpsdtbmk"] = "gt";
            ${${"GLOBALS"}["fwfzxxuwrc"]}++;
            ${${"GLOBALS"}["qbroefmekyoe"]} =
                ${${"GLOBALS"}["wgoaukia"]}["value"];
            ${"GLOBALS"}["qlbdiuv"] = "v";
            $oyamijxgkv = "leaf";
            ${"GLOBALS"}["kympdfk"] = "hiddencount";
            $noocxait = "n";
            if (
                !isset(
                    ${${"GLOBALS"}["nseuemktt"]}["groupText"][
                        ${${"GLOBALS"}["wgoaukia"]}["idx"]
                    ]
                )
            ) {
                ${${"GLOBALS"}["dgiduf"]} = "{\x30}";
            } else {
                $gurermvjnup = "n";
                ${${"GLOBALS"}["dgiduf"]} =
                    ${${"GLOBALS"}["nseuemktt"]}["group\x54ext"][
                        ${$gurermvjnup}["idx"]
                    ];
            }
            ${${"GLOBALS"}["gckdpyw"]} .=
                "<ss:Row\x3e\x3css:Cell\x20ss:MergeAcross=\x22" .
                ($ncols -
                    ${${"GLOBALS"}["kympdfk"]} -
                    1) .
                "\"\x20ss:StyleID=\"headcol\"\x3e<ss:Data\x20ss:Type\x3d\x22String\"\x3e" .
                str_repeat(
                    "\x26nbsp;\x26nbsp\x3b",
                    ${${"GLOBALS"}["wgoaukia"]}["idx"]
                ) .
                $this->js_template(
                    ${${"GLOBALS"}["bhwlpsdtbmk"]},
                    ${${"GLOBALS"}["qlbdiuv"]},
                    ${${"GLOBALS"}["wgoaukia"]}["cnt"],
                    ${$noocxait}["summary"]
                ) .
                "</ss:Data></ss:Cell>\x3c/ss:Row>";
            ${${"GLOBALS"}["mbklqpbdps"]} =
                ${$dbpmovdgoh} - 1 === ${${"GLOBALS"}["wgoaukia"]}["idx"];
            if (${$oyamijxgkv}) {
                $vlrpwqhdb = "n";
                ${"GLOBALS"}["bkbfckbpmd"] = "jj";
                ${"GLOBALS"}["hotrphq"] = "toEnd";
                ${"GLOBALS"}["khqajcfvsm"] = "toEnd";
                if (isset($grpinfo->groups[$i + 1])) {
                    $hjnkgj = "gg";
                    $curfbme = "end";
                    $epmcbyqsuej = "gg";
                    ${$epmcbyqsuej} =
                        $grpinfo->groups[$i + 1];
                    ${$curfbme} = ${$hjnkgj}["startRow"];
                } else {
                    ${${"GLOBALS"}["bnkmlts"]} = false;
                    $rdilfxg = "end";
                    ${$rdilfxg} = $this->groupdata->count();
                }
                $ushxzjynte = "ik";
                $vwnyrzsm = "ik";
                ${"GLOBALS"}["etfzymydxmp"] = "row";
                ${"GLOBALS"}["ydheemi"] = "end";
                $ajylnufl = "ik";
                foreach (
                    new LimitIterator(
                        $this->groupdata,
                        ${${"GLOBALS"}["wgoaukia"]}["startRow"],
                        ${${"GLOBALS"}["ydheemi"]} - ${$vlrpwqhdb}["startRow"]
                    )
                    as ${${"GLOBALS"}["etfzymydxmp"]}
                ) {
                    ${"GLOBALS"}["biccobreay"] = "s";
                    ${"GLOBALS"}["iokwwvgre"] = "r";
                    $duvecfyjow = "row";
                    ${${"GLOBALS"}["biccobreay"]} .= "\x3css:Row\x3e";
                    ${${"GLOBALS"}["dlqafubuedv"]} = 0;
                    foreach (
                        ${$duvecfyjow}
                        as ${${"GLOBALS"}["dglvfwquwyy"]} =>
                            ${${"GLOBALS"}["iokwwvgre"]}
                    ) {
                        ${"GLOBALS"}["rfanxrcayd"] = "v";
                        $kikntxldpdi = "v";
                        ${"GLOBALS"}["oyisfob"] = "v";
                        ${"GLOBALS"}["pbpbdj"] = "j";
                        if (
                            $grpinfo->columns[${${"GLOBALS"}["dlqafubuedv"]}][
                                "hidden"
                            ] == true
                        ) {
                            $btutvswoclo = "j";
                            ${$btutvswoclo}++;
                            continue;
                        }
                        $hujurbpisq = "v";
                        ${"GLOBALS"}["jnmnpxq"] = "j";
                        ${${"GLOBALS"}["rfanxrcayd"]} = ${${"GLOBALS"}[
                            "pfsyyx"
                        ]};
                        $jwnzrbb = "v";
                        ${"GLOBALS"}["omuqaqtbvny"] = "v";
                        if (
                            is_array(
                                $grpinfo->columns[
                                    ${${"GLOBALS"}["dlqafubuedv"]}
                                ]["select"]
                            )
                        ) {
                            if (
                                isset(
                                    $grpinfo->columns[
                                        ${${"GLOBALS"}["dlqafubuedv"]}
                                    ]["select"][${${"GLOBALS"}["qbroefmekyoe"]}]
                                )
                            ) {
                                ${"GLOBALS"}["ncewbwgvd"] = "v\x31";
                                ${"GLOBALS"}["zqupmru"] = "v";
                                $euepkzaexpk = "j";
                                $ngwkvfi = "v1";
                                ${${"GLOBALS"}["ncewbwgvd"]} =
                                    $grpinfo->columns[${$euepkzaexpk}][
                                        "select"
                                    ][${${"GLOBALS"}["zqupmru"]}];
                                if (${$ngwkvfi}) {
                                    ${"GLOBALS"}["fktwcsmgjmi"] = "v\x31";
                                    ${${"GLOBALS"}[
                                        "qbroefmekyoe"
                                    ]} = ${${"GLOBALS"}["fktwcsmgjmi"]};
                                }
                            }
                            $grpinfo->columns[${${"GLOBALS"}["dlqafubuedv"]}][
                                "type"
                            ] = "string";
                        }
                        $kprnohbicbg = "s";
                        $fxecvxk = "v";
                        switch (
                            $grpinfo->columns[${${"GLOBALS"}["jnmnpxq"]}][
                                "type"
                            ]
                        ) {
                            case "date":
                                if (
                                    substr(
                                        ${${"GLOBALS"}["qbroefmekyoe"]},
                                        0,
                                        4
                                    ) == "\x300\x300" ||
                                    empty(${${"GLOBALS"}["qbroefmekyoe"]}) ||
                                    ${$jwnzrbb} == "NULL"
                                ) {
                                    ${${"GLOBALS"}["qbroefmekyoe"]} =
                                        "189\x39-12-\x33\x31\x54\x300:\x300:0\x30.\x30\x30\x30";
                                    ${${"GLOBALS"}["gckdpyw"]} .=
                                        "<ss:Cell\x20ss:StyleID\x3d\"sd\"><ss:Data\x20ss:\x54ype\x3d\"DateTime\x22>" .
                                        ${${"GLOBALS"}["qbroefmekyoe"]} .
                                        "</ss:Data\x3e\x3c/ss:Cell>";
                                } elseif (
                                    !strpos(
                                        ${${"GLOBALS"}["qbroefmekyoe"]},
                                        ":"
                                    )
                                ) {
                                    ${"GLOBALS"}["gcniduxxivjf"] = "s";
                                    ${"GLOBALS"}["gbjtrsu"] = "v";
                                    ${${"GLOBALS"}["gbjtrsu"]} .=
                                        "T\x30\x30:\x30\x30:0\x30\x2e000";
                                    $thhusjjle = "v";
                                    ${${"GLOBALS"}["gcniduxxivjf"]} .=
                                        "\x3css:Cell\x20ss:StyleID\x3d\x22sd\x22\x3e<ss:Data ss:Type=\"DateTime\"\x3e" .
                                        ${$thhusjjle} .
                                        "\x3c/ss:Data\x3e\x3c/ss:Cell>";
                                } else {
                                    ${"GLOBALS"}["cgsidfhvrg"] = "thous";
                                    ${"GLOBALS"}["vwnxoxk"] = "v";
                                    ${${"GLOBALS"}["iomhvribwef"]} = substr(
                                        ${${"GLOBALS"}["vwnxoxk"]},
                                        -4
                                    );
                                    ${"GLOBALS"}["derjstiecd"] = "v";
                                    if (
                                        strpos(
                                            ${${"GLOBALS"}["cgsidfhvrg"]},
                                            "."
                                        ) === false &&
                                        strpos(
                                            ${${"GLOBALS"}["qbroefmekyoe"]},
                                            "."
                                        ) === false
                                    ) {
                                        ${${"GLOBALS"}["qbroefmekyoe"]} .=
                                            "\x2e00\x30";
                                    }
                                    ${${"GLOBALS"}["gckdpyw"]} .=
                                        "<ss:Cell ss:StyleID=\"sd\x22\x3e\x3css:Data ss:Type=\"Date\x54ime\"\x3e" .
                                        str_replace(
                                            "\x20",
                                            "T",
                                            trim(${${"GLOBALS"}["derjstiecd"]})
                                        ) .
                                        "</ss:Data>\x3c/ss:Cell\x3e";
                                }
                                break;
                            case "datetime":
                                if (
                                    substr(${$fxecvxk}, 0, 4) == "\x300\x300" ||
                                    empty(${${"GLOBALS"}["qbroefmekyoe"]}) ||
                                    ${${"GLOBALS"}["qbroefmekyoe"]} == "NULL"
                                ) {
                                    $mobcuqkomw = "s";
                                    ${${"GLOBALS"}["qbroefmekyoe"]} =
                                        "\x3189\x39-12-\x331T\x300:\x300:00\x2e\x30\x300";
                                    ${$mobcuqkomw} .=
                                        "<ss:Cell ss:StyleID=\x22ld\x22>\x3css:Data ss:Type\x3d\"DateTime\x22\x3e" .
                                        ${${"GLOBALS"}["qbroefmekyoe"]} .
                                        "</ss:Data>\x3c/ss:Cell>";
                                } else {
                                    $ukxatfcgnwt = "v";
                                    ${"GLOBALS"}["lnzsmrjoeyvp"] = "v";
                                    ${${"GLOBALS"}["iomhvribwef"]} = substr(
                                        ${${"GLOBALS"}["qbroefmekyoe"]},
                                        -4
                                    );
                                    if (
                                        strpos(
                                            ${${"GLOBALS"}["iomhvribwef"]},
                                            "."
                                        ) === false &&
                                        strpos(
                                            ${${"GLOBALS"}["qbroefmekyoe"]},
                                            "\x2e"
                                        ) === false
                                    ) {
                                        ${$ukxatfcgnwt} .= "\x2e0\x30\x30";
                                    }
                                    ${${"GLOBALS"}["gckdpyw"]} .=
                                        "<ss:Cell\x20ss:StyleID=\x22ld\x22\x3e<ss:Data ss:Type\x3d\"Date\x54ime\x22>" .
                                        str_replace(
                                            " ",
                                            "T",
                                            trim(
                                                ${${"GLOBALS"}[
                                                    "lnzsmrjoeyvp"
                                                ]}
                                            )
                                        ) .
                                        "\x3c/ss:Data></ss:Cell\x3e";
                                }
                                break;
                            case "int":
                                ${${"GLOBALS"}["gckdpyw"]} .=
                                    "\x3css:Cell\x20ss:StyleID=\x22intnm\"><ss:Data\x20ss:\x54ype=\"Number\">" .
                                    stripslashes(${$kikntxldpdi}) .
                                    "</ss:Data></ss:Cell>";
                                break;
                            case "numeric":
                                ${$kprnohbicbg} .=
                                    "\x3css:Cell\x20ss:StyleID=\"nmb\">\x3css:Data ss:Type=\"Number\x22\x3e" .
                                    stripslashes(
                                        ${${"GLOBALS"}["qbroefmekyoe"]}
                                    ) .
                                    "</ss:Data\x3e\x3c/ss:Cell>";
                                break;
                            default:
                                ${${"GLOBALS"}[
                                    "qbroefmekyoe"
                                ]} = htmlspecialchars(
                                    trim(${${"GLOBALS"}["oyisfob"]})
                                );
                                if (strlen(${$hujurbpisq}) == 0) {
                                    $mphcmmjnls = "v";
                                    ${$mphcmmjnls} = "";
                                }
                                ${${"GLOBALS"}["gckdpyw"]} .=
                                    "\x3css:Cell\x3e<ss:Data\x20ss:Type=\x22String\"\x3e" .
                                    stripslashes(
                                        ${${"GLOBALS"}["omuqaqtbvny"]}
                                    ) .
                                    "</ss:Data\x3e</ss:Cell>";
                        }
                        ${${"GLOBALS"}["pbpbdj"]}++;
                    }
                    ${${"GLOBALS"}["gckdpyw"]} .= "\x3c/ss:Row\x3e";
                }
                ${${"GLOBALS"}["bkbfckbpmd"]} = 0;
                ${"GLOBALS"}["wscmnpx"] = "jj";
                if (${${"GLOBALS"}["bnkmlts"]}) {
                    ${"GLOBALS"}["mcmblfwhyd"] = "toEnd";
                    ${"GLOBALS"}["rcyicrmhisr"] = "jj";
                    ${"GLOBALS"}["ehhoncut"] = "len";
                    ${"GLOBALS"}["supdldubev"] = "len";
                    ${"GLOBALS"}["uixlkvxnnt"] = "jj";
                    for (
                        ${${"GLOBALS"}["rcyicrmhisr"]} = 0;
                        ${${"GLOBALS"}["ollhwol"]} <
                        ${${"GLOBALS"}["ehhoncut"]};
                        ${${"GLOBALS"}["uixlkvxnnt"]}++
                    ) {
                        $exjhskrj = "gg";
                        if (
                            ${$exjhskrj}["dataIndex"] ===
                            $this->gridOptions["grouping\x56iew"]["groupField"][
                                ${${"GLOBALS"}["ollhwol"]}
                            ]
                        ) {
                            break;
                        }
                    }
                    ${${"GLOBALS"}["mcmblfwhyd"]} =
                        ${${"GLOBALS"}["supdldubev"]} -
                        ${${"GLOBALS"}["ollhwol"]};
                }
                for (
                    ${$ushxzjynte} = 0;
                    ${$ajylnufl} < ${${"GLOBALS"}["hotrphq"]};
                    ${$vwnyrzsm}++
                ) {
                    ${"GLOBALS"}["lemeicdis"] = "ik";
                    ${"GLOBALS"}["luudeojskbl"] = "fdata";
                    $rhddemmh = "sumreverse";
                    ${"GLOBALS"}["sscwxvszh"] = "sumreverse";
                    ${"GLOBALS"}["bvopornxxxym"] = "ij";
                    ${"GLOBALS"}["tcxjwnzijak"] = "i";
                    ${"GLOBALS"}["xgeksfrtr"] = "s";
                    $ocqrfrs = "grlen";
                    if (
                        isset(
                            ${${"GLOBALS"}["sscwxvszh"]}[
                                ${${"GLOBALS"}["dtasvs"]}
                            ]
                        ) &&
                        !${$rhddemmh}[${${"GLOBALS"}["lemeicdis"]}]
                    ) {
                        continue;
                    }
                    ${"GLOBALS"}["pwbreepbjg"] = "ik";
                    ${${"GLOBALS"}["xgeksfrtr"]} .= "<ss:Row\x3e";
                    ${${"GLOBALS"}["luudeojskbl"]} = $this->findGroupIdx(
                        ${${"GLOBALS"}["tcxjwnzijak"]},
                        ${${"GLOBALS"}["pwbreepbjg"]},
                        $grpinfo->groups
                    );
                    ${$ocqrfrs} = ${${"GLOBALS"}["vatwvdyuus"]}["cnt"];
                    for (
                        ${${"GLOBALS"}["ygtpwesvvpd"]} = 0;
                        ${${"GLOBALS"}["ygtpwesvvpd"]} <
                        $ncols;
                        ${${"GLOBALS"}["bvopornxxxym"]}++
                    ) {
                        ${"GLOBALS"}["sfpsygo"] = "fdata";
                        ${"GLOBALS"}["gkfndjwhfpg"] = "s";
                        $ybbluma = "ij";
                        if ($grpinfo->columns[${$ybbluma}]["hidden"] == true) {
                            continue;
                        }
                        ${"GLOBALS"}["ouilvqnpfbov"] = "tplfld";
                        ${${"GLOBALS"}["cudsptyopd"]} =
                            "<ss:Cell\x3e\x3css:Data\x20ss:\x54ype=\x22String\"\x3e\x3c/ss:Data\x3e\x3c/ss:Cell\x3e";
                        ${${"GLOBALS"}["ouilvqnpfbov"]} = "{0}";
                        foreach (
                            ${${"GLOBALS"}["sfpsygo"]}["summary"]
                            as ${${"GLOBALS"}["qggzkhswbi"]} =>
                                ${${"GLOBALS"}["nsuqwew"]}
                        ) {
                            ${"GLOBALS"}["atythfxbx"] = "sv";
                            ${"GLOBALS"}["unxmohlj"] = "ij";
                            if (
                                ${${"GLOBALS"}["atythfxbx"]}["nm"] ==
                                $this->colModel[${${"GLOBALS"}["unxmohlj"]}][
                                    "name"
                                ]
                            ) {
                                ${"GLOBALS"}["vymsghrck"] = "ij";
                                $tnuxpfff = "sv";
                                ${"GLOBALS"}["yhvbsel"] = "sv";
                                if (
                                    isset(
                                        $this->colModel[
                                            ${${"GLOBALS"}["vymsghrck"]}
                                        ]["summary\x54pl"]
                                    )
                                ) {
                                    ${"GLOBALS"}["yrozkllc"] = "ij";
                                    ${${"GLOBALS"}["xymebptnm"]} =
                                        $this->colModel[
                                            ${${"GLOBALS"}["yrozkllc"]}
                                        ]["summaryTpl"];
                                }
                                if (
                                    is_string(${$tnuxpfff}["st"]) &&
                                    strtolower(
                                        ${${"GLOBALS"}["yhvbsel"]}["st"]
                                    ) == "avg"
                                ) {
                                    ${"GLOBALS"}["yijedfhe"] = "sv";
                                    ${"GLOBALS"}["vgmaebi"] = "grlen";
                                    if (
                                        isset(
                                            ${${"GLOBALS"}["yijedfhe"]}["sd"]
                                        ) &&
                                        (float) ${${"GLOBALS"}["nsuqwew"]}[
                                            "vd"
                                        ] != 0
                                    ) {
                                        $pcvjqvxu = "sv";
                                        $sauuxxvpszlc = "sv";
                                        ${${"GLOBALS"}["nsuqwew"]}["v"] =
                                            ${$sauuxxvpszlc}["v"] /
                                            ${$pcvjqvxu}["vd"];
                                    } elseif (
                                        ${${"GLOBALS"}["nsuqwew"]}["v"] &&
                                        ${${"GLOBALS"}["vgmaebi"]} > 0
                                    ) {
                                        ${"GLOBALS"}["dvhdye"] = "sv";
                                        ${"GLOBALS"}["xulbnadvp"] = "grlen";
                                        $inrzmtvbhh = "sv";
                                        ${${"GLOBALS"}["dvhdye"]}["v"] =
                                            ${$inrzmtvbhh}["v"] /
                                            ${${"GLOBALS"}["xulbnadvp"]};
                                    }
                                }
                                $dansnvliwdss = "tmpdata";
                                $vjfeckfocba = "sv";
                                $cknscjpsi = "tv";
                                ${"GLOBALS"}["tmmifbt"] = "styleid";
                                if (
                                    isset(
                                        $this->colModel[
                                            ${${"GLOBALS"}["ygtpwesvvpd"]}
                                        ]["summaryRound"]
                                    )
                                ) {
                                    $vxsylw = "sv";
                                    $bgtgrp = "ij";
                                    ${${"GLOBALS"}["nsuqwew"]}["v"] = round(
                                        ${$vxsylw}["v"],
                                        $this->colModel[${$bgtgrp}][
                                            "summaryRound"
                                        ]
                                    );
                                }
                                ${${"GLOBALS"}["tmmifbt"]} = "Default";
                                ${"GLOBALS"}["suibqedf"] = "sv";
                                if (
                                    is_integer(${${"GLOBALS"}["nsuqwew"]}["v"])
                                ) {
                                    $ekwigblefk = "styleid";
                                    ${$ekwigblefk} = "intnum";
                                } elseif (is_float(${$vjfeckfocba}["v"])) {
                                    $nctxkfnsnnp = "styleid";
                                    ${$nctxkfnsnnp} = "nmb";
                                }
                                ${$cknscjpsi} = $this->js_template(
                                    ${${"GLOBALS"}["xymebptnm"]},
                                    ${${"GLOBALS"}["suibqedf"]}["v"]
                                );
                                ${${"GLOBALS"}["mzlghvtycb"]} = is_numeric(
                                    ${${"GLOBALS"}["hmwqscpc"]}
                                )
                                    ? "Number"
                                    : "String";
                                ${$dansnvliwdss} =
                                    "\x3css:Cell\x20ss:StyleID=\"" .
                                    ${${"GLOBALS"}["tmmlybo"]} .
                                    "\x22><ss:Data ss:Type\x3d\x22" .
                                    ${${"GLOBALS"}["mzlghvtycb"]} .
                                    "\"\x3e" .
                                    ${${"GLOBALS"}["hmwqscpc"]} .
                                    "</ss:Data\x3e\x3c/ss:Cell\x3e";
                                break;
                            }
                        }
                        ${${"GLOBALS"}["gkfndjwhfpg"]} .= ${${"GLOBALS"}[
                            "cudsptyopd"
                        ]};
                    }
                    ${${"GLOBALS"}["gckdpyw"]} .= "\x3c/ss:Row\x3e";
                }
                ${${"GLOBALS"}["khqajcfvsm"]} = ${${"GLOBALS"}["wscmnpx"]};
            }
        }
        $this->groupdata = null;
        ${"GLOBALS"}["vctguijus"] = "es";
        if ($this->tmpvar) {
            ${"GLOBALS"}["cwmjdt"] = "s";
            ${"GLOBALS"}["giqffypob"] = "i";
            $fkjvkhxc = "ncols";
            $nohvvtlpf = "s";
            ${${"GLOBALS"}["cwmjdt"]} .= "\x3css:Row>";
            $rbmrgwacg = "i";
            for (
                $i = 0;
                ${$rbmrgwacg} < ${$fkjvkhxc};
                ${${"GLOBALS"}["giqffypob"]}++
            ) {
                $xmectswhq = "i";
                if ($grpinfo->columns[${$xmectswhq}]["hidden"] == true) {
                    continue;
                }
                ${${"GLOBALS"}["cdpuirmgomj"]} = "";
                foreach (
                    $this->tmpvar
                    as ${${"GLOBALS"}["dglvfwquwyy"]} =>
                        ${${"GLOBALS"}["qbroefmekyoe"]}
                ) {
                    $wmitpbvmiaq = "key";
                    if (
                        $grpinfo->columns[$i][
                            "name"
                        ] == ${$wmitpbvmiaq}
                    ) {
                        $qtylrcjlr = "vv";
                        ${$qtylrcjlr} = ${${"GLOBALS"}["qbroefmekyoe"]};
                        break;
                    }
                }
                if (${${"GLOBALS"}["cdpuirmgomj"]}) {
                    ${"GLOBALS"}["ggsiiskjys"] = "vv";
                    ${"GLOBALS"}["sskuvhb"] = "s";
                    ${${"GLOBALS"}["sskuvhb"]} .=
                        "\x3css:Cell\x20ss:StyleID=\"nmb\x22>\x3css:Data ss:\x54ype\x3d\x22Number\"\x3e" .
                        stripslashes(${${"GLOBALS"}["ggsiiskjys"]}) .
                        "</ss:Data\x3e\x3c/ss:Cell>";
                } else {
                    $rprmmrvw = "s";
                    ${$rprmmrvw} .=
                        "\x3css:Cell\x3e\x3css:Data\x20ss:\x54ype=\"String\x22\x3e</ss:Data>\x3c/ss:Cell>";
                }
            }
            ${$nohvvtlpf} .= "\x3c/ss:Row>";
        }
        ${${"GLOBALS"}["gckdpyw"]} =
            ${$yusihzvegtp} .
            ${${"GLOBALS"}["xejqpx"]} .
            ${$nnrcxmjubi} .
            "\x3c/ss:\x54able\x3e\x3c/ss:Worksheet\x3e\x3c/ss:Workbook\x3e";
        ${${"GLOBALS"}["bryhzxmk"]} = $this->getExcelOptions();
        if (!isset(${$jdgkmuiepbrw}["save_to_disk_only"])) {
            ${${"GLOBALS"}["bryhzxmk"]}["save_to_disk_only"] = false;
        }
        if (${${"GLOBALS"}["vctguijus"]}["save_to_disk_only"] === true) {
            ${"GLOBALS"}["wrgcbfaofet"] = "es";
            ${"GLOBALS"}["xueupwzqe"] = "ret";
            ${${"GLOBALS"}["benxbud"]} = $this->save_to_file(
                ${${"GLOBALS"}["wrgcbfaofet"]}["disk_file"],
                ${${"GLOBALS"}["gckdpyw"]}
            );
            if (${${"GLOBALS"}["xueupwzqe"]} !== true) {
                $this->errorMessage = ${${"GLOBALS"}["benxbud"]};
                $this->sendErrorHeader();
            }
            return;
        }
        if (${${"GLOBALS"}["keiuyycpz"]}["save_to_disk"] === true) {
            ${"GLOBALS"}["ayqbouh"] = "s";
            $this->save_to_file(
                ${${"GLOBALS"}["bryhzxmk"]}["disk_file"],
                ${${"GLOBALS"}["ayqbouh"]}
            );
        }
        if (${${"GLOBALS"}["jhjzifvydu"]}) {
            ${"GLOBALS"}["jdxxcm"] = "filename";
            header("Content-\x54ype: application/ms-excel;");
            header(
                "Content-Disposition:\x20attachment\x3b filename=" .
                    ${${"GLOBALS"}["jdxxcm"]}
            );
            echo ${${"GLOBALS"}["gckdpyw"]};
        } else {
            $mvgljtli = "s";
            return ${$mvgljtli};
        }
    }
    protected function setExcelProp($objPHPExcel)
    {
        ${${"GLOBALS"}["bryhzxmk"]} = $this->getExcelOptions();
        $objPHPExcel
            ->getDefaultStyle()
            ->getFont()
            ->setName(${${"GLOBALS"}["bryhzxmk"]}["font"])
            ->setSize(${${"GLOBALS"}["bryhzxmk"]}["font_size"]);
        $objPHPExcel
            ->getProperties()
            ->setCreator(${${"GLOBALS"}["bryhzxmk"]}["creator"])
            ->setLastModifiedBy(${${"GLOBALS"}["bryhzxmk"]}["author"])
            ->setTitle(${${"GLOBALS"}["bryhzxmk"]}["title"])
            ->setSubject(${${"GLOBALS"}["bryhzxmk"]}["subject"])
            ->setDescription(
                "Test\x20document\x20for\x20Office \x3200\x37 XLSX,\x20generated\x20using\x20PHP\x20classes."
            )
            ->setKeywords(${${"GLOBALS"}["bryhzxmk"]}["keywords"]);
        if (${${"GLOBALS"}["bryhzxmk"]}["protect"] === true) {
            ${"GLOBALS"}["bceptzje"] = "es";
            $objPHPExcel
                ->getActiveSheet()
                ->getProtection()
                ->setSheet(true);
            ${"GLOBALS"}["ifoiwgk"] = "es";
            $objPHPExcel
                ->getActiveSheet()
                ->protectCells(
                    ${${"GLOBALS"}["bceptzje"]}["start_cell"] .
                        ":" .
                        ${${"GLOBALS"}["ifoiwgk"]}["end_cell"],
                    ${${"GLOBALS"}["bryhzxmk"]}["password"]
                );
        }
    }
    protected function saveExcel($objPHPExcel)
    {
        $ivrvkipppkg = "ext";
        $bzkpdcdaqfp = "ext";
        ${"GLOBALS"}["tfmfguvmg"] = "es";
        ${"GLOBALS"}["msmtjfo"] = "fn";
        $glcqoo = "es";
        $xpjhkwgb = "fn";
        ${"GLOBALS"}["bfoqjrfg"] = "es";
        $uoywptdbemxz = "es";
        $ekuwotkc = "ext";
        ${${"GLOBALS"}["bryhzxmk"]} = $this->getExcelOptions();
        $bitryorocf = "es";
        $gcpxxluele = "objPHPExcel";
        ${"GLOBALS"}["mkmbuuyjr"] = "filename";
        $lfsfreab = "objWriter";
        $wxmdldzfxkp = "es";
        $dmtowfknjzq = "objWriter";
        ${"GLOBALS"}["edpbcsncsz"] = "es";
        ${${"GLOBALS"}["blmhysxivb"]} =
            ${${"GLOBALS"}["bfoqjrfg"]}["file"] !== ""
                ? ${${"GLOBALS"}["bryhzxmk"]}["file"]
                : $this->exportfile;
        if (!isset(${$bitryorocf}["save_to_disk_only"])) {
            $bcvybmr = "es";
            ${$bcvybmr}["save_to_disk_only"] = false;
        }
        ${"GLOBALS"}["rbcvuq"] = "objPHPExcel";
        ${${"GLOBALS"}["mkmbuuyjr"]} = $this->tmp_file_name(
            ${$glcqoo}["disk_file"]
        );
        switch (${$wxmdldzfxkp}["file_type"]) {
            case "Excel20\x30\x37":
                ${$ekuwotkc} = pathinfo(${$xpjhkwgb}, PATHINFO_EXTENSION);
                if (${$bzkpdcdaqfp} != "xlsx") {
                    $hfgkrrrovvi = "fn";
                    ${$hfgkrrrovvi} .= "\x2exlsx";
                }
                ${$dmtowfknjzq} = PHPExcel_IOFactory::createWriter(
                    ${$gcpxxluele},
                    "Excel\x32007"
                );
                if (
                    ${${"GLOBALS"}["tfmfguvmg"]}[
                        "save_to_disk_only"
                    ] === true
                ) {
                    $objWriter->save(${${"GLOBALS"}["qjrhtvktebx"]});
                    return;
                }
                if (${$uoywptdbemxz}["save_to_disk"] === true) {
                    $umtsfjwsm = "filename";
                    $objWriter->save(${$umtsfjwsm});
                }
                header(
                    "Content-Type: application/vnd\x2eopenxmlformats-officedocument.spreadsheetml\x2esheet"
                );
                header(
                    "Content-Disposition: attachment\x3bfilename\x3d" .
                        ${${"GLOBALS"}["blmhysxivb"]}
                );
                header("Cache-Control:\x20max-age=0");
                header("Cache-Control:\x20max-age\x3d1");
                header(
                    "Expires: Mon, \x32\x36\x20Jul\x20\x31997\x200\x35:0\x30:0\x30\x20GMT"
                );
                header(
                    "Last-Modified: " .
                        gmdate("D,\x20d\x20M Y H:i:s") .
                        " GM\x54"
                );
                header("Cache-Control: cache,\x20must-revalidate");
                header("Pragma: public");
                $objWriter->save("php://output");
                break;
            case "Excel\x35":
                ${${"GLOBALS"}["odjbaccq"]} = pathinfo(
                    ${${"GLOBALS"}["blmhysxivb"]},
                    PATHINFO_EXTENSION
                );
                if (${$ivrvkipppkg} != "xls") {
                    ${"GLOBALS"}["ekmhwrqxoeo"] = "fn";
                    ${${"GLOBALS"}["ekmhwrqxoeo"]} .= ".xls";
                }
                ${$lfsfreab} = PHPExcel_IOFactory::createWriter(
                    ${${"GLOBALS"}["rbcvuq"]},
                    "Excel5"
                );
                if (
                    ${${"GLOBALS"}["edpbcsncsz"]}["save_to_disk_only"] ===
                    true
                ) {
                    ${"GLOBALS"}["bjgohdds"] = "filename";
                    $objWriter->save(${${"GLOBALS"}["bjgohdds"]});
                    return;
                }
                if (
                    ${${"GLOBALS"}["bryhzxmk"]}["save_to_disk"] === true
                ) {
                    $objWriter->save(${${"GLOBALS"}["qjrhtvktebx"]});
                }
                header("Content-\x54ype: application/vnd\x2ems-excel");
                header(
                    "Content-Disposition:\x20attachment\x3bfilename=" .
                        ${${"GLOBALS"}["msmtjfo"]}
                );
                header("Cache-Control: max-age\x3d\x30");
                header("Cache-Control:\x20max-age=\x31");
                header(
                    "Expires:\x20Mon, \x32\x36 Jul\x2019\x397\x20\x305:\x300:0\x30 GMT"
                );
                header(
                    "Last-Modified: " .
                        gmdate("D, d M\x20\x59\x20H:i:s") .
                        " GM\x54"
                );
                header("Cache-Control: cache,\x20must-revalidate");
                header("Pragma: public");
                $objWriter->save("php://output");
                break;
            default:
                break;
        }
    }
    protected function excel_fmt($e_type, $e_opt)
    {
        $wvgmkntwjigf = "e_opt";
        $cwxcslzzg = "e_type";
        ${"GLOBALS"}["rpajjr"] = "ret";
        $ixovepodi = "ret";
        $wjvvblrj = "e_opt";
        ${"GLOBALS"}["zopeiaqwbx"] = "ret";
        ${$ixovepodi} = "";
        $uvxztwlxkd = "ret";
        $yvymqroe = "ret";
        switch (${$cwxcslzzg}) {
            case "int":
                ${${"GLOBALS"}["rpajjr"]} =
                    ${${"GLOBALS"}["lsjaox"]}["format_int"];
                break;
            case "numeric":
                ${$uvxztwlxkd} = ${${"GLOBALS"}["lsjaox"]}["format_num"];
                break;
            case "text":
                ${${"GLOBALS"}["benxbud"]} =
                    ${$wvgmkntwjigf}["format_text"];
                break;
            case "date":
                ${${"GLOBALS"}["zopeiaqwbx"]} = ${$wjvvblrj}["format_date"];
                break;
            default:
                ${${"GLOBALS"}["benxbud"]} =
                    ${${"GLOBALS"}["lsjaox"]}["format_text"];
                break;
        }
        return ${$yvymqroe};
    }
    public function rs2phpexcel($rs, $colmodel = false)
    {
        ${"GLOBALS"}["whyiwukxhdn"] = "es";
        $xelobqrdn = "rs";
        ${"GLOBALS"}["twalxxlwf"] = "es";
        ${${"GLOBALS"}["curlztfmp"]} = 0;
        $fxesfonggbn = "model";
        $tyluxykbi = "gS\x51LMaxRows";
        ${$tyluxykbi} = $this->gSQLMaxRows;
        if (!${$xelobqrdn}) {
            printf("Bad Record set rs2excel");
            return false;
        }
        ${${"GLOBALS"}["twalxxlwf"]} = $this->getExcelOptions();
        $irlzvzlvxx = "es";
        $jhgbeycjrr = "currentColumn";
        ${"GLOBALS"}["vglfjbmuodxf"] = "rs";
        ${"GLOBALS"}["ovhvonrxs"] = "i";
        ${"GLOBALS"}["tufaius"] = "ncols";
        try {
            ${"GLOBALS"}["ymwwabwjumk"] = "objPHPExcel";
            require_once ${${"GLOBALS"}[
                "bryhzxmk"
            ]}["path_to_phpexcel_class"];
            ${${"GLOBALS"}["ymwwabwjumk"]} = new PHPExcel();
            ${${"GLOBALS"}["vxmhqjpf"]} = $objPHPExcel->getActiveSheet();
        } catch (Exception $e) {
            echo $e->getMessage();
            exit();
        }
        ${${"GLOBALS"}["xlmyieky"]} = [];
        ${"GLOBALS"}["psuwhtfq"] = "aSum";
        $ncols = jqGridDB::columnCount(
            ${${"GLOBALS"}["vglfjbmuodxf"]}
        );
        ${"GLOBALS"}["nuqcynr"] = "ncols";
        $mdbgvjcx = "colmodel";
        $cznedgkoijq = "nmodel";
        ${"GLOBALS"}["wctubcbfcdt"] = "nmodel";
        $nmodel = is_array(
            $colmodel
        )
            ? count($colmodel)
            : -1;
        ${"GLOBALS"}["xcthsnlq"] = "aFormula";
        if (${$cznedgkoijq} > 0) {
            ${"GLOBALS"}["pzrfuou"] = "i";
            $syvdxnnyc = "i";
            $ssxftnkv = "i";
            for (
                ${$syvdxnnyc} = 0;
                ${$ssxftnkv} < $nmodel;
                ${${"GLOBALS"}["pzrfuou"]}++
            ) {
                $ogovclhpsdr = "i";
                $jqhmcwyei = "colmodel";
                if (${$jqhmcwyei}[${$ogovclhpsdr}]["name"] == "actions") {
                    $icqbtlzo = "nmodel";
                    $gfdfdcbdjweo = "colmodel";
                    $cdmmsgwcrhm = "i";
                    array_splice(${$gfdfdcbdjweo}, ${$cdmmsgwcrhm}, 1);
                    ${$icqbtlzo}--;
                    break;
                }
            }
        }
        $ckakgdqlwjc = "hiddencount";
        ${"GLOBALS"}["ccnssoul"] = "startColumn";
        switch ($this->dbtype) {
            case "oci8":
            case "db2":
            case "sqlsrv":
            case "odbcsqlsrv":
                $nmodel++;
                break;
        }
        ${$fxesfonggbn} = false;
        if (
            ${$mdbgvjcx} &&
            ${${"GLOBALS"}["wctubcbfcdt"]} == ${${"GLOBALS"}["nuqcynr"]}
        ) {
            ${"GLOBALS"}["lvbmjyd"] = "model";
            ${${"GLOBALS"}["lvbmjyd"]} = true;
        }
        ${${"GLOBALS"}["psuwhtfq"]} = [];
        ${${"GLOBALS"}["xcthsnlq"]} = [];
        $ahidden = [];
        ${"GLOBALS"}["twfuhnl"] = "startRow";
        $aselect = [];
        ${"GLOBALS"}["wdgdtwtfjf"] = "r";
        $zyrgzrx = "startColumn";
        ${$ckakgdqlwjc} = 0;
        $fgdjzjdoxzli = "currentColumn";
        ${${"GLOBALS"}["rkrfujn"]} = [];
        ${${"GLOBALS"}["zeyxwxhvn"]} = [];
        list(
            ${${"GLOBALS"}["ccnssoul"]},
            ${${"GLOBALS"}["cluxprmjjib"]},
        ) = PHPExcel_Cell::coordinateFromString(${$irlzvzlvxx}["start_cell"]);
        ${$fgdjzjdoxzli} = ${$zyrgzrx};
        if (${${"GLOBALS"}["bryhzxmk"]}["header_title"]) {
            $jcncwdyaahya = "currentColumn";
            ${"GLOBALS"}["bolheuovng"] = "ht";
            ${${"GLOBALS"}["xduuflkkn"]} = ${${"GLOBALS"}["bryhzxmk"]}[
                "header_cell"
            ]
                ? ${${"GLOBALS"}["bryhzxmk"]}["header_cell"]
                : ${$jcncwdyaahya} . ${${"GLOBALS"}["cluxprmjjib"]};
            $objWorksheet->setCellValue(
                ${${"GLOBALS"}["bolheuovng"]},
                ${${"GLOBALS"}["bryhzxmk"]}["header_title"]
            );
            ${"GLOBALS"}["fwcyfhy"] = "es";
            if (!${${"GLOBALS"}["fwcyfhy"]}["header_cell"]) {
                ${"GLOBALS"}["xreqpxajqc"] = "startRow";
                ++${${"GLOBALS"}["xreqpxajqc"]};
            }
        }
        for (
            ${${"GLOBALS"}["ovhvonrxs"]} = 0;
            $i < ${${"GLOBALS"}["tufaius"]};
            $i++
        ) {
            ${"GLOBALS"}["cifghhbc"] = "i";
            ${"GLOBALS"}["iychkckr"] = "colmodel";
            ${"GLOBALS"}["bplser"] = "i";
            ${"GLOBALS"}["obeckoy"] = "startRow";
            $vvgndoj = "fmtstr";
            ${"GLOBALS"}["ebbhpxvn"] = "fname";
            ${"GLOBALS"}["xlaumvevq"] = "i";
            $lqsgihtcerd = "i";
            ${"GLOBALS"}["dhxhvyyrv"] = "fnmkeys";
            $yfgluwvnbl = "i";
            ${"GLOBALS"}["omiqjrawv"] = "i";
            $field = [];
            $qrywzp = "i";
            $vhaoboq = "colmodel";
            ${${"GLOBALS"}["dhxhvyyrv"]}[${$lqsgihtcerd}] = "";
            ${"GLOBALS"}["hvevfshpw"] = "currentColumn";
            $cwxvffwsp = "i";
            if (
                $model &&
                isset(${$vhaoboq}[${${"GLOBALS"}["cifghhbc"]}])
            ) {
                $emlbon = "typearr";
                $spsnetv = "colmodel";
                $tpgcvcjqjkv = "colmodel";
                $mridwtmpsyr = "field";
                ${"GLOBALS"}["jlgteunc"] = "i";
                ${"GLOBALS"}["lvexluboh"] = "i";
                ${"GLOBALS"}["kzjwblg"] = "colmodel";
                $eetlibltjij = "i";
                ${"GLOBALS"}["bpjynnyvswqx"] = "colmodel";
                ${${"GLOBALS"}["incdddnykwc"]} = isset(
                    ${${"GLOBALS"}["bpjynnyvswqx"]}[
                        ${${"GLOBALS"}["lvexluboh"]}
                    ]["label"]
                )
                    ? ${$spsnetv}[$i]["label"]
                    : ${${"GLOBALS"}["kzjwblg"]}[${${"GLOBALS"}["jlgteunc"]}][
                        "name"
                    ];
                ${$mridwtmpsyr}["name"] =
                    $colmodel[
                        $i
                    ]["name"];
                ${$emlbon}[$i] = isset(
                    ${$tpgcvcjqjkv}[${$eetlibltjij}]["sorttype"]
                )
                    ? $colmodel[
                        $i
                    ]["sorttype"]
                    : "";
            } else {
                $ljydrrlma = "fname";
                ${"GLOBALS"}["qpekub"] = "typearr";
                $vkwwtpyt = "field";
                $cydconndgbi = "field";
                ${"GLOBALS"}["dlaovz"] = "rs";
                ${$cydconndgbi} = jqGridDB::getColumnMeta(
                    $i,
                    ${${"GLOBALS"}["dlaovz"]}
                );
                ${$ljydrrlma} = ${$vkwwtpyt}["name"];
                ${${"GLOBALS"}["qpekub"]}[
                    $i
                ] = jqGridDB::MetaType(
                    $field,
                    $this->dbtype
                );
            }
            $wkfpwimdctc = "aselect";
            ${"GLOBALS"}["bzvjlpurhn"] = "currentColumn";
            $ahidden[$i] = $model && isset($colmodel[$i]["hidden"]) ? $colmodel[$i]["hidden"] : false;
            ${"GLOBALS"}["frtqufpxqsck"] = "fmtstr";
            ${$wkfpwimdctc}[${$cwxvffwsp}] = false;
            ${"GLOBALS"}["wqzluxgytge"] = "colmodel";
            $eebnjsrtlf = "typearr";
            if (
                $model &&
                isset(
                    ${${"GLOBALS"}["wqzluxgytge"]}[${$qrywzp}]["formatter"]
                )
            ) {
                ${"GLOBALS"}["qhjkimlumhe"] = "cfmt";
                ${"GLOBALS"}["edhkvyewto"] = "fmtstr";
                ${"GLOBALS"}["nokxopbvtht"] = "colmodel";
                ${"GLOBALS"}["onujiqihjk"] = "colmodel";
                ${"GLOBALS"}["ypwjsub"] = "i";
                ${"GLOBALS"}["lzjnxwweta"] = "asl";
                $tddmgf = "asl";
                ${"GLOBALS"}["gcqujfpw"] = "colmodel";
                ${"GLOBALS"}["bxqrcy"] = "i";
                ${${"GLOBALS"}["qhjkimlumhe"]} =
                    ${${"GLOBALS"}["nokxopbvtht"]}[$i][
                        "formatter"
                    ];
                $brycxfbonj = "colmodel";
                ${$tddmgf} = isset(
                    ${${"GLOBALS"}["onujiqihjk"]}[$i][
                        "formatoptions"
                    ]
                )
                    ? $colmodel[
                        $i
                    ]["formatoptions"]
                    : (isset(
                        ${$brycxfbonj}[${${"GLOBALS"}["bxqrcy"]}]["editoptions"]
                    )
                        ? ${${"GLOBALS"}["gcqujfpw"]}[
                            $i
                        ]["editoptions"]
                        : []);
                ${"GLOBALS"}["phqvydrthsd"] = "i";
                ${"GLOBALS"}["htemvzviez"] = "cfmt";
                switch (${${"GLOBALS"}["htemvzviez"]}) {
                    case "select":
                        if (isset(${${"GLOBALS"}["wyqwkwhq"]}["value"])) {
                            ${"GLOBALS"}["rxsmdaglaw"] = "key";
                            ${${"GLOBALS"}["zbaphywqpxk"]} = isset(
                                ${${"GLOBALS"}["wyqwkwhq"]}["separator"]
                            )
                                ? ${${"GLOBALS"}["wyqwkwhq"]}["separator"]
                                : ":";
                            ${"GLOBALS"}["ltekidnusm"] = "list";
                            ${"GLOBALS"}["rjuabcxysjv"] = "val";
                            ${"GLOBALS"}["nllliq"] = "delim";
                            $tqedhgxebd = "asl";
                            $tllxjcagesn = "asl";
                            ${${"GLOBALS"}["xwandwlrh"]} = isset(
                                ${${"GLOBALS"}["wyqwkwhq"]}["delimiter"]
                            )
                                ? ${$tqedhgxebd}["delimiter"]
                                : ";";
                            ${${"GLOBALS"}["ltekidnusm"]} = explode(
                                ${${"GLOBALS"}["nllliq"]},
                                ${$tllxjcagesn}["value"]
                            );
                            foreach (
                                ${${"GLOBALS"}["coxxnkmlsht"]}
                                as ${${"GLOBALS"}["rxsmdaglaw"]} =>
                                    ${${"GLOBALS"}["rjuabcxysjv"]}
                            ) {
                                ${"GLOBALS"}["mloqpxbi"] = "aselect";
                                ${"GLOBALS"}["mvmcpvumo"] = "sep";
                                $eefngyqy = "items";
                                ${${"GLOBALS"}["hlimukpf"]} = explode(
                                    ${${"GLOBALS"}["mvmcpvumo"]},
                                    ${${"GLOBALS"}["qwgqpbnkmug"]}
                                );
                                ${"GLOBALS"}["cjoycm"] = "i";
                                ${${"GLOBALS"}["mloqpxbi"]}[
                                    ${${"GLOBALS"}["cjoycm"]}
                                ][${$eefngyqy}[0]] =
                                    ${${"GLOBALS"}["hlimukpf"]}[1];
                            }
                        }
                        break;
                    case "date":
                        if (
                            isset(${${"GLOBALS"}["lzjnxwweta"]}["newformat"]) &&
                            ${${"GLOBALS"}["wyqwkwhq"]}["newformat"] !== ""
                        ) {
                            ${${"GLOBALS"}["rkrfujn"]}[
                                $i
                            ] = ${${"GLOBALS"}["wyqwkwhq"]}["newformat"];
                        } else {
                            if (
                                ${${"GLOBALS"}["xlmyieky"]}[
                                    $i
                                ] == "date"
                            ) {
                                ${"GLOBALS"}["wpvsplh"] = "i";
                                ${${"GLOBALS"}["rkrfujn"]}[
                                    ${${"GLOBALS"}["wpvsplh"]}
                                ] = $this->getUserDate();
                            } else {
                                $xqieqyu = "fmtstr";
                                ${"GLOBALS"}["unhxnvk"] = "i";
                                ${$xqieqyu}[
                                    ${${"GLOBALS"}["unhxnvk"]}
                                ] = $this->getUserTime();
                            }
                        }
                        ${${"GLOBALS"}["rkrfujn"]}[
                            ${${"GLOBALS"}["ypwjsub"]}
                        ] = jqGridUtils::phpToExcelDate(
                            ${${"GLOBALS"}["edhkvyewto"]}[
                                ${${"GLOBALS"}["phqvydrthsd"]}
                            ]
                        );
                        break;
                }
            }
            ${"GLOBALS"}["ftslew"] = "i";
            ${"GLOBALS"}["jftwjmqmpu"] = "ahidden";
            $gotwpmr = "fname";
            ${${"GLOBALS"}["rkrfujn"]}[${${"GLOBALS"}["bplser"]}] = !isset(
                ${${"GLOBALS"}["frtqufpxqsck"]}[$i]
            )
                ? $this->excel_fmt(
                    ${$eebnjsrtlf}[${${"GLOBALS"}["omiqjrawv"]}],
                    ${${"GLOBALS"}["bryhzxmk"]}
                )
                : ${$vvgndoj}[$i];
            if (
                isset(
                    $colmodel[${$yfgluwvnbl}][
                        "formatoptions"
                    ]
                )
            ) {
                ${"GLOBALS"}["rfwhemezs"] = "colmodel";
                $pyaeekodk = "i";
                ${${"GLOBALS"}["kudqvk"]} =
                    ${${"GLOBALS"}["rfwhemezs"]}[${$pyaeekodk}][
                        "formatoptions"
                    ];
                if (isset(${${"GLOBALS"}["kudqvk"]}["excel_format"])) {
                    $oxxfyjt = "fmtstr";
                    ${"GLOBALS"}["aoujjbuuq"] = "cmfo";
                    ${$oxxfyjt}[$i] =
                        ${${"GLOBALS"}["aoujjbuuq"]}["excel_format"];
                }
            }
            if (strtolower($field["name"])== "jqgrid_row") {
                $abuxopuk = "i";
                $ahidden[${$abuxopuk}] = true;
            }
            if (
                ${${"GLOBALS"}["jftwjmqmpu"]}[${${"GLOBALS"}["ftslew"]}]
            ) {
                ${"GLOBALS"}["gtpgpwne"] = "hiddencount";
                ${${"GLOBALS"}["gtpgpwne"]}++;
                continue;
            }
            ${${"GLOBALS"}["zeyxwxhvn"]}[
                ${${"GLOBALS"}["xlaumvevq"]}
            ] = $model
                ? ${${"GLOBALS"}["iychkckr"]}[$i][
                    "name"
                ]
                : ${$gotwpmr}[$i];
            $objWorksheet->setCellValue(
                ${${"GLOBALS"}["exklqjjhkx"]} . ${${"GLOBALS"}["obeckoy"]},
                ${${"GLOBALS"}["ebbhpxvn"]}
            );
            $objWorksheet
                ->getColumnDimension(${${"GLOBALS"}["bzvjlpurhn"]})
                ->setAutoSize(true);
            ++${${"GLOBALS"}["hvevfshpw"]};
        }
        $objWorksheet
            ->getStyle(
                ${${"GLOBALS"}["whyiwukxhdn"]}["start_cell"] .
                    ":" .
                    ${${"GLOBALS"}["exklqjjhkx"]} .
                    ${${"GLOBALS"}["cluxprmjjib"]}
            )
            ->getFont()
            ->setBold(true);
        ++${${"GLOBALS"}["twfuhnl"]};
        if ($this->dbtype == "mysqli") {
            ${"GLOBALS"}["rsbqchkyqs"] = "fieldnames";
            $eiaohftgyy = "fld";
            ${$eiaohftgyy} = $rs->field_count;
            ${${"GLOBALS"}["rsbqchkyqs"]}[0] = &$rs;
            $jevqlgyfinq = "fld";
            for (
                $i = 0;
                $i < ${$jevqlgyfinq};
                $i++
            ) {
                ${"GLOBALS"}["wqvmekx"] = "i";
                ${"GLOBALS"}["dfmezkfc"] = "res_arr";
                ${${"GLOBALS"}["yvezufu"]}[$i + 1] =
                    &${${"GLOBALS"}["dfmezkfc"]}[
                        ${${"GLOBALS"}["wqvmekx"]}
                    ];
            }
            ${"GLOBALS"}["nckoydp"] = "fieldnames";
            call_user_func_array(
                "mysqli_stmt_bind_result",
                ${${"GLOBALS"}["nckoydp"]}
            );
        }
        while (
            ${${"GLOBALS"}["wdgdtwtfjf"]} = jqGridDB::fetch_num(
                $rs,
                $this->pdo
            )
        ) {
            ${"GLOBALS"}["sfluyh"] = "startColumn";
            $yrfcrtghv = "currentColumn";
            ${"GLOBALS"}["iryamjgksr"] = "startRow";
            $dqfvaxd = "rows";
            ${$yrfcrtghv} = ${${"GLOBALS"}["sfluyh"]};
            if ($this->dbtype == "mysqli") {
                ${"GLOBALS"}["mhecskbpwze"] = "r";
                ${${"GLOBALS"}["mhecskbpwze"]} = ${${"GLOBALS"}[
                    "ntkgmldy"
                ]};
            }
            for (
                $i = 0;
                $i < $ncols;
                $i++
            ) {
                $vtddvobddsbe = "i";
                ${"GLOBALS"}["ldtnfzpvdw"] = "aselect";
                $fjcfffvtrc = "v";
                ${"GLOBALS"}["ycihdxq"] = "startRow";
                ${"GLOBALS"}["njskdlxpr"] = "ahidden";
                ${"GLOBALS"}["jtcitmdmy"] = "i";
                if (
                    isset($ahidden[${$vtddvobddsbe}]) &&
                    ${${"GLOBALS"}["njskdlxpr"]}[$i]
                ) {
                    continue;
                }
                $wqenglnyymp = "startRow";
                $nltzwitpubv = "typearr";
                $tpjtjybb = "v";
                ${$fjcfffvtrc} =
                    ${${"GLOBALS"}["pfsyyx"]}[${${"GLOBALS"}["jtcitmdmy"]}];
                if (
                    is_array(
                        ${${"GLOBALS"}["ldtnfzpvdw"]}[
                            $i
                        ]
                    )
                ) {
                    ${"GLOBALS"}["pnjqksik"] = "typearr";
                    ${"GLOBALS"}["mjfddhgclp"] = "aselect";
                    $ycbhwmvkgd = "v";
                    if (
                        isset(
                            ${${"GLOBALS"}["mjfddhgclp"]}[
                                $i
                            ][${$ycbhwmvkgd}]
                        )
                    ) {
                        ${"GLOBALS"}["kkiglyhwu"] = "v";
                        ${"GLOBALS"}["hsekstulkdf"] = "v\x31";
                        $yxxrksj = "aselect";
                        ${${"GLOBALS"}["hsekstulkdf"]} =
                            ${$yxxrksj}[$i][
                                ${${"GLOBALS"}["kkiglyhwu"]}
                            ];
                        if (${${"GLOBALS"}["wuzexrtfjn"]}) {
                            $qartdiyczr = "v";
                            ${$qartdiyczr} = ${${"GLOBALS"}["wuzexrtfjn"]};
                        }
                    }
                    ${${"GLOBALS"}["pnjqksik"]}[$i] =
                        "string";
                }
                ${"GLOBALS"}["ljcetjpbfbv"] = "startRow";
                switch (${$nltzwitpubv}[$i]) {
                    case "date":
                    case "datetime":
                        if (
                            substr(${${"GLOBALS"}["qbroefmekyoe"]}, 0, 4) ==
                                "0\x300\x30" ||
                            empty(${${"GLOBALS"}["qbroefmekyoe"]}) ||
                            ${${"GLOBALS"}["qbroefmekyoe"]} == "NULL"
                        ) {
                            ${${"GLOBALS"}["qbroefmekyoe"]} =
                                "\x31970-\x301-\x301";
                        }
                        $objWorksheet->setCellValue(
                            ${${"GLOBALS"}["exklqjjhkx"]} .
                                ${${"GLOBALS"}["ljcetjpbfbv"]},
                            PHPExcel_Shared_Date::stringToExcel(${$tpjtjybb})
                        );
                        break;
                    case "int":
                    case "numeric":
                        $objWorksheet->setCellValueExplicit(
                            ${${"GLOBALS"}["exklqjjhkx"]} . ${$wqenglnyymp},
                            stripslashes(
                                trim(${${"GLOBALS"}["qbroefmekyoe"]})
                            ),
                            PHPExcel_Cell_DataType::TYPE_NUMERIC
                        );
                        break;
                    default:
                        $objWorksheet->setCellValueExplicit(
                            ${${"GLOBALS"}["exklqjjhkx"]} .
                                ${${"GLOBALS"}["ycihdxq"]},
                            ${${"GLOBALS"}["qbroefmekyoe"]},
                            PHPExcel_Cell_DataType::TYPE_STRING
                        );
                }
                if (${${"GLOBALS"}["rkrfujn"]}[$i]) {
                    $dwccktsjf = "currentColumn";
                    $mlhfkxqrtliv = "i";
                    $uvynnggtesr = "fmtstr";
                    ${"GLOBALS"}["idrfvwwqgwqk"] = "startRow";
                    $objWorksheet
                        ->getStyle(
                            ${$dwccktsjf} . ${${"GLOBALS"}["idrfvwwqgwqk"]}
                        )
                        ->getNumberFormat()
                        ->setFormatCode(${$uvynnggtesr}[${$mlhfkxqrtliv}]);
                }
                ++${${"GLOBALS"}["exklqjjhkx"]};
            }
            ++${${"GLOBALS"}["iryamjgksr"]};
            $vviqrtbfinmx = "gS\x51LMaxRows";
            ${"GLOBALS"}["ntnxvukwdf"] = "rows";
            ${${"GLOBALS"}["ntnxvukwdf"]} += 1;
            if (${$dqfvaxd} >= ${$vviqrtbfinmx}) {
                break;
            }
        }
        ${$jhgbeycjrr} = ${${"GLOBALS"}["uyogpwvgccb"]};
        if ($this->tmpvar) {
            $imawkky = "i";
            ${"GLOBALS"}["mfjffyupjg"] = "i";
            ${"GLOBALS"}["uqwpgrczhoh"] = "ncols";
            for (
                ${${"GLOBALS"}["mfjffyupjg"]} = 0;
                ${$imawkky} < ${${"GLOBALS"}["uqwpgrczhoh"]};
                $i++
            ) {
                ${"GLOBALS"}["tcokapyjfh"] = "i";
                $mowiiaxwjuc = "currentColumn";
                ${"GLOBALS"}["ethtfpytclpm"] = "v";
                ${"GLOBALS"}["vuvrcbsw"] = "ahidden";
                ${"GLOBALS"}["ctwebmjwhbk"] = "startRow";
                if (
                    isset(
                        ${${"GLOBALS"}["vuvrcbsw"]}[
                            ${${"GLOBALS"}["tcokapyjfh"]}
                        ]
                    ) &&
                    $ahidden[$i]
                ) {
                    continue;
                }
                ${"GLOBALS"}["bcsfelszexsu"] = "key";
                ${${"GLOBALS"}["cdpuirmgomj"]} = "";
                foreach (
                    $this->tmpvar
                    as ${${"GLOBALS"}["bcsfelszexsu"]} =>
                        ${${"GLOBALS"}["ethtfpytclpm"]}
                ) {
                    ${"GLOBALS"}["hdttdzkqfus"] = "key";
                    if (
                        ${${"GLOBALS"}["zeyxwxhvn"]}[
                            $i
                        ] == ${${"GLOBALS"}["hdttdzkqfus"]}
                    ) {
                        ${${"GLOBALS"}["cdpuirmgomj"]} = ${${"GLOBALS"}[
                            "qbroefmekyoe"
                        ]};
                        break;
                    }
                }
                $objWorksheet->setCellValue(
                    ${$mowiiaxwjuc} . ${${"GLOBALS"}["ctwebmjwhbk"]},
                    ${${"GLOBALS"}["cdpuirmgomj"]}
                );
                ++${${"GLOBALS"}["exklqjjhkx"]};
            }
        }
        $this->setExcelOptions([
            "end_cell" =>
                ${${"GLOBALS"}["exklqjjhkx"]} .
                ${${"GLOBALS"}["cluxprmjjib"]},
        ]);
        $this->setExcelProp(${${"GLOBALS"}["bomjgd"]});
        if ($this->excelClass) {
            try {
                ${${"GLOBALS"}["bomjgd"]} = call_user_func(
                    [$this->excelClass, $this->excelFunc],
                    ${${"GLOBALS"}["bomjgd"]}
                );
            } catch (Exception $e) {
                echo "Can\x20not call the method\x20class - " .
                    $e->getMessage();
            }
        } elseif (function_exists($this->excelFunc)) {
            ${"GLOBALS"}["fjnvyvkugk"] = "objPHPExcel";
            ${${"GLOBALS"}["bomjgd"]} = call_user_func(
                $this->excelFunc,
                ${${"GLOBALS"}["fjnvyvkugk"]}
            );
        }
        $this->saveExcel(${${"GLOBALS"}["bomjgd"]});
        return true;
    }
    public function rs2phpexcel2(
        $echo = true,
        $filename = "exportdata.xls",
        $grpinfo = null
    ) {
        $qnsugyc = "i";
        ${"GLOBALS"}["njwvbiyluicy"] = "sumreverse";
        ${"GLOBALS"}["xskuydqbsj"] = "startColumn";
        $lxrnsnet = "hiddencount";
        ${"GLOBALS"}["eygcjs"] = "s";
        ${${"GLOBALS"}["eygcjs"]} = "";
        ${"GLOBALS"}["pugcnhbtylj"] = "objPHPExcel";
        $ncols = count($grpinfo->columns);
        $ebechifpbg = "toEnd";
        ${"GLOBALS"}["efflxeuzulx"] = "startColumn";
        ${"GLOBALS"}["ybcjomgqqp"] = "currentColumn";
        ${"GLOBALS"}["kmecpugd"] = "len";
        ${${"GLOBALS"}["bryhzxmk"]} = $this->getExcelOptions();
        $gbkxqurpr = "i";
        ${"GLOBALS"}["jndtrnyxumi"] = "i";
        $znptrcso = "startRow";
        try {
            $suykldkedit = "objPHPExcel";
            $dncyobfcp = "objWorksheet";
            $redyssdnem = "es";
            require_once ${$redyssdnem}["path_to_phpexcel_class"];
            ${$suykldkedit} = new PHPExcel();
            ${$dncyobfcp} = $objPHPExcel->getActiveSheet();
        } catch (Exception $e) {
            echo $e->getMessage();
            exit();
        }
        ${"GLOBALS"}["upxmkkplgosh"] = "i";
        list(
            ${${"GLOBALS"}["uyogpwvgccb"]},
            ${${"GLOBALS"}["cluxprmjjib"]},
        ) = PHPExcel_Cell::coordinateFromString(
            ${${"GLOBALS"}["bryhzxmk"]}["start_cell"]
        );
        ${${"GLOBALS"}["exklqjjhkx"]} = ${${"GLOBALS"}["xskuydqbsj"]};
        if (${${"GLOBALS"}["bryhzxmk"]}["header_title"]) {
            ${"GLOBALS"}["vqcmnbwmkfo"] = "es";
            $posnlqlwgwhc = "es";
            $eedrkrv = "currentColumn";
            ${${"GLOBALS"}["xduuflkkn"]} = ${${"GLOBALS"}["bryhzxmk"]}[
                "header_cell"
            ]
                ? ${${"GLOBALS"}["vqcmnbwmkfo"]}["header_cell"]
                : ${$eedrkrv} . ${${"GLOBALS"}["cluxprmjjib"]};
            $objWorksheet->setCellValue(
                ${${"GLOBALS"}["xduuflkkn"]},
                ${$posnlqlwgwhc}["header_title"]
            );
            if (!${${"GLOBALS"}["bryhzxmk"]}["header_cell"]) {
                ${"GLOBALS"}["ixydvpoud"] = "startRow";
                ++${${"GLOBALS"}["ixydvpoud"]};
            }
        }
        ${${"GLOBALS"}["rkrfujn"]} = [];
        ${$lxrnsnet} = 0;
        ${"GLOBALS"}["hskofbleie"] = "currentColumn";
        ${"GLOBALS"}["qhqimhbz"] = "es";
        $vjhppygpgw = "grpopt";
        for (
            ${${"GLOBALS"}["upxmkkplgosh"]} = 0;
            ${$gbkxqurpr} < $ncols;
            ${$qnsugyc}++
        ) {
            ${"GLOBALS"}["oiqxyj"] = "fmtstr";
            $izmxninsa = "i";
            ${"GLOBALS"}["npncldox"] = "i";
            $pexhwytpd = "currentColumn";
            ${"GLOBALS"}["wcutjbozbu"] = "currentColumn";
            ${"GLOBALS"}["bvcluqlwpo"] = "maxColumn";
            ${"GLOBALS"}["vfdvuubxv"] = "i";
            $sqnqtg = "i";
            ${"GLOBALS"}["dpvrhuyaai"] = "fname";
            $cfxhfjd = "es";
            if ($grpinfo->columns[$i]["name"] =="jqgrid_row") {
                $grpinfo->columns[$i]["hidden"] = true;
            }
            if ($grpinfo->columns[${$izmxninsa}]["hidden"] == true) {
                $jydfdtx = "hiddencount";
                ${$jydfdtx}++;
                continue;
            }
            if (
                isset(
                    $grpinfo->columns[$i]["formatter"]
                ) &&
                $grpinfo->columns[$i][
                    "formatter"
                ] == "date"
            ) {
                ${"GLOBALS"}["bigqvenif"] = "i";
                ${${"GLOBALS"}["wyqwkwhq"]} =
                    $grpinfo->columns[$i][
                        "formatoptions"
                    ];
                $qbqobnq = "fmtstr";
                if (
                    isset(${${"GLOBALS"}["wyqwkwhq"]}["newformat"]) &&
                    ${${"GLOBALS"}["wyqwkwhq"]}["newformat"] !== ""
                ) {
                    ${"GLOBALS"}["jgihsbhsy"] = "fmtstr";
                    ${"GLOBALS"}["wwvrbsq"] = "i";
                    ${${"GLOBALS"}["jgihsbhsy"]}[${${"GLOBALS"}["wwvrbsq"]}] =
                        ${${"GLOBALS"}["wyqwkwhq"]}["newformat"];
                } else {
                    if (
                        $grpinfo->columns[$i][
                            "type"
                        ] == "date"
                    ) {
                        ${${"GLOBALS"}["rkrfujn"]}[
                            $i
                        ] = $this->getUserDate();
                    } else {
                        $fyvdpyglqh = "fmtstr";
                        ${$fyvdpyglqh}[
                            $i
                        ] = $this->getUserTime();
                    }
                }
                ${$qbqobnq}[
                    $i
                ] = jqGridUtils::phpToExcelDate(
                    ${${"GLOBALS"}["rkrfujn"]}[${${"GLOBALS"}["bigqvenif"]}]
                );
            }
            ${${"GLOBALS"}["rkrfujn"]}[$i] = !isset(
                ${${"GLOBALS"}["rkrfujn"]}[${$sqnqtg}]
            )
                ? $this->excel_fmt(
                    $grpinfo->columns[$i]["type"],
                    ${$cfxhfjd}
                )
                : ${${"GLOBALS"}["oiqxyj"]}[${${"GLOBALS"}["vfdvuubxv"]}];
            if (
                isset(
                    $grpinfo->columns[${${"GLOBALS"}["npncldox"]}][
                        "formatoptions"
                    ]
                )
            ) {
                $atkhpogp = "cmfo";
                ${"GLOBALS"}["ybwwguthdj"] = "i";
                $aqyuogt = "cmfo";
                ${$atkhpogp} =
                    $grpinfo->columns[${${"GLOBALS"}["ybwwguthdj"]}][
                        "formatoptions"
                    ];
                if (isset(${$aqyuogt}["excel_format"])) {
                    $xshbciinti = "fmtstr";
                    $owfvodkoyyo = "i";
                    ${$xshbciinti}[${$owfvodkoyyo}] =
                        ${${"GLOBALS"}["kudqvk"]}["excel_format"];
                }
            }
            ${"GLOBALS"}["pphxnbqxi"] = "currentColumn";
            ${${"GLOBALS"}["incdddnykwc"]} =
                $grpinfo->columns[$i]["label"];
            $objWorksheet->setCellValue(
                ${${"GLOBALS"}["pphxnbqxi"]} . ${${"GLOBALS"}["cluxprmjjib"]},
                ${${"GLOBALS"}["dpvrhuyaai"]}
            );
            ${"GLOBALS"}["qazlawkgnyx"] = "currentColumn";
            $objWorksheet
                ->getColumnDimension(${${"GLOBALS"}["wcutjbozbu"]})
                ->setAutoSize(true);
            ${${"GLOBALS"}["bvcluqlwpo"]} = ${${"GLOBALS"}["qazlawkgnyx"]};
            ++${$pexhwytpd};
        }
        $objWorksheet
            ->getStyle(
                ${${"GLOBALS"}["qhqimhbz"]}["start_cell"] .
                    ":" .
                    ${${"GLOBALS"}["hskofbleie"]} .
                    ${${"GLOBALS"}["cluxprmjjib"]}
            )
            ->getFont()
            ->setBold(true);
        ++${${"GLOBALS"}["cluxprmjjib"]};
        ${$ebechifpbg} = 0;
        ${"GLOBALS"}["xduenoyvw"] = "currentColumn";
        ${${"GLOBALS"}["nseuemktt"]} = $this->gridOptions["groupingView"];
        ${${"GLOBALS"}["kmecpugd"]} = count(${$vjhppygpgw}["groupField"]);
        ${${"GLOBALS"}["njwvbiyluicy"]} = [];
        if (isset(${${"GLOBALS"}["nseuemktt"]}["groupSummary"])) {
            $yyqllkoydmf = "sumreverse";
            ${$yyqllkoydmf} = array_reverse(
                ${${"GLOBALS"}["nseuemktt"]}["groupSummary"]
            );
        }
        foreach (
            $grpinfo->groups
            as ${${"GLOBALS"}["jndtrnyxumi"]} => ${${"GLOBALS"}["wgoaukia"]}
        ) {
            $vnemuvvnvho = "toEnd";
            ${"GLOBALS"}["qwuoxtduwj"] = "len";
            ${$vnemuvvnvho}++;
            ${"GLOBALS"}["wyvklsqfsim"] = "currentColumn";
            $iiuvnlwxll = "startRow";
            $cellatydh = "leaf";
            $ewboreshym = "grpopt";
            $sbcqfgeeoyh = "gt";
            ${${"GLOBALS"}["qbroefmekyoe"]} =
                ${${"GLOBALS"}["wgoaukia"]}["value"];
            ${"GLOBALS"}["vvkvxwalhzz"] = "startRow";
            $tknmideozpk = "startRow";
            if (
                !isset(
                    ${$ewboreshym}["group\x54ext"][
                        ${${"GLOBALS"}["wgoaukia"]}["idx"]
                    ]
                )
            ) {
                ${${"GLOBALS"}["dgiduf"]} = "{0}";
            } else {
                ${${"GLOBALS"}["dgiduf"]} =
                    ${${"GLOBALS"}["nseuemktt"]}["group\x54ext"][
                        ${${"GLOBALS"}["wgoaukia"]}["idx"]
                    ];
            }
            $cvswmu = "leaf";
            ${${"GLOBALS"}["exklqjjhkx"]} = ${${"GLOBALS"}["uyogpwvgccb"]};
            $objWorksheet->setCellValue(
                ${${"GLOBALS"}["wyvklsqfsim"]} . ${${"GLOBALS"}["cluxprmjjib"]},
                str_repeat("\x20 ", ${${"GLOBALS"}["wgoaukia"]}["idx"]) .
                    strip_tags(
                        $this->js_template(
                            ${$sbcqfgeeoyh},
                            ${${"GLOBALS"}["qbroefmekyoe"]},
                            ${${"GLOBALS"}["wgoaukia"]}["cnt"],
                            ${${"GLOBALS"}["wgoaukia"]}["summary"]
                        )
                    )
            );
            $objWorksheet
                ->getStyle(
                    ${${"GLOBALS"}["exklqjjhkx"]} .
                        ${${"GLOBALS"}["vvkvxwalhzz"]}
                )
                ->getFont()
                ->setBold(true);
            $objWorksheet->mergeCells(
                ${${"GLOBALS"}["exklqjjhkx"]} .
                    ${$tknmideozpk} .
                    ":" .
                    ${${"GLOBALS"}["fyfcebgrkl"]} .
                    ${$iiuvnlwxll}
            );
            ++${${"GLOBALS"}["cluxprmjjib"]};
            ${$cvswmu} =
                ${${"GLOBALS"}["qwuoxtduwj"]} - 1 ===
                ${${"GLOBALS"}["wgoaukia"]}["idx"];
            if (${$cellatydh}) {
                $nrulbjb = "i";
                $cuoyvewnonnq = "n";
                $fojjebc = "row";
                $gvorstbeqkx = "toEnd";
                ${"GLOBALS"}["jkttqkj"] = "gg";
                if (isset($grpinfo->groups[${$nrulbjb} + 1])) {
                    ${${"GLOBALS"}["bnkmlts"]} =
                        $grpinfo->groups[$i + 1];
                    ${${"GLOBALS"}["xwprfqtb"]} =
                        ${${"GLOBALS"}["bnkmlts"]}["startRow"];
                } else {
                    $tjvwbkhilv = "gg";
                    ${$tjvwbkhilv} = false;
                    ${${"GLOBALS"}["xwprfqtb"]} = $this->groupdata->count();
                }
                ${"GLOBALS"}["xeerlfegu"] = "ik";
                $bedvdfrgcvhb = "end";
                foreach (
                    new LimitIterator(
                        $this->groupdata,
                        ${${"GLOBALS"}["wgoaukia"]}["startRow"],
                        ${$bedvdfrgcvhb} - ${$cuoyvewnonnq}["startRow"]
                    )
                    as ${$fojjebc}
                ) {
                    $pwujbbfmxoom = "currentColumn";
                    $ceqnttftfzx = "r";
                    $vtmbeby = "startRow";
                    ${$pwujbbfmxoom} = ${${"GLOBALS"}["uyogpwvgccb"]};
                    $khgqkkvmsu = "key";
                    ${${"GLOBALS"}["dlqafubuedv"]} = 0;
                    foreach (
                        ${${"GLOBALS"}["jtoppfkbxi"]}
                        as ${$khgqkkvmsu} => ${$ceqnttftfzx}
                    ) {
                        ${"GLOBALS"}["edosni"] = "v";
                        $jtnfgnhkbohp = "j";
                        $vgqpntqbj = "j";
                        ${"GLOBALS"}["ufpmdr"] = "r";
                        ${"GLOBALS"}["wjpkkebdyw"] = "currentColumn";
                        ${"GLOBALS"}["sdqsgypuntb"] = "startRow";
                        ${"GLOBALS"}["phkjtbmsiw"] = "currentColumn";
                        ${"GLOBALS"}["yrqbqrwi"] = "startRow";
                        $dxrfnloe = "fmtstr";
                        if (
                            $grpinfo->columns[${$jtnfgnhkbohp}]["hidden"] ==
                            true
                        ) {
                            ${"GLOBALS"}["evrvprju"] = "j";
                            ${${"GLOBALS"}["evrvprju"]}++;
                            continue;
                        }
                        $eorbdn = "v";
                        ${"GLOBALS"}["xnsiyzg"] = "currentColumn";
                        ${${"GLOBALS"}["qbroefmekyoe"]} = ${${"GLOBALS"}[
                            "ufpmdr"
                        ]};
                        if (
                            is_array(
                                $grpinfo->columns[
                                    ${${"GLOBALS"}["dlqafubuedv"]}
                                ]["select"]
                            )
                        ) {
                            $ehkrldl = "v";
                            $vijgrwujknbp = "j";
                            if (
                                isset(
                                    $grpinfo->columns[${$vijgrwujknbp}][
                                        "select"
                                    ][${$ehkrldl}]
                                )
                            ) {
                                ${"GLOBALS"}["sydoxiilc"] = "v\x31";
                                $jvqccp = "v";
                                ${"GLOBALS"}["qzkwotyj"] = "v\x31";
                                ${${"GLOBALS"}["qzkwotyj"]} =
                                    $grpinfo->columns[
                                        ${${"GLOBALS"}["dlqafubuedv"]}
                                    ]["select"][${$jvqccp}];
                                if (${${"GLOBALS"}["sydoxiilc"]}) {
                                    ${${"GLOBALS"}[
                                        "qbroefmekyoe"
                                    ]} = ${${"GLOBALS"}["wuzexrtfjn"]};
                                }
                            }
                            $grpinfo->columns[${${"GLOBALS"}["dlqafubuedv"]}][
                                "type"
                            ] = "string";
                        }
                        switch (
                            $grpinfo->columns[${${"GLOBALS"}["dlqafubuedv"]}][
                                "type"
                            ]
                        ) {
                            case "date":
                            case "datetime":
                                if (
                                    substr(${${"GLOBALS"}["edosni"]}, 0, 4) ==
                                        "\x30\x30\x30\x30" ||
                                    empty(${${"GLOBALS"}["qbroefmekyoe"]}) ||
                                    ${$eorbdn} == "NULL"
                                ) {
                                    $upoicqm = "v";
                                    ${$upoicqm} = "1\x397\x30-0\x31-01";
                                }
                                $objWorksheet->setCellValue(
                                    ${${"GLOBALS"}["phkjtbmsiw"]} .
                                        ${${"GLOBALS"}["cluxprmjjib"]},
                                    PHPExcel_Shared_Date::stringToExcel(
                                        ${${"GLOBALS"}["qbroefmekyoe"]}
                                    )
                                );
                                break;
                            case "int":
                            case "numeric":
                                $objWorksheet->setCellValueExplicit(
                                    ${${"GLOBALS"}["xnsiyzg"]} .
                                        ${${"GLOBALS"}["yrqbqrwi"]},
                                    stripslashes(
                                        trim(${${"GLOBALS"}["qbroefmekyoe"]})
                                    ),
                                    PHPExcel_Cell_DataType::TYPE_NUMERIC
                                );
                                break;
                            default:
                                $objWorksheet->setCellValueExplicit(
                                    ${${"GLOBALS"}["wjpkkebdyw"]} .
                                        ${${"GLOBALS"}["sdqsgypuntb"]},
                                    ${${"GLOBALS"}["qbroefmekyoe"]},
                                    PHPExcel_Cell_DataType::TYPE_STRING
                                );
                        }
                        if (${$dxrfnloe}[${$vgqpntqbj}]) {
                            $nuypbmkvw = "currentColumn";
                            $objWorksheet
                                ->getStyle(
                                    ${$nuypbmkvw} .
                                        ${${"GLOBALS"}["cluxprmjjib"]}
                                )
                                ->getNumberFormat()
                                ->setFormatCode(
                                    ${${"GLOBALS"}["rkrfujn"]}[
                                        ${${"GLOBALS"}["dlqafubuedv"]}
                                    ]
                                );
                        }
                        ${${"GLOBALS"}["dlqafubuedv"]}++;
                        ++${${"GLOBALS"}["exklqjjhkx"]};
                    }
                    ++${$vtmbeby};
                }
                $kflspwlb = "ik";
                ${${"GLOBALS"}["ollhwol"]} = 0;
                if (${${"GLOBALS"}["jkttqkj"]}) {
                    $xjjtxiffn = "jj";
                    ${"GLOBALS"}["bkjlctoo"] = "jj";
                    for (
                        ${${"GLOBALS"}["ollhwol"]} = 0;
                        ${$xjjtxiffn} < ${${"GLOBALS"}["mvglhjc"]};
                        ${${"GLOBALS"}["bkjlctoo"]}++
                    ) {
                        ${"GLOBALS"}["arntqyxwuvr"] = "jj";
                        $ncxdinbkwzj = "gg";
                        if (
                            ${$ncxdinbkwzj}["dataIndex"] ===
                            $this->gridOptions["groupingView"]["group\x46ield"][
                                ${${"GLOBALS"}["arntqyxwuvr"]}
                            ]
                        ) {
                            break;
                        }
                    }
                    ${${"GLOBALS"}["fwfzxxuwrc"]} =
                        ${${"GLOBALS"}["mvglhjc"]} - ${${"GLOBALS"}["ollhwol"]};
                }
                for (
                    ${${"GLOBALS"}["dtasvs"]} = 0;
                    ${${"GLOBALS"}["xeerlfegu"]} < ${$gvorstbeqkx};
                    ${$kflspwlb}++
                ) {
                    ${"GLOBALS"}["gwxtrmcy"] = "ik";
                    $vckmfxp = "sumreverse";
                    $oshgmgeixuo = "fdata";
                    ${"GLOBALS"}["rbcnutpoy"] = "ij";
                    ${"GLOBALS"}["hisukzup"] = "i";
                    if (
                        isset(
                            ${${"GLOBALS"}["mjypfvclsj"]}[
                                ${${"GLOBALS"}["dtasvs"]}
                            ]
                        ) &&
                        !${$vckmfxp}[${${"GLOBALS"}["gwxtrmcy"]}]
                    ) {
                        continue;
                    }
                    $peezojfyr = "fdata";
                    $otuzrwxkj = "ij";
                    ${"GLOBALS"}["eaxdvied"] = "ij";
                    ${$oshgmgeixuo} = $this->findGroupIdx(
                        ${${"GLOBALS"}["hisukzup"]},
                        ${${"GLOBALS"}["dtasvs"]},
                        $grpinfo->groups
                    );
                    ${${"GLOBALS"}["lulxfwx"]} = ${$peezojfyr}["cnt"];
                    ${${"GLOBALS"}["exklqjjhkx"]} = ${${"GLOBALS"}[
                        "uyogpwvgccb"
                    ]};
                    for (
                        ${${"GLOBALS"}["eaxdvied"]} = 0;
                        ${$otuzrwxkj} < $ncols;
                        ${${"GLOBALS"}["rbcnutpoy"]}++
                    ) {
                        if (
                            $grpinfo->columns[${${"GLOBALS"}["ygtpwesvvpd"]}][
                                "hidden"
                            ] == true
                        ) {
                            continue;
                        }
                        ${${"GLOBALS"}["hmwqscpc"]} = "";
                        ${${"GLOBALS"}["xymebptnm"]} = "{0}";
                        ${"GLOBALS"}["wgugrlsxoxad"] = "sk";
                        ${"GLOBALS"}["tulkhsfs"] = "tv";
                        $vmshlpzttqd = "fmtstr";
                        foreach (
                            ${${"GLOBALS"}["vatwvdyuus"]}["summary"]
                            as ${${"GLOBALS"}["wgugrlsxoxad"]} =>
                                ${${"GLOBALS"}["nsuqwew"]}
                        ) {
                            $qqtqpscitrmd = "sv";
                            ${"GLOBALS"}["wvknxbkx"] = "ij";
                            if (
                                ${$qqtqpscitrmd}["nm"] ==
                                $this->colModel[${${"GLOBALS"}["wvknxbkx"]}][
                                    "name"
                                ]
                            ) {
                                if (
                                    isset(
                                        $this->colModel[
                                            ${${"GLOBALS"}["ygtpwesvvpd"]}
                                        ]["summary\x54pl"]
                                    )
                                ) {
                                    ${${"GLOBALS"}["xymebptnm"]} =
                                        $this->colModel[
                                            ${${"GLOBALS"}["ygtpwesvvpd"]}
                                        ]["summaryTpl"];
                                }
                                ${"GLOBALS"}["fvxpuiqffe"] = "sv";
                                $ecerenq = "ij";
                                $ybrjtvenzhn = "tplfld";
                                if (
                                    is_string(
                                        ${${"GLOBALS"}["nsuqwew"]}["st"]
                                    ) &&
                                    strtolower(
                                        ${${"GLOBALS"}["fvxpuiqffe"]}["st"]
                                    ) == "avg"
                                ) {
                                    $pbrtghyeipb = "grlen";
                                    $gacdvnsfafuy = "sv";
                                    ${"GLOBALS"}["rbkoixgermkz"] = "sv";
                                    ${"GLOBALS"}["pirjfoyaq"] = "sv";
                                    if (
                                        isset(
                                            ${${"GLOBALS"}["pirjfoyaq"]}["sd"]
                                        ) &&
                                        (float) ${$gacdvnsfafuy}["vd"] != 0
                                    ) {
                                        ${"GLOBALS"}["fkdwbr"] = "sv";
                                        ${${"GLOBALS"}["fkdwbr"]}["v"] =
                                            ${${"GLOBALS"}["nsuqwew"]}["v"] /
                                            ${${"GLOBALS"}["nsuqwew"]}["vd"];
                                    } elseif (
                                        ${${"GLOBALS"}["rbkoixgermkz"]}["v"] &&
                                        ${$pbrtghyeipb} > 0
                                    ) {
                                        ${"GLOBALS"}["ohstsltojqy"] = "sv";
                                        ${"GLOBALS"}["omyopxqculo"] =
                                            "grlen";
                                        ${${"GLOBALS"}["ohstsltojqy"]}["v"] =
                                            ${${"GLOBALS"}["nsuqwew"]}["v"] /
                                            ${${"GLOBALS"}["omyopxqculo"]};
                                    }
                                }
                                if (
                                    isset(
                                        $this->colModel[${$ecerenq}][
                                            "summaryRound"
                                        ]
                                    )
                                ) {
                                    ${"GLOBALS"}["cckmcqagqlh"] = "sv";
                                    ${${"GLOBALS"}["nsuqwew"]}["v"] = round(
                                        ${${"GLOBALS"}["cckmcqagqlh"]}["v"],
                                        $this->colModel[
                                            ${${"GLOBALS"}["ygtpwesvvpd"]}
                                        ]["summaryRound"]
                                    );
                                }
                                $snxrnks = "tv";
                                ${$snxrnks} = $this->js_template(
                                    ${$ybrjtvenzhn},
                                    ${${"GLOBALS"}["nsuqwew"]}["v"]
                                );
                                break;
                            }
                        }
                        if (is_numeric(${${"GLOBALS"}["tulkhsfs"]})) {
                            $yodufbubgw = "startRow";
                            ${"GLOBALS"}["akyvtwo"] = "tv";
                            $objWorksheet->setCellValueExplicit(
                                ${${"GLOBALS"}["exklqjjhkx"]} . ${$yodufbubgw},
                                ${${"GLOBALS"}["akyvtwo"]},
                                PHPExcel_Cell_DataType::TYPE_NUMERIC
                            );
                        } else {
                            $huwewonsltp = "startRow";
                            $objWorksheet->setCellValue(
                                ${${"GLOBALS"}["exklqjjhkx"]} . ${$huwewonsltp},
                                ${${"GLOBALS"}["hmwqscpc"]}
                            );
                        }
                        ${"GLOBALS"}["mmcurmvolkn"] =
                            "currentColumn";
                        if (${$vmshlpzttqd}[${${"GLOBALS"}["ygtpwesvvpd"]}]) {
                            ${"GLOBALS"}["bgrmdgofowv"] = "startRow";
                            $ojllyqr = "ij";
                            $gdrpji = "currentColumn";
                            $objWorksheet
                                ->getStyle(
                                    ${$gdrpji} . ${${"GLOBALS"}["bgrmdgofowv"]}
                                )
                                ->getNumberFormat()
                                ->setFormatCode(
                                    ${${"GLOBALS"}["rkrfujn"]}[${$ojllyqr}]
                                );
                        }
                        ++${${"GLOBALS"}["mmcurmvolkn"]};
                    }
                    ++${${"GLOBALS"}["cluxprmjjib"]};
                }
                ${${"GLOBALS"}["fwfzxxuwrc"]} = ${${"GLOBALS"}["ollhwol"]};
            }
        }
        $this->groupdata = null;
        ${${"GLOBALS"}["xduenoyvw"]} = ${${"GLOBALS"}["efflxeuzulx"]};
        if ($this->tmpvar) {
            ${"GLOBALS"}["gkcebfuc"] = "i";
            $tmkkoqg = "ncols";
            for (
                $i = 0;
                ${${"GLOBALS"}["gkcebfuc"]} < ${$tmkkoqg};
                $i++
            ) {
                ${"GLOBALS"}["wyqfdxuygmc"] = "vv";
                $eouoeiwhnt = "i";
                if ($grpinfo->columns[${$eouoeiwhnt}]["hidden"] == true) {
                    continue;
                }
                ${"GLOBALS"}["dchjiqyld"] = "i";
                ${"GLOBALS"}["lfzvwswtl"] = "startRow";
                ${${"GLOBALS"}["wyqfdxuygmc"]} = "";
                foreach (
                    $this->tmpvar
                    as ${${"GLOBALS"}["dglvfwquwyy"]} =>
                        ${${"GLOBALS"}["qbroefmekyoe"]}
                ) {
                    ${"GLOBALS"}["nbxmbiknhto"] = "key";
                    $gdwrpqtoge = "i";
                    if (
                        $grpinfo->columns[${$gdwrpqtoge}]["name"] ==
                        ${${"GLOBALS"}["nbxmbiknhto"]}
                    ) {
                        ${${"GLOBALS"}["cdpuirmgomj"]} = ${${"GLOBALS"}[
                            "qbroefmekyoe"
                        ]};
                        break;
                    }
                }
                $dxfkhflb = "fmtstr";
                ${"GLOBALS"}["mcsdhfmn"] = "currentColumn";
                $objWorksheet->setCellValue(
                    ${${"GLOBALS"}["exklqjjhkx"]} .
                        ${${"GLOBALS"}["lfzvwswtl"]},
                    ${${"GLOBALS"}["cdpuirmgomj"]}
                );
                if (${$dxfkhflb}[${${"GLOBALS"}["dchjiqyld"]}]) {
                    $rukqfnttcho = "i";
                    $sphgxxz = "currentColumn";
                    $objWorksheet
                        ->getStyle(
                            ${$sphgxxz} . ${${"GLOBALS"}["cluxprmjjib"]}
                        )
                        ->getNumberFormat()
                        ->setFormatCode(
                            ${${"GLOBALS"}["rkrfujn"]}[${$rukqfnttcho}]
                        );
                }
                ++${${"GLOBALS"}["mcsdhfmn"]};
            }
        }
        $this->setExcelOptions([
            "end_cell" => ${${"GLOBALS"}["ybcjomgqqp"]} . ${$znptrcso},
        ]);
        $this->setExcelProp(${${"GLOBALS"}["bomjgd"]});
        if ($this->excelClass) {
            try {
                ${"GLOBALS"}["qeikzwhbx"] = "objPHPExcel";
                ${"GLOBALS"}["lfzefeevjp"] = "objPHPExcel";
                ${${"GLOBALS"}["qeikzwhbx"]} = call_user_func(
                    [$this->excelClass, $this->excelFunc],
                    ${${"GLOBALS"}["lfzefeevjp"]}
                );
            } catch (Exception $e) {
                echo "Can\x20not call\x20the\x20method class -\x20" .
                    $e->getMessage();
            }
        } elseif (function_exists($this->excelFunc)) {
            $twyfkwq = "objPHPExcel";
            ${${"GLOBALS"}["bomjgd"]} = call_user_func(
                $this->excelFunc,
                ${$twyfkwq}
            );
        }
        $this->saveExcel(${${"GLOBALS"}["pugcnhbtylj"]});
        return true;
    }
    public function exportToExcel(
        array $summary = null,
        array $params = null,
        array $colmodel = null,
        $echo = true,
        $filename = "exportdata.xml"
    ) {
        ${"GLOBALS"}["mfrwmexyglo"] = "grouping";
        $sql = null;
        ${${"GLOBALS"}["mfrwmexyglo"]} =
            isset($this->gridOptions["grouping"]) &&
            $this->gridOptions["grouping"] == true;
        $dwjiffvjmlt = "grouping";
        if ($this->dbtype == "adodb") {
            $fbfqgpot = "grouping";
            if (${$fbfqgpot}) {
                $this->pdo->SetFetchMode(ADODB_FETCH_ASSOC);
            } else {
                $this->pdo->SetFetchMode(ADODB_FETCH_NUM);
            }
        }
        $dfrzmlt = "summary";
        $uhvimeeytxo = "sql";
        ${$uhvimeeytxo} = $this->_rs(
            $params,
            ${$dfrzmlt}
        );
        if (!$sql) {
            return "Error:Could\x20not execute\x20the query";
        }
        ${${"GLOBALS"}["bryhzxmk"]} = $this->getExcelOptions();
        if (${$dwjiffvjmlt}) {
            ${"GLOBALS"}["wisvvzdxmbrw"] = "sql";
            $joaywgwy = "es";
            $ymgvkddxh = "groupinfo";
            ${$ymgvkddxh} = $this->groupingSetup(
                $sql,
                $colmodel
            );
            jqGridDB::closeCursor(${${"GLOBALS"}["wisvvzdxmbrw"]});
            if (strtolower(${$joaywgwy}["file_type"]) == "xml") {
                $btsuxwbfe = "ret";
                $kojsmrjw = "groupinfo";
                ${"GLOBALS"}["nawvwdzighf"] = "filename";
                ${$btsuxwbfe} = $this->rs2excel2(
                    ${${"GLOBALS"}["jhjzifvydu"]},
                    ${${"GLOBALS"}["nawvwdzighf"]},
                    ${$kojsmrjw}
                );
            } else {
                ${"GLOBALS"}["irkbgkx"] = "groupinfo";
                ${"GLOBALS"}["rdrcypdjuf"] = "ret";
                ${${"GLOBALS"}["rdrcypdjuf"]} = $this->rs2phpexcel2(
                    ${${"GLOBALS"}["jhjzifvydu"]},
                    ${${"GLOBALS"}["qjrhtvktebx"]},
                    ${${"GLOBALS"}["irkbgkx"]}
                );
            }
        } else {
            if (
                strtolower(${${"GLOBALS"}["bryhzxmk"]}["file_type"]) ==
                "xml"
            ) {
                ${"GLOBALS"}["irpzdgh"] = "echo";
                ${"GLOBALS"}["vcykcirgipv"] = "sql";
                $qntfkdt = "colmodel";
                ${${"GLOBALS"}["benxbud"]} = $this->rs2excel(
                    ${${"GLOBALS"}["vcykcirgipv"]},
                    ${$qntfkdt},
                    ${${"GLOBALS"}["irpzdgh"]},
                    ${${"GLOBALS"}["qjrhtvktebx"]},
                    ${${"GLOBALS"}["lfeuzytzatj"]}
                );
            } else {
                ${${"GLOBALS"}["benxbud"]} = $this->rs2phpexcel(
                    $sql,
                    $colmodel
                );
            }
            jqGridDB::closeCursor($sql);
        }
        return ${${"GLOBALS"}["benxbud"]};
    }
}
?>